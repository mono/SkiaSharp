{
  "number": 142,
  "type": "issue",
  "state": "open",
  "title": "[BUG] SKLottieView not working in Popup",
  "body": "**Description**\r\n\r\nSKLottieView is not working in Popup view from the CommunityToolkit.Maui 1.2.0\r\n\r\n**Code**\r\n\r\n\u0060\u0060\u0060xml\r\n\u003Cskia:SKLottieView\r\n                RepeatCount=\u0022-1\u0022\r\n                WidthRequest=\u0022200\u0022\r\n                HeightRequest=\u0022200\u0022\r\n                Source=\u0022progress_loading.json\u0022\r\n                IsAnimationEnabled=\u0022True\u0022/\u003E\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nThe animation should be visible or running.\r\n\r\n**Actual Behavior**\r\n\r\nSkLottieView isn\u0027t visible for Android \r\nSKLottieView isn\u0027t running on iOS, MacCatalyst, and Android\r\n\r\n**Basic Information**\r\n\r\n- Version with issue: SkiaSharp.Extended.UI.Maui - 2.0.0-preview.61\r\n- Last known good version:  Unknown\r\n- IDE:  Visual Studio for Mac 2022 Version 17.3.5\r\n- Platform Target Frameworks: \r\n  - Android: 11\r\n  - iOS:  15.7\r\n  - macOS:  12.6\r\n  \r\n\u003Cdetails\u003E\r\n  \u003Csummary\u003EDetailed IDE/OS information (click to expand)\u003C/summary\u003E\r\n  \r\n\u0060\u0060\u0060\r\nVisual Studio Community 2022 for Mac\r\nVersion 17.3.5 (build 0)\r\nInstallation UUID: cd66cb3d-dc53-4393-8abb-1bd79b1ba968\r\n\r\nRuntime\r\n.NET 6.0.5 (64-bit)\r\nArchitecture: X64\r\n\r\nRoslyn (Language Service)\r\n4.3.0-3.22312.2\u002B52adfb8b2dc71ed4278debcf13960f2116868608\r\n\r\nNuGet\r\nVersion: 6.2.1.2\r\n\r\n.NET SDK (x64)\r\nSDK: /usr/local/share/dotnet/sdk/6.0.401/Sdks\r\nSDK Versions:\r\n\t6.0.401\r\n\t6.0.400\r\n\t5.0.408\r\n\t3.1.423\r\n\t3.1.422\r\nMSBuild SDKs: /Applications/Visual Studio.app/Contents/MonoBundle/MSBuild/Current/bin/Sdks\r\n\r\n.NET Runtime (x64)\r\nRuntime: /usr/local/share/dotnet/dotnet\r\nRuntime Versions:\r\n\t6.0.9\r\n\t6.0.8\r\n\t5.0.17\r\n\t3.1.29\r\n\t3.1.28\r\n\r\nXamarin.Profiler\r\nVersion: 1.8.0.19\r\nLocation: /Applications/Xamarin Profiler.app/Contents/MacOS/Xamarin Profiler\r\n\r\nUpdater\r\nVersion: 11\r\n\r\nApple Developer Tools\r\nXcode 13.4.1 (20504)\r\nBuild 13F100\r\n\r\nXamarin.Mac\r\nVersion: 8.12.0.2 (Visual Studio Community)\r\nHash: 87f98a75e\r\nBranch: d17-3\r\nBuild date: 2022-07-25 20:18:54-0400\r\n\r\nXamarin.iOS\r\nVersion: 15.12.0.2 (Visual Studio Community)\r\nHash: 87f98a75e\r\nBranch: d17-3\r\nBuild date: 2022-07-25 20:18:55-0400\r\n\r\nXamarin Designer\r\nVersion: 17.3.0.208\r\nHash: 0de472ea0\r\nBranch: remotes/origin/d17-3\r\nBuild date: 2022-09-09 03:45:52 UTC\r\n\r\nXamarin.Android\r\nVersion: 13.0.0.0 (Visual Studio Community)\r\nCommit: xamarin-android/d17-3/030cd63\r\nAndroid SDK: /Users/josuemanueldiasmayorga/Library/Android/sdk\r\n\tSupported Android versions:\r\n\t\t8.0  (API level 26)\r\n\t\t6.0  (API level 23)\r\n\t\t12.0 (API level 31)\r\n\t\t8.1  (API level 27)\r\n\t\t5.1  (API level 22)\r\n\t\t5.0  (API level 21)\r\n\t\t11.0 (API level 30)\r\n\t\t10.0 (API level 29)\r\n\t\t7.1  (API level 25)\r\n\t\t9.0  (API level 28)\r\n\t\t7.0  (API level 24)\r\n\r\nSDK Command-line Tools Version: 7.0\r\nSDK Platform Tools Version: 33.0.3\r\nSDK Build Tools Version: 33.0.0 rc4\r\n\r\nBuild Information: \r\nMono: dffa5ab\r\nJava.Interop: xamarin/java.interop/d17-3@7716ae53\r\nSQLite: xamarin/sqlite/3.38.5@df4deab\r\nXamarin.Android Tools: xamarin/xamarin-android-tools/main@14076a6\r\n\r\nMicrosoft Build of OpenJDK\r\nJava SDK: /Library/Java/JavaVirtualMachines/microsoft-11.jdk\r\n11.0.12\r\nAndroid Designer EPL code available here:\r\nhttps://github.com/xamarin/AndroidDesigner.EPL\r\n\r\nEclipse Temurin JDK\r\nJava SDK: /Library/Java/JavaVirtualMachines/temurin-8.jdk\r\n1.8.0.302\r\nAndroid Designer EPL code available here:\r\nhttps://github.com/xamarin/AndroidDesigner.EPL\r\n\r\nAndroid SDK Manager\r\nVersion: 17.3.0.23\r\nHash: 965bf40\r\nBranch: remotes/origin/d17-3\r\nBuild date: 2022-09-09 03:45:57 UTC\r\n\r\nAndroid Device Manager\r\nVersion: 0.0.0.1169\r\nHash: fafb1d5\r\nBranch: fafb1d5\r\nBuild date: 2022-09-09 03:45:57 UTC\r\n\r\nBuild Information\r\nRelease ID: 1703050000\r\nGit revision: ff0de72f31c7c2eccb19854fbaf050fa3f713a7c\r\nBuild date: 2022-09-09 03:44:02\u002B00\r\nBuild branch: release-17.3\r\nBuild lane: release-17.3\r\n\r\nOperating System\r\nMac OS X 12.6.0\r\nDarwin 21.6.0 Darwin Kernel Version 21.6.0\r\n    Mon Aug 22 20:17:10 PDT 2022\r\n    root:xnu-8020.140.49~2/RELEASE_X86_64 x86_64\r\n\r\n\u0060\u0060\u0060\r\n\u003C/details\u003E\r\n\r\n\r\n**Screenshots**\r\n\r\nAndroid\r\nhttps://user-images.githubusercontent.com/111379715/190478947-cc427617-1798-442e-ae77-73f1b0d0488e.mov\r\n\r\niOS\r\nhttps://user-images.githubusercontent.com/111379715/190477751-6a7d4488-52e3-4692-af6f-f2819fb4ff08.mov\r\n\r\nMacCatalyst\r\nhttps://user-images.githubusercontent.com/111379715/190476385-7c4b8d02-aa43-415f-ba77-13035ff395e8.mov\r\n\r\n**Reproduction Link**\r\n\r\n[SKLottieViewBug.zip](https://github.com/mono/SkiaSharp.Extended/files/9577812/SKLottieViewBug.zip)\r\n",
  "author": {
    "login": "JosueSquareSix",
    "type": "User"
  },
  "labels": [
    {
      "name": "bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2022-09-15T18:15:13",
  "updatedAt": "2024-02-20T13:59:03",
  "commentCount": 15,
  "reactionCount": 3,
  "engagement": {
    "syncedAt": "2026-02-06T12:22:44.2402014Z",
    "reactions": [
      {
        "user": "HugoPeters",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:22:44.2405599Z"
      },
      {
        "user": "thomaskaelin",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:22:44.2405616Z"
      },
      {
        "user": "Syed-RI",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:22:44.2405618Z"
      }
    ],
    "comments": [
      {
        "id": 1258576396,
        "author": "johnwilson-wsh",
        "body": "We are seeing similar behavior when adding a Lottie animation to a page that is navigated to, instead of the main page of the app. If we put the SKLottieView on the main page of the app, it works perfectly, but if we put the SKLottieView on a secondary page that is navigated to, it displays the first frame of the animation but does not animate. ",
        "createdAt": "2022-09-26T20:20:07",
        "reactions": [
          {
            "user": "dpjha84",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:40.7897524Z"
          },
          {
            "user": "ericdgood",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:40.7897526Z"
          },
          {
            "user": "Syed-RI",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:40.7897526Z"
          },
          {
            "user": "salvadorjesus",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:40.7897527Z"
          }
        ]
      },
      {
        "id": 1259723334,
        "author": "vhugogarcia",
        "body": "That is true @johnwilson-wsh\r\n\r\nOn Android the animation is not being displayed, and macOS the image is displayed however it is not animated. \r\n\r\nPlease find below a few video samples for further information of the issue (macOS, Android and iOS):\r\n\r\n\r\nhttps://user-images.githubusercontent.com/1047398/192578186-42f2f68f-9eef-4b61-b100-c474d796a32b.mp4\r\n\r\n\r\nhttps://user-images.githubusercontent.com/1047398/192577984-7140ba2a-c787-4690-b365-5a6550ab8222.mov\r\n\r\n\r\n\r\nhttps://user-images.githubusercontent.com/1047398/192578275-85e5b3b0-a60f-44a6-af8d-1d1e040b382d.mov\r\n\r\n",
        "createdAt": "2022-09-27T16:06:43",
        "reactions": []
      },
      {
        "id": 1364180669,
        "author": "VToegel",
        "body": "Just for info, maybe it helps as a workaround:\r\n\r\nI expirienced the same issue on iOS (SKLottieView loaded but did not play animation since it stopped before the first frame).\r\n\r\nI solved the issue by using Async Initialization with a short delay, after which the LottieAnimation IsAnimationEnabled property is set to true (set to false in XAML). See code example below\r\n\r\n    public PopupView()\r\n    {\r\n        InitializeComponent();\r\n\r\n        // initialize this \u0060InitializeLottieAsync()\u0060\r\n        Initialization = InitializeLottieAsync();\r\n    }\r\n\r\n    public Task Initialization { get; private set; }\r\n\r\n    public async Task InitializeLottieAsync()\r\n    {\r\n        await Task.Delay(50);\r\n        LottieAnimation.IsAnimationEnabled = true;\r\n    }",
        "createdAt": "2022-12-23T18:47:51",
        "reactions": [
          {
            "user": "dpjha84",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:41.2942381Z"
          },
          {
            "user": "mavispuford",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:41.2942383Z"
          },
          {
            "user": "ArtemAI",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:22:41.2942384Z"
          }
        ]
      },
      {
        "id": 1429414978,
        "author": "HugoPeters",
        "body": "This is still an issue for me despite @VToegel\u0027s workaround - when I launch a popup from anywhere but a page itself animations usually don\u0027t work, with the workaround it seems they have a higher chance of working but still don\u0027t sometimes. For context, this is using shell and ModalAnimated / FormSheet presentation style. Invoking on main thread doesn\u0027t make a difference. I didn\u0027t look much into it but enabling debug statistics shows 0 FPS on those animations.",
        "createdAt": "2023-02-14T09:35:01",
        "reactions": []
      },
      {
        "id": 1438923063,
        "author": "mavispuford",
        "body": "We are also experiencing this outside of popup situations.  We\u0027ve got a loading spinner set up in a \u0060ControlTemplate\u0060 for our pages, and \u0060IsAnimationEnabled\u0060 is bound using a \u0060TemplateBinding\u0060 to an \u0060IsBusy\u0060 bool on our view models. We assume a VM is busy until it finishes being initialized, so \u0060IsBusy\u0060 is defaulted to true.  This causes the animation to not play.  Similar to [VToegal](https://github.com/mono/SkiaSharp.Extended/issues/142#issuecomment-1364180669)\u0027s workaround, I can get it working by defaulting \u0060IsBusy\u0060 to false and setting it to true after a small delay.",
        "createdAt": "2023-02-21T18:28:27",
        "reactions": []
      },
      {
        "id": 1448590285,
        "author": "gabsamples6",
        "body": "It would be nice to have this fixed , even with the workround using mopups does not work\r\n@VToegel  do you have a noddy sample with a pop up that works?  I cannot make it work I am using https://github.com/LuckyDucko/Mopups\r\nthanks",
        "createdAt": "2023-02-28T17:35:01",
        "reactions": []
      },
      {
        "id": 1448662107,
        "author": "VToegel",
        "body": "@gabsamples6 i could only provide an example for Maui community toolkit popup. There the workaround works for sure.\n\nI am unfortunately not using mopups for the time being.\n\nRgds Vinc",
        "createdAt": "2023-02-28T18:25:45",
        "reactions": []
      },
      {
        "id": 1449382074,
        "author": "gabsamples6",
        "body": "@VToegel  thanks for replying , I will revert to mauiCommunity toolkit for the popup (its bottom one) if this is not going to be fixed. So if you have anything that you can show because I cannot make it work\r\n\r\nthanks again",
        "createdAt": "2023-03-01T05:40:47",
        "reactions": []
      },
      {
        "id": 1450368253,
        "author": "VToegel",
        "body": "@gabsamples6 Please find an example here:\r\n\r\nhttps://github.com/VToegel/MauiLottiePopupExample.git\r\n\r\nWorks for me on windows, android and iOS.\r\nPlease also read through the readme for some tips.\r\n\r\nReds Vinc\r\n",
        "createdAt": "2023-03-01T15:44:15",
        "reactions": []
      },
      {
        "id": 1451513071,
        "author": "gabsamples6",
        "body": "@VToegel  brilliant!! thank you!",
        "createdAt": "2023-03-02T08:55:13",
        "reactions": []
      },
      {
        "id": 1461276940,
        "author": "AntPolkanov",
        "body": "Came across this timing issue too when tried to display an animation in a CarouselView. Does anyone have an idea how to properly fix it? Checked the source code, but cannot see anything obvious.",
        "createdAt": "2023-03-09T04:53:38",
        "reactions": []
      },
      {
        "id": 1689860827,
        "author": "mattleibow",
        "body": "Looking closer, this appears to be the case because the MCT is not causing the Loaded event to fire",
        "createdAt": "2023-08-23T12:18:50",
        "reactions": []
      },
      {
        "id": 1806853033,
        "author": "kyurkchyan",
        "body": "We have a custom view that we use a loading view inside all of the screens. Here\u0027s how the view looks roughly\r\n\r\n\u0060\u0060\u0060xaml\r\n\u003CGrid\r\n    RowDefinitions=\u0022*,Auto,Auto,*\u0022\r\n    x:Name=\u0022This\u0022\r\n    IsVisible=\u0022{Binding IsBusy, Source={x:Reference  This}}\u0022\r\n    HorizontalOptions=\u0022Fill\u0022\r\n    VerticalOptions=\u0022Fill\u0022\r\n    RowSpacing=\u00220\u0022\u003E\r\n    \u003Ccontrols:Placeholder\r\n        IsBusy=\u0022{Binding IsBusy, Source={x:Reference  This}}\u0022\r\n        Aspect=\u0022AspectFit\u0022\r\n        Width=\u0022300\u0022\r\n        HorizontalOptions=\u0022Center\u0022\r\n        VerticalOptions=\u0022Fill\u0022 /\u003E\r\n    \u003Cskia:SKLottieView\r\n        Grid.Row=\u00221\u0022\r\n        Source=\u0022loading_indicator.json\u0022\r\n        RepeatCount=\u0022-1\u0022\r\n        HeightRequest=\u002232\u0022\r\n        WidthRequest=\u002255\u0022\r\n        HorizontalOptions=\u0022Center\u0022 /\u003E\r\n    \u003CLabel\r\n        Grid.Row=\u00222\u0022\r\n        Text=\u0022{markupExtensions:Translate Loading}\u0022\r\n        Style=\u0022{StaticResource MetadataLabelStyle}\u0022\r\n        FontSize=\u0022{StaticResource LargeFontSize}\u0022\r\n        Margin=\u00228\u0022\r\n        HorizontalTextAlignment=\u0022Center\u0022 /\u003E\r\n    \u003Cprogress:ProgressBar\r\n        Grid.Row=\u00223\u0022\r\n        IsVisible=\u0022{Binding Progress, Converter={StaticResource IsNotNullConverter}, Source={x:Reference This}}\u0022\r\n        Progress=\u0022{Binding Progress, Source={x:Reference This}}\u0022\r\n        HeightRequest=\u00228\u0022\r\n        ProgressColor=\u0022{StaticResource AccentColor}\u0022\r\n        HorizontalOptions=\u0022Fill\u0022\r\n        VerticalOptions=\u0022End\u0022 /\u003E\r\n\u003C/Grid\u003E\r\n\u0060\u0060\u0060\r\n\r\nThis view gets shown and hidden whenever the screen has an active loading process. The behavior we observe is that the animation doesn\u0027t work in the first screen, the first time the Lottie view is shown, the animation doesn\u0027t work. However, it works on the screens that come after. I tried adding the artificial delay workaround mentioned above, but it didn\u0027t help. ",
        "createdAt": "2023-11-11T16:05:00",
        "reactions": []
      },
      {
        "id": 1953075157,
        "author": "ghost",
        "body": "\u003E Just for info, maybe it helps as a workaround:\r\n\u003E \r\n\u003E I expirienced the same issue on iOS (SKLottieView loaded but did not play animation since it stopped before the first frame).\r\n\u003E \r\n\u003E I solved the issue by using Async Initialization with a short delay, after which the LottieAnimation IsAnimationEnabled property is set to true (set to false in XAML). See code example below\r\n\u003E \r\n\u003E \u0060\u0060\u0060\r\n\u003E public PopupView()\r\n\u003E {\r\n\u003E     InitializeComponent();\r\n\u003E \r\n\u003E     // initialize this \u0060InitializeLottieAsync()\u0060\r\n\u003E     Initialization = InitializeLottieAsync();\r\n\u003E }\r\n\u003E \r\n\u003E public Task Initialization { get; private set; }\r\n\u003E \r\n\u003E public async Task InitializeLottieAsync()\r\n\u003E {\r\n\u003E     await Task.Delay(50);\r\n\u003E     LottieAnimation.IsAnimationEnabled = true;\r\n\u003E }\r\n\u003E \u0060\u0060\u0060\r\n\r\nHow does this work using MVVM? I cannot get it to work for Lottie used in CarouselView items. Changing the binding to the \u0060IsAnimationPlaying\u0060 attribute using \u0060Task.Delay\u0060 does not seem to do anything. The first slide never shows on Android but the second, third, etc. work fine.",
        "createdAt": "2024-02-19T19:46:09",
        "reactions": []
      },
      {
        "id": 1954273544,
        "author": "VToegel",
        "body": "I bind the lottiesource from the viewmodel, but IsAnimationEnabled is always set from code behind.\n\nBut basically it should also work using a binding. I think its  a timing issue and the question is if your viewmodel or the view is instantiated first. You can check that by setting breakpoints in viewmodel and view.\nNext you can try a ridiculous high delay (e.g. 5000ms) and see if the animation starts. If yes then you do need to play with your architecture or delay to solve the issue.",
        "createdAt": "2024-02-20T13:59:01",
        "reactions": []
      }
    ]
  }
}