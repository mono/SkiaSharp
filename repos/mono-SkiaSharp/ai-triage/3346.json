{
  "schemaVersion": "1.0",
  "number": 3346,
  "repo": "mono/SkiaSharp",
  "analyzedAt": "2026-02-09T18:10:00Z",
  "summary": "MAUI app on Windows ARM64 crashes after publish unless VC++ Redistributable is installed",
  "type": {
    "value": "bug",
    "confidence": 0.95,
    "reason": "Reporter describes a crash that occurs specifically when running a published build on ARM64 Windows. Works in Debug/Release but crashes in published output — this is broken behavior, not a usage question."
  },
  "area": {
    "value": "libSkiaSharp.native",
    "confidence": 0.85,
    "reason": "The crash is resolved by installing VC++ Redistributable, indicating the native libSkiaSharp.dll (or its ANGLE/WinUI dependencies) requires VC++ runtime DLLs that are not bundled in the published output. This is a native binary deployment issue."
  },
  "backends": null,
  "platforms": [
    {
      "value": "Windows-Classic",
      "confidence": 0.80,
      "reason": "Issue is on Windows ARM64. While the app is MAUI/WinUI, the existing label os/Windows-Classic was applied. The underlying issue is about native binary deployment on Windows ARM64, not WinUI-specific."
    }
  ],
  "tenets": [
    {
      "value": "reliability",
      "confidence": 0.95,
      "reason": "Application crashes immediately on launch. This is a hard crash with no graceful degradation."
    }
  ],
  "partner": {
    "value": "maui",
    "confidence": 0.85,
    "reason": "The repro project is a .NET MAUI app using SkiaSharp.Views.Maui.Controls. MAUI's Windows publish pipeline (MSIX) may be responsible for not bundling VC++ runtime."
  },
  "regression": null,
  "fixStatus": null,
  "bugSignals": {
    "hasCrash": true,
    "hasStackTrace": false,
    "reproQuality": "complete",
    "hasScreenshot": false,
    "hasWorkaround": true,
    "workaroundSummary": "Install Microsoft Visual C++ Redistributable on the target ARM64 Windows machine. This resolves the crash.",
    "targetFrameworks": ["net9.0-windows10.0.19041.0"],
    "severity": "medium",
    "severityReason": "Hard crash on launch but a workaround exists (installing VC++ Redistributable). Affects only published builds on ARM64 Windows, which is a relatively niche deployment target."
  },
  "reproEvidence": {
    "repoLinks": [
      {
        "url": "https://github.com/riccardomartins/ArmDemoTryout",
        "description": "Minimal .NET MAUI app with SkiaSharp.Views.Maui.Controls and Svg.Skia that reproduces the crash on ARM64 Windows publish"
      }
    ],
    "stepsToReproduce": [
      "Clone https://github.com/riccardomartins/ArmDemoTryout",
      "Build the app in Release mode for Windows ARM64 — verify it works fine",
      "Publish the app for Windows ARM64 (MSIX package)",
      "Run the published executable on a fresh Windows ARM64 machine without VC++ Redistributable installed",
      "App starts but crashes immediately"
    ],
    "codeSnippets": [
      {
        "language": "xml",
        "code": "<skia:SKCanvasView PaintSurface=\"OnCanvasViewPaintSurface\" />",
        "context": "MainPage.xaml uses SKCanvasView (CPU/raster rendering), not GPU rendering"
      },
      {
        "language": "xml",
        "code": "<PackageReference Include=\"SkiaSharp.Views.Maui.Controls\" Version=\"3.119.0\" />\n<PackageReference Include=\"Svg.Skia\" Version=\"3.0.6\" />",
        "context": "Project references from the .csproj — uses SkiaSharp.Views.Maui.Controls and Svg.Skia"
      }
    ],
    "environmentDetails": "Windows 10 and 11 ARM64, Visual Studio (Windows), .NET 9.0, MSIX packaging, SkiaSharp 3.116.0 (reported) / 3.119.0 (in current repro csproj)"
  },
  "versionAnalysis": {
    "mentionedVersions": ["3.116.0", "3.119.0"],
    "era": "modern",
    "currentRelevance": "likely",
    "reason": "Issue reported on 3.116.0 but the repro project references 3.119.0, suggesting it persists across modern SkiaSharp 3.x versions. ARM64 Windows VC++ Redistributable dependency is a build/packaging concern not tied to a specific SkiaSharp version."
  },
  "actionability": {
    "suggestedAction": "needs-investigation",
    "confidence": 0.80,
    "reason": "The workaround (install VC++ Redistributable) is known, but the root cause needs investigation: should the VC++ runtime DLLs be bundled in the published output? Is this a MAUI/MSBuild packaging issue, or should SkiaSharp's native assets for Windows ARM64 include the redistributable? mattleibow's comment about a GPU rendering fix suggests there may be related work in progress.",
    "requiresHumanReview": false,
    "closeable": false
  },
  "suggestedResponse": {
    "responseType": "answer",
    "confidence": 0.75,
    "reason": "The reporter already found the workaround. We can confirm the finding, explain why it happens, and answer mattleibow's GPU question (the repro uses SKCanvasView, not GPU rendering).",
    "draft": "Thanks for tracking down the VC++ Redistributable workaround — that's a really useful finding.\n\nTo answer @mattleibow's question: the repro project uses `SKCanvasView` (CPU/raster rendering), not `SKGLView`, so this doesn't appear to be GPU-related.\n\nThe crash is likely because the published MSIX package doesn't bundle the VC++ runtime DLLs that `libSkiaSharp.dll` depends on. In Debug/Release builds run from Visual Studio, the VC++ runtime is already available on the dev machine, so it works — but on a fresh ARM64 Windows install without the redistributable, the native library can't load.\n\nThis could be something that MAUI's MSIX packaging pipeline should handle, or SkiaSharp's Win32 NativeAssets could potentially bundle the required VC++ runtime for ARM64. Would you be able to share which specific VC++ Redistributable version resolved it (ARM64 or x64)? That would help narrow down whether this is an ARM64-specific gap."
  },
  "analysisNotes": {
    "summary": "MAUI app using SKCanvasView crashes on Windows ARM64 when published but works in Debug/Release. Reporter discovered installing VC++ Redistributable resolves the crash, confirming this is a native binary dependency issue at publish time rather than a SkiaSharp code bug.",
    "keySignals": [
      {
        "text": "runs correctly in Debug and Release modes on Windows ARM64, but when creating a Publish build for Windows ARM64, the app starts but crashes immediately",
        "source": "body",
        "interpretation": "Issue is specifically about the publish/deployment pipeline, not a runtime code bug. The native binary works but its dependencies aren't bundled.",
        "supportedFields": ["type", "area", "bugSignals.severity"]
      },
      {
        "text": "by installing Microsoft Visual C++ Redistributable that app works correctly in a fresh arm64 windows",
        "source": "comment 2",
        "interpretation": "Confirms the root cause is a missing VC++ runtime dependency in the published output. libSkiaSharp.dll is compiled with MSVC and requires vcruntime DLLs.",
        "supportedFields": ["type", "area", "bugSignals"]
      },
      {
        "text": "Were you using the GPU rendering? If so, I am trying to release a fix for that.",
        "source": "comment 3",
        "interpretation": "Maintainer suspects a related GPU issue on ARM64 Windows. However, the repro uses SKCanvasView (CPU rendering), so this is likely a different issue.",
        "supportedFields": ["actionability"]
      },
      {
        "text": "<skia:SKCanvasView PaintSurface=\"OnCanvasViewPaintSurface\" />",
        "source": "body (repro project MainPage.xaml)",
        "interpretation": "Repro uses CPU rendering via SKCanvasView, not GPU. mattleibow's GPU fix may not address this specific issue.",
        "supportedFields": ["backends", "actionability"]
      },
      {
        "text": "WindowsPackageType=MSIX",
        "source": "body (repro project .csproj)",
        "interpretation": "MSIX packaging may not bundle VC++ runtime DLLs the same way self-contained publish does. This packaging mode could be relevant to the missing dependency.",
        "supportedFields": ["area", "bugSignals"]
      }
    ],
    "fieldRationales": [
      {
        "field": "type",
        "chosen": "bug",
        "expandedReason": "App crashes immediately when running published output. This is clearly broken behavior — a published app should work without requiring manual installation of VC++ Redistributable.",
        "alternatives": [
          {
            "value": "question",
            "whyRejected": "Reporter isn't asking how to do something — reporting a crash that breaks their deployment."
          }
        ]
      },
      {
        "field": "area",
        "chosen": "libSkiaSharp.native",
        "expandedReason": "The crash is caused by missing VC++ runtime DLLs that the native libSkiaSharp binary depends on. This is a native binary deployment/packaging issue, not a C# wrapper or Views issue.",
        "alternatives": [
          {
            "value": "SkiaSharp.Views.Maui",
            "whyRejected": "While the app uses MAUI Views, the root cause is native binary dependency resolution, not the Views layer."
          },
          {
            "value": "Build",
            "whyRejected": "Build succeeds; the issue is in the publish/deploy stage, which is more about native asset packaging than the build process itself."
          }
        ]
      },
      {
        "field": "platforms",
        "chosen": "Windows-Classic",
        "expandedReason": "The issue is Windows ARM64. The existing label os/Windows-Classic was already applied. While the app targets WinUI via MAUI, the native dependency issue applies to Win32 NativeAssets packaging broadly."
      },
      {
        "field": "bugSignals.severity",
        "chosen": "medium",
        "expandedReason": "Hard crash on launch is severe, but a clear workaround exists (install VC++ Redistributable). ARM64 Windows is a growing but still niche deployment target. Medium rather than high because the workaround is straightforward.",
        "alternatives": [
          {
            "value": "high",
            "whyRejected": "Workaround exists and is simple to apply (install VC++ Redist)."
          },
          {
            "value": "low",
            "whyRejected": "It's a hard crash, not cosmetic. Users on fresh ARM64 Windows machines will hit this consistently."
          }
        ]
      },
      {
        "field": "partner",
        "chosen": "maui",
        "expandedReason": "Repro is a .NET MAUI app. The MSIX packaging pipeline from MAUI may be responsible for not including VC++ runtime in the published output."
      },
      {
        "field": "actionability.suggestedAction",
        "chosen": "needs-investigation",
        "expandedReason": "Need to determine whether this is a SkiaSharp packaging issue (NativeAssets.Win32 should bundle VC++ runtime for ARM64), a MAUI/MSBuild MSIX packaging issue, or expected behavior where VC++ Redistributable is a documented prerequisite. mattleibow's mention of a GPU fix in progress may or may not address this.",
        "alternatives": [
          {
            "value": "close-with-docs",
            "whyRejected": "While the workaround is known, requiring users to manually install VC++ Redistributable on ARM64 is arguably a packaging gap that should be fixed."
          },
          {
            "value": "request-info",
            "whyRejected": "The reporter provided a full repro project and found the workaround. The main missing info is whether they're using GPU rendering — but the repro code shows they're not."
          }
        ]
      }
    ],
    "docsConsulted": [
      {
        "path": "documentation/packages.md",
        "relevance": "Checked NativeAssets.Win32 packaging details and publishing modes. Confirmed Win32 package includes ARM64 binaries. Publishing modes section describes native binary handling but doesn't mention VC++ runtime bundling.",
        "usedFor": ["area", "actionability"]
      },
      {
        "path": "references/skia-patterns.md",
        "relevance": "Contains the exact pattern: 'ARM64 + VC++ Redistributable — Published apps on ARM64 Windows may need VC++ Redistributable installed. Self-contained publish doesn't always include it.' Directly confirms this is a known issue pattern.",
        "usedFor": ["type", "area", "bugSignals", "resolutionAnalysis"]
      }
    ],
    "docsNotConsulted": "Did not consult rendering/backend docs or Linux native loading diagnostics — this is a Windows-specific native dependency packaging issue, not a rendering or Linux problem.",
    "uncertainties": [
      "Whether mattleibow's mentioned GPU fix would also resolve this non-GPU scenario (unlikely but possible if the fix changes how VC++ runtime is bundled)",
      "Whether the specific VC++ Redistributable version matters (ARM64 vs x64 via emulation)",
      "Whether this is specific to MSIX packaging or also affects framework-dependent and self-contained publish modes",
      "Whether the Svg.Skia dependency contributes to the issue or is incidental"
    ]
  },
  "resolutionAnalysis": {
    "hypothesis": "The published MSIX package for Windows ARM64 does not include the VC++ runtime DLLs (e.g., vcruntime140.dll, msvcp140.dll) that libSkiaSharp.dll is dynamically linked against. In Debug/Release the VC++ runtime is available because Visual Studio or the dev environment installed it, but on a fresh ARM64 Windows machine it's missing.",
    "researchDone": [
      "Examined the repro project structure — uses .NET MAUI with SKCanvasView (CPU rendering), targets net9.0-windows10.0.19041.0, MSIX packaging",
      "Checked documentation/packages.md for Windows NativeAssets packaging — Win32 package includes arm64 binaries, auto-included",
      "Checked references/skia-patterns.md — confirms 'ARM64 + VC++ Redistributable' as a known pattern",
      "Searched GitHub for similar ARM64/VC++ issues — no exact duplicates found",
      "Verified repro is NOT using GPU rendering (SKCanvasView in MainPage.xaml), despite maintainer's question about GPU"
    ],
    "proposals": [
      {
        "title": "Install VC++ Redistributable as prerequisite",
        "description": "Document that ARM64 Windows deployments require the VC++ Redistributable to be pre-installed on the target machine. Add this to the MSIX installer prerequisites or document as a known requirement.",
        "steps": [
          "Add VC++ Redistributable ARM64 as a prerequisite dependency in the MSIX manifest",
          "Or document in SkiaSharp deployment docs that ARM64 Windows requires VC++ Redistributable",
          "Consider adding a runtime check that provides a clear error message instead of a crash"
        ],
        "pros": ["Simple to implement", "No changes to native build required", "Users already have VC++ Redist on most machines"],
        "cons": ["Requires user/deployer action", "Poor UX on fresh machines — silent crash with no explanation", "Not a real fix, just documentation of a gap"],
        "confidence": 0.90,
        "effort": "low"
      },
      {
        "title": "Bundle VC++ runtime DLLs in NativeAssets.Win32 for ARM64",
        "description": "Include the required VC++ runtime DLLs (vcruntime140.dll, etc.) alongside libSkiaSharp.dll in the NativeAssets.Win32 package for the ARM64 RID.",
        "steps": [
          "Identify which VC++ runtime DLLs libSkiaSharp.dll depends on for ARM64",
          "Add those DLLs to the NativeAssets.Win32 package in the runtimes/win-arm64/native/ folder",
          "Verify MSIX, self-contained, and framework-dependent publish all include them",
          "Test on a fresh ARM64 Windows machine"
        ],
        "pros": ["Fully resolves the issue for all users", "No user action required", "Already done for x64 implicitly (VC++ runtime is ubiquitous on x64 Windows)"],
        "cons": ["Increases package size", "VC++ runtime redistribution has licensing considerations", "May conflict if another version is already installed"],
        "confidence": 0.70,
        "effort": "medium"
      },
      {
        "title": "Statically link VC++ runtime in ARM64 native build",
        "description": "Change the native build for Windows ARM64 to statically link the VC++ runtime (/MT instead of /MD), eliminating the runtime dependency entirely.",
        "steps": [
          "Update the native build configuration for win-arm64 to use /MT (static CRT)",
          "Rebuild and test libSkiaSharp.dll for ARM64",
          "Verify no conflicts with other dynamically-linked components",
          "Test on fresh ARM64 Windows machine without VC++ Redistributable"
        ],
        "pros": ["Completely eliminates the dependency", "No package size increase from separate DLLs", "Most robust solution"],
        "cons": ["Increases libSkiaSharp.dll binary size", "Static CRT linking can cause issues if mixed with dynamic CRT in same process", "Requires native build changes and testing across all Windows architectures for consistency"],
        "confidence": 0.65,
        "effort": "high"
      }
    ],
    "recommendedProposal": "Install VC++ Redistributable as prerequisite",
    "recommendedReason": "Lowest risk and effort. The VC++ Redistributable is standard on most Windows machines and only missing on fresh ARM64 installations. Documenting the requirement and adding it as an MSIX prerequisite is the simplest path. A longer-term solution (bundling or static linking) can be evaluated separately."
  }
}
