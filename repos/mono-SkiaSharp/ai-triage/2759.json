{
  "meta": {
    "schemaVersion": "1.0",
    "number": 2759,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-11T22:41:00Z"
  },
  "summary": "SKBitmap.Decode returns null for a specific PNG — follow-up to #933/#1981. No image file attached, insufficient info to diagnose.",
  "classification": {
    "type": {
      "value": "type/bug",
      "confidence": 0.72
    },
    "area": {
      "value": "area/SkiaSharp",
      "confidence": 0.9
    }
  },
  "evidence": {
    "reproEvidence": {
      "environmentDetails": "Windows, Visual Studio, SkiaSharp 2.88.6 (description) / 2.88.3 (form field). All platforms claimed affected.",
      "codeSnippets": [
        "csharp: SkiaSharp.SKBitmap bmp = SkiaSharp.SKBitmap.Decode(@\"C:\\Temp\\image1.png\");\nAssert.IsNotNull(bmp);"
      ]
    },
    "bugSignals": {
      "severity": "low"
    },
    "versionAnalysis": {
      "mentionedVersions": [
        "2.88.6",
        "2.88.3",
        "2.88.2"
      ]
    }
  },
  "analysis": {
    "summary": "The reporter reopens #933 (closed as dup of #1981) claiming the fix didn't work. However, they provide no image file, no SKCodec error output, and no details about the PNG's properties (bit depth, color type, interlacing, chunk structure). Multiple distinct PNG decoding issues exist in SkiaSharp — the zlib SSE bug (#1981), CRC mismatch rejection (#2874), and format-specific codec failures (#2429, #2801). Without the image, we cannot determine which issue this is or whether the #1981 fix addresses it.",
    "rationale": "type: Reporter describes SKBitmap.Decode returning null for a valid PNG. If the image is genuinely valid, this is a bug. However, without the image, we can't confirm validity — the PNG might have CRC errors, unusual encoding, or other issues that Skia intentionally rejects. area: SKBitmap.Decode is in the core SkiaSharp binding. The failure could be in native Skia's codec, but the entry point is SkiaSharp. bugSignals.severity: No crash, no stack trace, no reproduction material. The report has zero comments and no image file attached. Cannot investigate without additional information from the reporter. actionability.suggestedAction: We need the actual PNG file to diagnose the issue. We also need SKCodecResult output to understand why decoding fails. Without these, we cannot determine if this is a new bug, an unfixed old bug, or an invalid image. versionAnalysis.currentRelevance: Without the actual PNG file, we cannot determine if this is the same zlib bug fixed in #1981 (which would be fixed in current versions) or a different PNG issue. The reporter's version info is contradictory (2.88.3 vs 2.88.6).",
    "codeInvestigation": [
      {
        "file": "binding/SkiaSharp/SKBitmap.cs",
        "lines": "539-549",
        "finding": "SKBitmap.Decode(string) creates SKCodec via SKCodec.Create(filename). If the codec is null (Skia rejected the image), Decode returns null. The reporter sees null, meaning SKCodec.Create failed — but we don't know why without the image.",
        "relevance": "related"
      },
      {
        "file": "binding/SkiaSharp/SKCodec.cs",
        "lines": "232-241",
        "finding": "SKCodec.Create(string) opens an SKFileStream and passes to sk_codec_new_from_stream. The out parameter SKCodecResult would reveal the failure reason, but the reporter's code doesn't capture it.",
        "relevance": "related"
      },
      {
        "file": "binding/SkiaSharp/SKBitmap.cs",
        "lines": "446-459",
        "finding": "Even if SKCodec creation succeeds, Decode(codec, bitmapInfo) can still return null if GetPixels fails (result != Success && result != IncompleteInput). This is a second failure point.",
        "relevance": "related"
      }
    ],
    "nextQuestions": [
      "Whether the PNG file is the same one from #933 — the original #933 image was embedded as a GitHub attachment but we can't verify it's the same file referenced as C:\\Temp\\image1.png",
      "Whether the reporter actually tested on 2.88.6 (description) or 2.88.3 (version field) — these are different releases",
      "Whether the PNG has structural issues (CRC mismatch, unusual bit depth, interlacing) that Skia intentionally rejects",
      "Whether upgrading to SkiaSharp 3.x (with newer Skia/zlib) would resolve this"
    ],
    "resolution": {
      "hypothesis": "SKBitmap.Decode returns null because Skia's native codec rejects the PNG. The reason could be: (1) the same zlib decompression bug from #1981 (unlikely if on 2.88.6+), (2) CRC mismatch in PNG chunks (like #2874), (3) unsupported PNG features, or (4) a different native codec bug. Without the image, we cannot distinguish these.",
      "proposals": [
        {
          "description": "Use the SKCodec.Create overload that returns an SKCodecResult to get the specific failure reason. This narrows down whether it's a codec initialization failure or a pixel decoding failure.",
          "confidence": 0.85,
          "effort": "small"
        },
        {
          "description": "SkiaSharp 3.x uses a significantly newer Skia engine with updated libpng and zlib. If the issue is a native codec bug, upgrading may resolve it.",
          "confidence": 0.5,
          "effort": "medium"
        }
      ]
    }
  },
  "output": {
    "actionability": {
      "suggestedAction": "request-info",
      "confidence": 0.88,
      "reason": "The report is missing critical information: no image file attached, no SKCodecResult output, and conflicting version numbers. Cannot investigate without the actual PNG file."
    },
    "actions": [
      {
        "type": "update-labels",
        "description": "Apply area label",
        "risk": "low",
        "confidence": 0.9,
        "labels": [
          "area/SkiaSharp"
        ]
      },
      {
        "type": "add-comment",
        "description": "Request the PNG file and diagnostic output",
        "risk": "high",
        "confidence": 0.85
      }
    ]
  }
}
