{
  "meta": {
    "schemaVersion": "2.0",
    "number": 3365,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-08T15:00:00Z",
    "currentLabels": ["type/bug", "os/Windows-Classic", "area/libSkiaSharp.native", "tenet/reliability"]
  },
  "summary": "libSkiaSharp.dll has hard link-time dependency on d3d12.dll causing crashes on Windows 10 systems without DX12",
  "classification": {
    "type": { "value": "type/bug", "confidence": 0.95 },
    "area": { "value": "area/libSkiaSharp.native", "confidence": 0.95 },
    "backends": [{ "value": "backend/Direct3D", "confidence": 0.92 }],
    "platforms": [{ "value": "os/Windows-Classic", "confidence": 0.95 }],
    "tenets": [
      { "value": "tenet/reliability", "confidence": 0.95 },
      { "value": "tenet/compatibility", "confidence": 0.85 }
    ],
    "partner": null
  },
  "evidence": {
    "bugSignals": {
      "hasCrash": true,
      "hasStackTrace": false,
      "reproQuality": "steps-only",
      "hasWorkaround": false,
      "workaroundSummary": null,
      "targetFrameworks": ["net8.0-windows"],
      "severity": "critical",
      "severityReason": "Hard crash at DLL load time with no managed-code workaround. Affects 0.1% of a 1 million user base (~1000 users). The crash occurs before any SkiaSharp API is called, making it impossible to catch or handle in application code."
    },
    "reproEvidence": {
      "relatedIssues": [3267],
      "stepsToReproduce": [
        "Install SkiaSharp 3.116.0 or later in a Win32 application",
        "Deploy to a Windows 10 system that does not have d3d12.dll (systems without DX12 support or missing Windows updates)",
        "Launch the application — it crashes on native library load due to missing d3d12.dll dependency"
      ],
      "environmentDetails": "Windows 10 (not fully updated, lacking DX12 support). SkiaSharp 3.116.0. Legacy Win32 application. Sample of ~1 million installations with 0.1% crash rate."
    },
    "versionAnalysis": {
      "mentionedVersions": ["3.116.0", "2.88.9"],
      "currentRelevance": "likely",
      "reason": "Issue is reported on version 3.116.0 and the D3D12 dependency is still present in the latest builds. The root cause (static linking of d3d12.dll) has not been addressed."
    },
    "regression": {
      "isRegression": true,
      "confidence": 0.90,
      "reason": "Reporter states last known good version is 2.88.9 and the issue appeared in 3.116.0. Related issue #3267 pinpoints the regression to when D3D12 support was added.",
      "workedInVersion": "2.88.9",
      "brokeInVersion": "3.116.0"
    },
    "fixStatus": null
  },
  "analysis": {
    "summary": "This is a bug where libSkiaSharp.dll has a hard link-time dependency on d3d12.dll introduced when Direct3D 12 rendering support was added in SkiaSharp 3.x. Systems without DX12 (certain Windows 10 configurations lacking updates) crash on DLL load. Closely related to #3267 which reports the identical root cause on Windows 7.",
    "keySignals": [
      {
        "text": "There is a hard dependency on DX12 in the latest versions of SkiaSharp",
        "source": "body",
        "interpretation": "Reporter identifies the root cause as a static/link-time dependency on d3d12.dll rather than a dynamic/runtime load, pointing to a native build configuration issue."
      },
      {
        "text": "out of a sample of 1 million installations around 0.1% are crashing because their systems don't have DX12",
        "source": "body",
        "interpretation": "Quantified real-world impact: ~1000 affected users. This elevates severity to critical — it's a hard crash affecting a measurable production user base."
      },
      {
        "text": "porting one of our legacy Win32 apps to use SkiaSharp",
        "source": "body",
        "interpretation": "Confirms Windows-Classic platform (Win32/WPF/WinForms), not WinUI or UWP."
      },
      {
        "text": "Last Known Good Version of SkiaSharp: 2.88.9",
        "source": "body",
        "interpretation": "Confirms this is a regression from the 2.x to 3.x transition, when D3D12 support was added to the Skia build."
      },
      {
        "text": "While this is in reference to Windows 7, all of our crashes occur on Windows 10",
        "source": "comment 3",
        "interpretation": "Reporter distinguishes their issue from #3267 by noting it affects Windows 10, not just Win7. Same root cause but broader impact than originally thought."
      },
      {
        "text": "the common theme is that they're on systems that don't support DX12... and the resolution would be the same. So this is still a duplicate.",
        "source": "comment 4",
        "interpretation": "Community member confirms same root cause as #3267. While technically a duplicate, #3365 adds valuable scale data about Windows 10 impact."
      }
    ],
    "fieldRationales": [
      {
        "field": "type",
        "chosen": "type/bug",
        "expandedReason": "The issue describes a hard crash caused by a static dependency on d3d12.dll in the native binary. This is clearly broken behavior — the library should gracefully handle missing DX12 support rather than failing to load entirely.",
        "alternatives": [{ "value": "type/feature-request", "whyRejected": "Not requesting new functionality — reporting a crash in existing functionality." }]
      },
      {
        "field": "area",
        "chosen": "area/libSkiaSharp.native",
        "expandedReason": "The issue is in the native binary build configuration — d3d12.dll is a link-time import in libSkiaSharp.dll. This is a native build/linking issue, not a managed code or views issue.",
        "alternatives": [{ "value": "area/SkiaSharp", "whyRejected": "The core managed library is not the problem — it's the native binary's link-time dependency." }]
      },
      {
        "field": "backends",
        "chosen": "backend/Direct3D",
        "expandedReason": "The d3d12.dll dependency exists because Skia added Direct3D 12 rendering backend support. The fix involves making this backend's dependency optional at the native level."
      },
      {
        "field": "platforms",
        "chosen": "os/Windows-Classic",
        "expandedReason": "Reporter explicitly describes a legacy Win32 app on Windows 10. The os/Windows-Classic label was already applied by the automated triage."
      },
      {
        "field": "tenets",
        "chosen": "tenet/reliability, tenet/compatibility",
        "expandedReason": "Reliability: hard crashes on systems without DX12 support with quantified 0.1% of 1M impact. Compatibility: regression from 2.x to 3.x breaks backward compatibility with Windows 10 systems that lack DX12 drivers."
      },
      {
        "field": "bugSignals.severity",
        "chosen": "critical",
        "expandedReason": "Hard crash at DLL load time with no managed-code workaround. Quantified impact of ~1000 affected users (0.1% of 1M). The crash prevents any SkiaSharp functionality from being used, and there is no way to catch or handle it in application code.",
        "alternatives": [{ "value": "high", "whyRejected": "The inability to work around the crash in managed code and the quantified production impact elevate this beyond 'high' to 'critical'." }]
      },
      {
        "field": "actionability.suggestedAction",
        "chosen": "needs-investigation",
        "expandedReason": "While closely related to #3267, the fix requires engineering work in the Skia build configuration to change d3d12.dll from a static import to a dynamic load. This hasn't been addressed yet and the issue remains open.",
        "alternatives": [{ "value": "close-as-duplicate", "whyRejected": "While the root cause is identical to #3267, this issue adds significant value with real-world scale data (1M installations, 0.1% affected on Win10). A community member suggested closing as duplicate, but the additional context is worth preserving." }]
      }
    ],
    "uncertainties": [
      "Exact Windows 10 build numbers affected — likely systems missing specific Windows Updates that provide d3d12.dll",
      "Whether the Skia upstream has already addressed this with delayed/dynamic loading of D3D12, or if this requires a SkiaSharp-specific build change",
      "Whether the version discrepancy matters — reporter says 3.116.0 but #3267 pinpoints 3.119.0-preview.1.2 as the introduction point"
    ],
    "assumptions": [
      "Assumed the reporter's version 3.116.0 is correct and that D3D12 support may have been present since that version",
      "Assumed targetFramework is net8.0-windows based on 'legacy Win32 app' and modern SkiaSharp 3.x usage, though reporter did not explicitly state this"
    ],
    "resolution": {
      "hypothesis": "The Skia build configuration statically imports d3d12.dll, causing the Windows loader to fail when that DLL is absent. The fix requires changing the D3D12 dependency from a load-time import to a runtime dynamic load (LoadLibrary/GetProcAddress or /DELAYLOAD pattern), allowing Skia to gracefully fall back when D3D12 is unavailable.",
      "proposals": [
        {
          "title": "Dynamic-load d3d12.dll in Skia build",
          "description": "Modify the Skia GN build to use delayed/dynamic loading of d3d12.dll instead of static imports. This is the proper fix — Skia should probe for DX12 availability at runtime and fall back gracefully. Involves adding /DELAYLOAD:d3d12.dll linker flag or using LoadLibrary/GetProcAddress pattern.",
          "confidence": 0.85,
          "effort": "medium"
        },
        {
          "title": "Disable D3D12 backend in SkiaSharp build",
          "description": "Set skia_use_direct3d=false in the GN build args for Windows, removing the d3d12.dll dependency entirely. Simple change but removes D3D12 rendering capability for all users.",
          "confidence": 0.80,
          "effort": "low"
        },
        {
          "title": "Ship separate NativeAssets packages with and without D3D12",
          "description": "Provide two Windows native asset variants — one with D3D12 support and one without — allowing users to choose based on their target environment. Does not fix the root cause for the default package.",
          "confidence": 0.60,
          "effort": "high"
        }
      ],
      "recommendedProposal": "Dynamic-load d3d12.dll in Skia build",
      "recommendedReason": "Addresses root cause without removing functionality. Delay-loading d3d12.dll lets the library probe for DX12 at runtime and fall back gracefully, which is exactly what the reporter expects. Preserves D3D12 acceleration where available while being safe on systems without it."
    }
  },
  "output": {
    "actionability": {
      "suggestedAction": "needs-investigation",
      "confidence": 0.85,
      "reason": "The fix requires engineering work in the Skia build configuration to change d3d12.dll from a static import to a dynamic load. Closely related to #3267 but provides additional Windows 10 scale data."
    },
    "actions": [
      {
        "id": "labels-1",
        "type": "update-labels",
        "risk": "low",
        "description": "Add backend/Direct3D and tenet/compatibility labels",
        "reason": "Classification identifies Direct3D backend involvement and compatibility regression from 2.x to 3.x. These labels are not yet on the issue.",
        "confidence": 0.90,
        "dependsOn": null,
        "payload": {
          "labelsToAdd": ["backend/Direct3D", "tenet/compatibility"],
          "labelsToRemove": []
        }
      },
      {
        "id": "related-1",
        "type": "link-related",
        "risk": "low",
        "description": "Link to related issue #3267 (same d3d12.dll root cause on Win7)",
        "reason": "Issue #3267 reports the identical root cause on Windows 7. Linking preserves cross-reference for the engineering fix.",
        "confidence": 0.95,
        "dependsOn": null,
        "payload": {
          "relatedIssues": [3267],
          "comment": null
        }
      },
      {
        "id": "comment-1",
        "type": "add-comment",
        "risk": "high",
        "description": "Post analysis acknowledging the issue and linking to #3267",
        "reason": "Reporter asked for updates and the issue has been open without maintainer response. A response acknowledging the problem and linking to the existing tracking issue is appropriate.",
        "confidence": 0.80,
        "dependsOn": "labels-1",
        "payload": {
          "commentType": "answer",
          "draftBody": "Thanks for the detailed report and the deployment scale data — knowing this affects ~0.1% of 1M installations on Windows 10 specifically is valuable context.\n\nThis is the same root cause as #3267: `libSkiaSharp.dll` has a static (link-time) dependency on `d3d12.dll` since D3D12 rendering support was added in SkiaSharp 3.x. On systems where `d3d12.dll` isn't present — whether Win7 or Windows 10 without the necessary updates — the DLL fails to load entirely.\n\nThe fix would need to happen at the Skia build level, changing the D3D12 dependency from a static import to a runtime `LoadLibrary`/`GetProcAddress` pattern so Skia can gracefully fall back when D3D12 isn't available.\n\nLinking this to #3267 as the canonical tracking issue since the resolution would be the same. Your data about Windows 10 impact is a helpful addition to that issue.",
          "requiresHumanEdit": true,
          "finalBody": null,
          "dedupeToken": "triage-3365-comment-1"
        }
      }
    ]
  }
}
