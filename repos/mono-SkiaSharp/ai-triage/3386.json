{
  "schemaVersion": "1.0",
  "number": 3386,
  "repo": "mono/SkiaSharp",
  "analyzedAt": "2026-02-08T19:48:13Z",
  "summary": "NativeAssets.Linux.NoDependencies binary not deployed to Azure Container App via Aspire — libSkiaSharp.so not found despite package being designed for containers",
  "type": {
    "value": "bug",
    "confidence": 0.88,
    "reason": "NativeAssets.Linux.NoDependencies is explicitly designed for minimal containers (no third-party deps, only libc/libm/libpthread/libdl). The user is using the correct package for their scenario but the native binary is not being deployed. The error shows the loader searching multiple paths and failing to find libSkiaSharp.so at all. Additionally, .NET trimming strips System.Memory.Data causing a second failure."
  },
  "area": {
    "value": "libSkiaSharp.native",
    "confidence": 0.95,
    "reason": "DllNotFoundException for libSkiaSharp native library. The .so binary is not found in the deployed container output."
  },
  "backends": null,
  "platforms": [
    {
      "value": "Linux",
      "confidence": 0.98,
      "reason": "Azure Container App runs Linux containers. Error logs show Linux shared library loading paths."
    }
  ],
  "tenets": [
    {
      "value": "compatibility",
      "confidence": 0.90,
      "reason": "Regression from 2.88.9 to 3.116.0 in container deployment scenario. The NativeAssets deployment mechanism may have changed."
    },
    {
      "value": "reliability",
      "confidence": 0.85,
      "reason": "Application crashes at startup with TypeInitializationException wrapping DllNotFoundException — complete failure to function."
    }
  ],
  "partner": null,
  "regression": {
    "isRegression": true,
    "confidence": 0.72,
    "reason": "User reports last known good version was 2.88.9. The native binary deployment path in containers may have changed between 2.x and 3.x, or Aspire's container packaging may handle NativeAssets differently between versions.",
    "workedInVersion": "2.88.9",
    "brokeInVersion": "3.116.0"
  },
  "fixStatus": null,
  "bugSignals": {
    "hasCrash": true,
    "hasStackTrace": true,
    "reproQuality": "partial",
    "hasScreenshot": false,
    "hasWorkaround": true,
    "workaroundSummary": "Switch to NativeAssets.Linux (not NoDependencies), use custom Docker base image with native deps pre-installed (ghcr.io/avantipoint/aspnet-skia), set ContainerBaseImage in csproj, and add System.Memory.Data as direct PackageReference to prevent trimming.",
    "targetFrameworks": ["net9.0"],
    "severity": "high",
    "severityReason": "Complete failure to load SkiaSharp in container deployment using the package specifically designed for containers. Workaround requires abandoning NoDependencies and building a custom Docker image."
  },
  "reproEvidence": {
    "stepsToReproduce": [
      "Create a .NET 9 WebAPI project using SkiaSharp 3.116.0",
      "Add SkiaSharp and SkiaSharp.NativeAssets.Linux.NoDependencies NuGet packages",
      "Deploy to Azure Container App using .NET Aspire",
      "Attempt to use SkiaSharp — observe TypeInitializationException wrapping DllNotFoundException"
    ],
    "codeSnippets": [
      {
        "language": "xml",
        "code": "<PackageReference Include=\"SkiaSharp\" />\n<PackageReference Include=\"SkiaSharp.NativeAssets.Linux.NoDependencies\" />",
        "context": "Package references in the application project"
      },
      {
        "language": "xml",
        "code": "<PropertyGroup>\n  <OutputType>Exe</OutputType>\n  <TargetFramework>net9.0</TargetFramework>\n  <ContainerBaseImage>ghcr.io/avantipoint/aspnet-skia:9.0</ContainerBaseImage>\n</PropertyGroup>",
        "context": "Workaround: use custom Docker base image with native dependencies pre-installed"
      },
      {
        "language": "xml",
        "code": "<ItemGroup>\n  <PackageReference Include=\"System.Memory.Data\" />\n</ItemGroup>",
        "context": "Workaround for trimming issue: add System.Memory.Data as top-level dependency to prevent stripping"
      }
    ],
    "repoLinks": [
      {
        "url": "https://github.com/AvantiPoint/aspnet-skia",
        "description": "Custom Docker images for ASP.NET with SkiaSharp native deps pre-installed"
      }
    ],
    "environmentDetails": "Azure Container App deployed via .NET Aspire, .NET 9.0.10, Linux container based on mcr.microsoft.com/dotnet/aspnet:9.0-noble, Visual Studio (Windows) for development"
  },
  "versionAnalysis": {
    "mentionedVersions": ["3.116.0", "2.88.9"],
    "era": "modern",
    "currentRelevance": "likely",
    "reason": "Issue is with current 3.x line in modern containerized deployment using Aspire. The NativeAssets deployment behavior in container scenarios likely still needs investigation."
  },
  "actionability": {
    "suggestedAction": "needs-investigation",
    "confidence": 0.85,
    "reason": "NativeAssets.Linux.NoDependencies is designed for exactly this scenario (minimal containers). The binary not being found suggests a packaging/deployment issue — possibly RID resolution, Aspire container publishing, or the NativeAssets .targets not deploying correctly in this workflow. The secondary trimming issue with System.Memory.Data also needs investigation. This is not a documentation gap — the package should work as documented.",
    "requiresHumanReview": false,
    "closeable": false,
    "closeReason": null,
    "duplicateOf": null,
    "abandoned": false,
    "abandonedReason": null
  },
  "suggestedResponse": null
}
