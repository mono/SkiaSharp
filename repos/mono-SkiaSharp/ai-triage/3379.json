{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3379,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2025-07-25T12:00:00Z"
  },
  "summary": "SkiaSharp.Views.WPF references OpenTK.GLWpfControl 3.3.0 which lacks strong-naming, breaking strong-named .NET Framework applications with FileLoadException",
  "classification": {
    "type": {
      "value": "type/bug",
      "confidence": 0.95
    },
    "area": {
      "value": "area/views",
      "confidence": 0.95
    },
    "platforms": [
      "os/Windows-Classic"
    ],
    "backends": [
      "backend/OpenGL"
    ]
  },
  "evidence": {
    "reproEvidence": {
      "stepsToReproduce": [
        "Create a .NET Framework 4.8 WPF application",
        "Enable strong-naming with SignAssembly and an .snk key file",
        "Add PackageReference to SkiaSharp.Views.WPF 3.119.1",
        "Build and run — FileLoadException on GLWpfControl assembly"
      ],
      "environmentDetails": "Windows, Visual Studio, .NET Framework 4.8, SkiaSharp 3.116.0+",
      "codeSnippets": [
        "xml: <Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <OutputType>WinExe</OutputType>\n    <TargetFramework>net48</TargetFramework>\n    <SignAssembly>true</SignAssembly>\n    <AssemblyOriginatorKeyFile>MyStrongNameKey.snk</AssemblyOriginatorKeyFile>\n  </PropertyGroup>\n  <ItemGroup>\n    <PackageReference Include=\"SkiaSharp.Views.WPF\" Version=\"3.119.1\" />\n  </ItemGroup>\n</Project>"
      ]
    },
    "bugSignals": {
      "severity": "medium",
      "isRegression": true
    },
    "versionAnalysis": {
      "mentionedVersions": [
        "3.116.0",
        "3.119.1",
        "2.88.9"
      ]
    }
  },
  "analysis": {
    "summary": "SkiaSharp.Views.WPF packages OpenTK.GLWpfControl 3.3.0 for .NET Framework targets. That version is not strong-named, so any strong-named consuming application gets a FileLoadException at runtime. The fix is a one-line version bump to 3.3.1 where strong-naming was added upstream.",
    "rationale": "type: This is a runtime failure — FileLoadException prevents the application from running. The dependency on a non-strong-named assembly is a defect in the package configuration, not a feature request or question. area: The issue is in the SkiaSharp.Views.WPF csproj which references OpenTK.GLWpfControl. This is the Views package, specifically the WPF variant. backends: GLWpfControl is the OpenGL rendering control for WPF. The issue is specific to this OpenGL integration dependency. bugSignals.severity: The error completely blocks strong-named applications from using SkiaSharp.Views.WPF 3.x. However, a workaround exists (downgrade to 2.88.x or remove strong-naming), and the fix is a trivial version bump with an open PR. actionability.suggestedAction: PR #3380 is already open with the fix (version bump to 3.3.1). The issue should remain open until the PR is merged and released. platforms: The issue is specific to WPF on Windows with .NET Framework 4.8. Strong-naming enforcement and the OpenTK.GLWpfControl dependency only apply to Windows Classic desktop scenarios. tenets: Strong-named applications cannot load non-strong-named assemblies, breaking backward compatibility for .NET Framework WPF consumers who upgraded from SkiaSharp 2.88.x to 3.x. regression.isRegression: SkiaSharp 2.88.9 did not have the OpenTK.GLWpfControl dependency. The 3.x series introduced it at version 3.3.0 which lacks strong-naming, breaking strong-named apps that previously worked. fixStatus.likelyFixed: PR #3380 is open proposing bumping OpenTK.GLWpfControl from 3.3.0 to 3.3.1, but it has not been merged yet so the fix is not available in any release. versionAnalysis.currentRelevance: The csproj on main still references OpenTK.GLWpfControl 3.3.0 for net4x targets, so the issue is present in all SkiaSharp 3.x releases including the latest.",
    "codeInvestigation": [],
    "workarounds": [
      "Downgrade to SkiaSharp 2.88.x which did not have the OpenTK.GLWpfControl dependency, or avoid strong-naming the consuming application."
    ],
    "nextQuestions": [
      "Whether bumping OpenTK.GLWpfControl from 3.3.0 to 3.3.1 introduces any behavioral changes beyond the strong-naming fix",
      "Whether the net4x OpenTK dependency (also at 3.3.1) is similarly affected by strong-naming requirements"
    ],
    "resolution": {
      "hypothesis": "The SkiaSharp.Views.WPF.csproj pins OpenTK.GLWpfControl to 3.3.0 for net4x targets. That version is not strong-named, which breaks the CLR's strong-name validation chain when the consuming app is strong-named. Version 3.3.1 added strong-naming.",
      "proposals": [
        {
          "description": "Change the PackageReference version from 3.3.0 to 3.3.1 in SkiaSharp.Views.WPF.csproj for the net4x condition. This is the minimal change — 3.3.1 added strong-naming with no other breaking changes. PR #3380 already implements this.",
          "confidence": 0.95,
          "effort": "small"
        },
        {
          "description": "Update to the latest 3.x release rather than just 3.3.1. This would pick up any additional bug fixes since 3.3.1, but carries slightly more risk of behavioral changes.",
          "confidence": 0.8,
          "effort": "small"
        },
        {
          "description": "Set SignAssembly to false for net4x targets in the SkiaSharp.Views.WPF csproj, matching the non-net4x behavior. However this would break SkiaSharp's own strong-naming contract for .NET Framework consumers.",
          "confidence": 0.3,
          "effort": "small"
        }
      ]
    }
  },
  "output": {
    "actionability": {
      "suggestedAction": "keep-open",
      "confidence": 0.9,
      "reason": "PR #3380 is open with the fix. Issue should remain open until merged and released."
    },
    "actions": [
      {
        "type": "update-labels",
        "description": "Add OpenGL backend label to existing correct labels",
        "risk": "low",
        "confidence": 0.8,
        "labels": [
          "backend/OpenGL"
        ]
      },
      {
        "type": "add-comment",
        "description": "Acknowledge the issue and note the existing PR",
        "risk": "high",
        "confidence": 0.85
      }
    ]
  }
}
