{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3420,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-08T19:00:00Z"
  },
  "summary": "libSkiaSharp.so is built with 4 KB page size, blocking Android 16+ deployment which requires 16 KB page alignment",
  "classification": {
    "type": {
      "value": "type/bug",
      "confidence": 0.88
    },
    "area": {
      "value": "area/libSkiaSharp.native",
      "confidence": 0.95
    },
    "platforms": [
      "os/Android"
    ]
  },
  "evidence": {
    "reproEvidence": {
      "stepsToReproduce": [
        "Create a .NET MAUI Android app targeting Android 16",
        "Build AAB using current SkiaSharp (v2.88.6) or MAUI workload",
        "Run page size check on .so files (e.g. readelf -l libSkiaSharp.so)",
        "Observe libSkiaSharp.so shows 4 KB page size instead of required 16 KB"
      ],
      "attachments": [
        {
          "url": "https://github.com/user-attachments/files/23669684/16KB_PageSize_Report.txt",
          "filename": "16KB_PageSize_Report.txt"
        },
        {
          "url": "https://github.com/user-attachments/files/23547442/Android16_PageSize_Issue.pdf",
          "filename": "Android16_PageSize_Issue.pdf"
        }
      ],
      "environmentDetails": "SkiaSharp.NativeAssets.Android v2.88.6 (description) / v3.116.0 (form field), .NET MAUI 9.0, Android 16+ target, Visual Studio (Windows)"
    },
    "bugSignals": {
      "severity": "high"
    },
    "versionAnalysis": {
      "mentionedVersions": [
        "2.88.6",
        "2.88.9",
        "3.116.0"
      ]
    }
  },
  "analysis": {
    "summary": "Google's Android 16+ requires 64-bit native libraries to be built with 16 KB page alignment. libSkiaSharp.so is currently built with 4 KB page alignment, which will cause Google Play rejection for apps targeting Android 16. This is a native build configuration issue, not a code bug.",
    "rationale": "type: While this is technically a new platform requirement rather than a regression, the practical effect is that SkiaSharp's native library prevents apps from targeting Android 16+. The library is built incorrectly for the target platform, which is a defect in the build configuration. The existing type/bug label is appropriate. area: The issue is entirely in the native binary build configuration of libSkiaSharp.so. The fix is a linker flag change in the native build pipeline, not in C# code. platforms: The 16 KB page size requirement is Android-specific (Android 16+). No other platforms are affected. tenets: This is a forward-compatibility issue with Android 16+. The library must be updated to remain compatible with the evolving platform requirements. bugSignals.severity: Apps using SkiaSharp cannot target Android 16+ at all. No user-side workaround exists — the fix must come from rebuilding the native library. High community engagement confirms broad impact. actionability.suggestedAction: The fix direction is clear (add linker flag), but needs verification of whether 3.x is also affected and where exactly in the build pipeline to add the flag. Maintainer already engaged. regression.isRegression: This is not a regression in SkiaSharp behavior — the library never supported 16 KB page alignment. It is a new external platform requirement from Google for Android 16+. versionAnalysis.currentRelevance: The 16 KB page alignment is a build-time linker flag, so all current native binaries (both 2.x and 3.x) are likely affected regardless of version.",
    "codeInvestigation": [],
    "nextQuestions": [
      "Whether SkiaSharp 3.x native binaries also have 4 KB page alignment (reporter's version fields are contradictory — body says 2.88.6, form says 3.116.0)",
      "Whether the Skia build system (GN/Ninja) already supports the 16 KB page alignment flag or if additional upstream work is needed",
      "Exact timeline for Google Play enforcement — whether it's Android 16 launch or a later deadline"
    ],
    "resolution": {
      "hypothesis": "libSkiaSharp.so is linked with the default 4 KB max-page-size. The fix is to add -Wl,-z,max-page-size=16384 to the Android NDK linker flags in the native build configuration.",
      "proposals": [
        {
          "description": "Add -Wl,-z,max-page-size=16384 to the Android arm64 build configuration in the native build scripts (GN args or CMake). This is the standard fix recommended by Google's migration guide. Low risk — only affects ELF segment alignment, no behavioral change.",
          "confidence": 0.9,
          "effort": "small"
        },
        {
          "description": "Newer NDK versions (r27+) default to 16 KB page alignment. Updating the NDK used for building could automatically resolve this without explicit linker flags. However, NDK version bumps can introduce other changes.",
          "confidence": 0.75,
          "effort": "medium"
        },
        {
          "description": "After applying the fix, add a CI step that runs readelf -l on the output .so to verify max page size is 16384. Prevents future regressions if build tooling changes.",
          "confidence": 0.85,
          "effort": "small"
        }
      ]
    }
  },
  "output": {
    "actionability": {
      "suggestedAction": "needs-investigation",
      "confidence": 0.82,
      "reason": "The fix direction is clear (linker flag), but needs verification of whether 3.x is also affected and where exactly in the build pipeline to add the flag. Maintainer already engaged."
    },
    "actions": [
      {
        "type": "update-labels",
        "description": "Labels already correct — no changes needed",
        "risk": "low",
        "confidence": 0.95
      },
      {
        "type": "add-comment",
        "description": "Post analysis with 16 KB page alignment fix guidance and ask about 3.x testing",
        "risk": "high",
        "confidence": 0.78
      }
    ]
  }
}
