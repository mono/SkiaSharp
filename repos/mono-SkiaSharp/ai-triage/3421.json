{
  "meta": {
    "schemaVersion": "2.0",
    "number": 3421,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-08T15:00:00Z",
    "currentLabels": ["type/bug", "os/Windows-Classic", "area/SkiaSharp", "tenet/reliability"]
  },
  "summary": "User loading a .lottie (dotLottie) file with Skottie.Animation.Create gets null because .lottie is a zip archive, not raw Lottie JSON",
  "classification": {
    "type": { "value": "type/question", "confidence": 0.82 },
    "area": { "value": "area/SkiaSharp", "confidence": 0.90 },
    "backends": null,
    "platforms": [{ "value": "os/Windows-Classic", "confidence": 0.92 }],
    "tenets": null,
    "partner": null
  },
  "evidence": {
    "bugSignals": null,
    "reproEvidence": {
      "codeSnippets": [
        {
          "language": "cs",
          "code": "var animation = SkiaSharp.Skottie.Animation.Create(sourceFileAbsolute);",
          "context": "Loading a .lottie file by path, returns null"
        }
      ],
      "screenshots": [
        {
          "url": "https://github.com/user-attachments/assets/9ca27c18-536b-4403-a41d-44e907329001",
          "context": "LottieFiles download page showing the .lottie file being downloaded",
          "source": "body"
        },
        {
          "url": "https://github.com/user-attachments/assets/0fe1691c-82ee-462a-a110-f53b0682833f",
          "context": "Debugger showing animation variable is null after Create call",
          "source": "body"
        }
      ],
      "stepsToReproduce": [
        "Download a .lottie file from LottieFiles (dotLottie format, which is a zip archive)",
        "Call SkiaSharp.Skottie.Animation.Create(path) with the .lottie file path",
        "Observe that the returned Animation is null"
      ],
      "environmentDetails": "Windows 11, Visual Studio (Windows), SkiaSharp 3.116.0"
    },
    "versionAnalysis": {
      "mentionedVersions": ["3.116.0"],
      "currentRelevance": "likely",
      "reason": "Issue is about format support, not a version-specific regression. The .lottie (dotLottie) zip format has never been supported by Skottie."
    },
    "regression": {
      "isRegression": false,
      "confidence": 0.95,
      "reason": "Skottie has never supported the dotLottie (.lottie) zip archive format. It only parses raw Lottie JSON. This is not a regression."
    },
    "fixStatus": null
  },
  "analysis": {
    "summary": "The user is loading a .lottie file (dotLottie format), which is a zip archive containing Lottie JSON and assets. Skottie's Animation.Create() expects raw Lottie JSON data, not a zip archive, so it correctly returns null when it cannot parse the zip bytes as JSON. This is a format misunderstanding, not a defect.",
    "keySignals": [
      {
        "text": "Loading .lottie file results in null SkiaSharp.Skottie.Animation",
        "source": "title",
        "interpretation": "The .lottie extension indicates the dotLottie format (zip archive), which is distinct from raw Lottie JSON (.json)"
      },
      {
        "text": "No exception is thrown, so it fails silently",
        "source": "body",
        "interpretation": "This is expected SkiaSharp factory method behavior — Create() returns null on failure rather than throwing. Not a bug."
      },
      {
        "text": "var animation = SkiaSharp.Skottie.Animation.Create(sourceFileAbsolute);",
        "source": "body",
        "interpretation": "Animation.Create reads file bytes and passes to Skottie parser, which expects JSON. A zip file will fail parsing."
      },
      {
        "text": "https://app.lottiefiles.com/animation/...",
        "source": "body",
        "interpretation": "LottieFiles offers downloads in both .json and .lottie formats. The user downloaded the .lottie (dotLottie) variant."
      }
    ],
    "fieldRationales": [
      {
        "field": "type",
        "chosen": "type/question",
        "expandedReason": "The user expects Animation.Create to handle .lottie files, but the dotLottie format (a zip archive) is fundamentally different from raw Lottie JSON. The API is working as designed — it returns null for data it cannot parse. This is a format confusion, not broken behavior.",
        "alternatives": [
          { "value": "type/bug", "whyRejected": "The API correctly returns null for unparseable input. Silent null return is the documented factory method pattern in SkiaSharp." },
          { "value": "type/feature-request", "whyRejected": "While dotLottie support could be a valid feature request, the user is not requesting new functionality — they are confused about why their file doesn't work." }
        ]
      },
      {
        "field": "area",
        "chosen": "area/SkiaSharp",
        "expandedReason": "SkiaSharp.Skottie.Animation is part of the SkiaSharp.Skottie package which wraps Skia's Skottie module. The issue is in the Skottie animation loading API.",
        "alternatives": []
      },
      {
        "field": "platforms",
        "chosen": "os/Windows-Classic",
        "expandedReason": "User explicitly states Windows 11 with Visual Studio (Windows). However, this is not a platform-specific issue — the format incompatibility exists on all platforms."
      },
      {
        "field": "actionability.suggestedAction",
        "chosen": "close-with-docs",
        "expandedReason": "The answer is clear: .lottie files are zip archives that must be extracted to get the raw Lottie JSON before passing to Skottie. The user can re-download the animation as .json from LottieFiles instead."
      }
    ],
    "uncertainties": [
      "Whether the user has tried downloading the same animation in .json format from LottieFiles (which would work)",
      "Whether there is demand for native dotLottie format support in SkiaSharp.Skottie"
    ],
    "assumptions": [
      "Assumed the file is a dotLottie (.lottie) zip archive based on the title and LottieFiles download link, since LottieFiles defaults to .lottie format",
      "Assumed no prior version of SkiaSharp supported .lottie format since Skottie has always only parsed JSON"
    ],
    "resolution": {
      "hypothesis": "The user downloaded a .lottie file (dotLottie format) which is a zip archive. Skottie only supports raw Lottie JSON, so the zip bytes fail to parse and Create() returns null.",
      "proposals": [
        {
          "title": "Re-download as .json from LottieFiles",
          "description": "LottieFiles provides both .lottie and .json download options. The user should download the .json variant, which contains the raw Lottie JSON that Skottie can parse directly.",
          "confidence": 0.95,
          "effort": "low"
        },
        {
          "title": "Extract JSON from .lottie zip at runtime",
          "description": "Use System.IO.Compression.ZipArchive to open the .lottie file, read the animations/[name].json entry from inside the archive, and pass the extracted JSON string to Animation.Parse().",
          "confidence": 0.85,
          "effort": "low"
        },
        {
          "title": "Add dotLottie format support to SkiaSharp.Skottie",
          "description": "Enhance Animation.Create to detect zip magic bytes and automatically extract the Lottie JSON from dotLottie archives. This would be a new feature requiring changes to the C# wrapper layer.",
          "confidence": 0.70,
          "effort": "medium"
        }
      ],
      "recommendedProposal": "Re-download as .json from LottieFiles",
      "recommendedReason": "Simplest and most immediate solution. No code changes needed — just download the correct format."
    }
  },
  "output": {
    "actionability": {
      "suggestedAction": "close-with-docs",
      "confidence": 0.82,
      "reason": "The .lottie format is not supported by Skottie — the user needs to use raw Lottie JSON instead. Clear answer available."
    },
    "actions": [
      {
        "id": "labels-1",
        "type": "update-labels",
        "risk": "low",
        "description": "Reclassify as question, remove bug and reliability labels",
        "reason": "This is a format misunderstanding, not a bug or reliability issue. The API works correctly for its supported input format.",
        "confidence": 0.82,
        "dependsOn": null,
        "payload": {
          "labelsToAdd": ["type/question"],
          "labelsToRemove": ["type/bug", "tenet/reliability"]
        }
      },
      {
        "id": "comment-1",
        "type": "add-comment",
        "risk": "high",
        "description": "Explain .lottie vs Lottie JSON format difference and provide workaround",
        "reason": "User needs to understand why their file doesn't load and what to do instead",
        "confidence": 0.85,
        "dependsOn": "labels-1",
        "payload": {
          "commentType": "answer",
          "draftBody": "Thanks for the clear reproduction steps and screenshots.\n\nThe `.lottie` format (sometimes called \"dotLottie\") is actually a zip archive that contains the raw Lottie JSON animation along with optional assets. SkiaSharp's Skottie module expects raw Lottie JSON data, so when it tries to parse the zip bytes as JSON, it fails and `Animation.Create()` returns null.\n\nThe simplest fix is to re-download the animation from LottieFiles in `.json` format instead of `.lottie` — LottieFiles offers both options on the download panel.\n\nIf you need to work with `.lottie` files directly, you can extract the JSON at runtime:\n\n```csharp\nusing System.IO.Compression;\n\nusing var zip = ZipFile.OpenRead(sourceFileAbsolute);\nvar entry = zip.Entries.FirstOrDefault(e => e.FullName.EndsWith(\".json\"));\nif (entry != null)\n{\n    using var stream = entry.Open();\n    var animation = SkiaSharp.Skottie.Animation.Create(stream);\n}\n```",
          "requiresHumanEdit": true,
          "finalBody": null,
          "dedupeToken": "triage-3421-comment-1"
        }
      },
      {
        "id": "close-1",
        "type": "close-issue",
        "risk": "medium",
        "description": "Close as answered",
        "reason": "Question answered with explanation and workaround",
        "confidence": 0.78,
        "dependsOn": "comment-1",
        "payload": {
          "reason": "completed",
          "comment": null
        }
      }
    ]
  }
}
