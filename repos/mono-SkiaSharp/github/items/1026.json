{
  "number": 1026,
  "type": "issue",
  "state": "closed",
  "title": "Drawing works in simulator but not on physical iOS devices[BUG] ",
  "body": "I\u0027ve run into a strange issue where I\u0027m using an SKCanvasView to collect some simple drawing. This works fine in the simulator, but when launching on physical iOS devices the TouchAction event handler is never hit. It works fine on Android. \r\n\r\nThis appears to be the same as issue [341](https://github.com/mono/SkiaSharp/issues/341) but that one the person who ran into it reformatted their mac and setup a whole new build environment and then it was fine. To try to replicate that, I setup everything on a separate machine but it must be tied to these specific versions or my project or something because the same result happened on a separate dev machine. \r\n\r\nThanks in advance for any assistance! \r\n\r\nHere\u0027s the relevant code: \r\n\r\n\u0060\u0060\u0060\r\n\r\n\u003CContentPage.Content\u003E \r\n        \u003CRelativeLayout VerticalOptions=\u0022FillAndExpand\u0022 HorizontalOptions=\u0022FillAndExpand\u0022\u003E\r\n              \u003CImage x:Name=\u0022imgBG\u0022\r\n                      Aspect=\u0022AspectFit\u0022\r\n            RelativeLayout.WidthConstraint= \u0022{ConstraintExpression Type=RelativeToParent, Property=Width}\u0022\r\n            RelativeLayout.HeightConstraint= \u0022{ConstraintExpression Type=RelativeToParent, Property=Height}\u0022\u003E\u003C/Image\u003E\r\n             \u003CStackLayout VerticalOptions=\u0022FillAndExpand\u0022 HorizontalOptions=\u0022FillAndExpand\u0022  RelativeLayout.WidthConstraint=\r\n         \u0022{ConstraintExpression Type=RelativeToParent,\r\n                                Property=Width,\r\n                                Factor=1}\u0022\r\n     RelativeLayout.HeightConstraint=\r\n         \u0022{ConstraintExpression Type=RelativeToParent,\r\n                                Property=Height,\r\n                                Factor=1}\u0022 BackgroundColor=\u0022Transparent\u0022\u003E\r\n            \u003CGrid VerticalOptions=\u0022FillAndExpand\u0022 HorizontalOptions=\u0022FillAndExpand\u0022 BackgroundColor=\u0022Transparent\u0022\u003E\r\n               \u003Cskia:SKCanvasView x:Name=\u0022canvasView\u0022 BackgroundColor=\u0022Transparent\u0022 PaintSurface=\u0022OnCanvasViewPaintSurface\u0022 VerticalOptions=\u0022FillAndExpand\u0022 HorizontalOptions=\u0022FillAndExpand\u0022 /\u003E\r\n                \u003CGrid.Effects\u003E\r\n                 \u003Ctt1:TouchEffect Capture=\u0022True\u0022\r\n                                        TouchAction=\u0022OnTouchEffectAction\u0022 /\u003E\r\n            \u003C/Grid.Effects\u003E\r\n                \u003C/Grid\u003E\r\n\r\n            \u003CGrid HorizontalOptions=\u0022CenterAndExpand\u0022 Padding=\u002220\u0022\u003E\r\n             \u003CButton x:Name=\u0022btnClear\u0022 Text=\u0022Clear\u0022 Clicked=\u0022btnClear_ClickedAsync\u0022 Grid.Column=\u00220\u0022 BackgroundColor=\u0022{DynamicResource btnMutedBG}\u0022 TextColor=\u0022{DynamicResource btnMutedText}\u0022\u003E\u003C/Button\u003E   \r\n             \u003CButton x:Name=\u0022btnCancel\u0022 Text=\u0022Cancel\u0022 Clicked=\u0022btnCancel_ClickedAsync\u0022 Grid.Column=\u00221\u0022 BackgroundColor=\u0022{DynamicResource btnMutedBG}\u0022 TextColor=\u0022{DynamicResource btnMutedText}\u0022\u003E\u003C/Button\u003E\r\n             \u003CButton x:Name=\u0022btnDone\u0022 Text=\u0022Done\u0022 Clicked=\u0022btnDone_ClickedAsync\u0022 Grid.Column=\u00222\u0022 BackgroundColor=\u0022{DynamicResource btnPrimaryBG}\u0022 TextColor=\u0022{DynamicResource btnPrimaryText}\u0022\u003E\u003C/Button\u003E   \r\n           \u003C/Grid\u003E\r\n\r\n            \r\n        \u003C/StackLayout\u003E\r\n        \u003C/RelativeLayout\u003E\r\n       \r\n\r\n    \u003C/ContentPage.Content\u003E\r\n\u0060\u0060\u0060\r\n\r\n\r\nIssue: OnTouchEffectAction handler is never hit when on physical iPad. \r\n\r\n\r\n\r\n- Version with issue: SkiaSharp.Views.Forms 1.68.0\r\n- Last known good version: unknown\r\n- IDE:  Visual Studio for Mac 8.3.9 (build 2)\r\n- Platform Target Frameworks: iOS on iPad, tested on 12.4\r\n- Works perfectly in simulator\r\n  - Android: NA\r\n  - iOS:  12.4\r\n- Target Devices:  iPad air 2\r\n\r\n",
  "author": {
    "login": "twinharbor",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2019-11-21T11:22:04",
  "updatedAt": "2022-08-19T09:02:01",
  "closedAt": "2019-11-27T06:16:00",
  "commentCount": 9,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T14:09:36.0762911Z",
    "reactions": [],
    "comments": [
      {
        "id": 557194802,
        "author": "mattleibow",
        "body": "It might be that the \u0060TouchEffect\u0060 is having issues. Is this a custom effect that you created? If possible, try using the native \u0060Touch\u0060 event on the \u0060SKCanvasView\u0060. Also set the \u0060EnableTouchEvents\u0060 to true.\r\n\r\nDocs:\r\nhttps://docs.microsoft.com/dotnet/api/skiasharp.views.forms.skcanvasview.touch\r\nhttps://docs.microsoft.com/dotnet/api/skiasharp.views.forms.skcanvasview.enabletouchevents",
        "createdAt": "2019-11-21T17:40:18",
        "reactions": []
      },
      {
        "id": 558584301,
        "author": "ilsoftltd",
        "body": "I had the same problem. App which used to work and then stopped working on the physical device but was on on the emulator and Android devices. Pulled my hair out trying to find out what it was. \r\nIn the end, in Visual Studio, I used  the dependencies/references analyser. Quite a few were shown as \u0022Unused\u0022. I deleted all these. The iOS project then didn\u0027t show as having a reference to SkiaSharp.Views.Forms so I added it....and it started working again! I think is was some sort of mis-match of DLLs, also indicated by the fact that if, when it\u0027s not auto calling the ondraw, you try and create a Paint structure for the canvas using a button handler, you receive a \u0022DLLNotFound\u0022 exception. So I guess it\u0027s update every NuGet to the latest version, delete unused references/dependencies and double check required references are included. Hope this works for you.",
        "createdAt": "2019-11-26T11:18:38",
        "reactions": []
      },
      {
        "id": 558603910,
        "author": "twinharbor",
        "body": "Thanks for the replies! \r\n@ilsoftltd - thanks for this, sounds promising! Where is the dependency/reference analyzer? I\u0027m using Visual Studio for Mac (latest version). \r\n@mattleibow - thanks, I do believe I have a custom effect but I think it\u0027s straight out of the example from MS (the finger painting one here: [https://docs.microsoft.com/en-us/xamarin/xamarin-forms/user-interface/graphics/skiasharp/paths/finger-paint](url)). I\u0027ll look into your recommendation as well and see. \r\n",
        "createdAt": "2019-11-26T12:18:44",
        "reactions": []
      },
      {
        "id": 558607783,
        "author": "ilsoftltd",
        "body": "I right clicked the \u0022References\u0022 folder under each project in turn and chose \u0022Optimize References..,\u0022 from the popup menu.\r\nThis brought up a window listing Unused and Used references and allowed me to delete the unused ones. I see there is a \u0022Delete Unused References\u0022 menu item too which I\u0027m guessing shortcuts this.\r\nThis was on VS2019 on Windows mind you!\r\n",
        "createdAt": "2019-11-26T12:30:49",
        "reactions": []
      },
      {
        "id": 558615477,
        "author": "twinharbor",
        "body": "Ah ha- seems some things are in VS for windows and not mac. Fortunately I also have windows running in parallels, but I\u0027ve been on vs 2017. I\u0027m going to update to 2019 and then see if I can open the project on that side. Thanks!",
        "createdAt": "2019-11-26T12:54:14",
        "reactions": []
      },
      {
        "id": 558666391,
        "author": "twinharbor",
        "body": "@ilsoftltd - do you have an addin or something? I don\u0027t have an optimize references option in vs.net 2019 for windows. Googling shows something called resharper that has a function with that name, maybe that\u0027s what you have? ",
        "createdAt": "2019-11-26T14:55:29",
        "reactions": []
      },
      {
        "id": 558677769,
        "author": "ilsoftltd",
        "body": "Ah yes I do use Resharper :) ",
        "createdAt": "2019-11-26T15:18:59",
        "reactions": []
      },
      {
        "id": 558792074,
        "author": "twinharbor",
        "body": "Thanks to all who posted ideas. I tried several things, and nothing worked but as I looked closer at your mention of EnableTouchEvents (@mattleibow ) I saw that in the sample code I was working from, it adds a toucheffect to Grid.Effects, whereas it seems we should be adding a touch handler directly to the SKCanvasView: EnableTouchEvents=\u0022True\u0022 Touch=\u0022CanvasView_Touch\u0022. I had to rework the handler a little bit, but overall the functionality is the same, and now it\u0027s all working! Thanks all! ",
        "createdAt": "2019-11-26T19:53:49",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "hooray",
            "createdAt": "2026-02-06T14:09:35.8151472Z"
          }
        ]
      },
      {
        "id": 558946800,
        "author": "mattleibow",
        "body": "@twinharbor That is good to hear! Let us know if you have any other issues.",
        "createdAt": "2019-11-27T06:16:00",
        "reactions": []
      }
    ]
  }
}