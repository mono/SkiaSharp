{
  "number": 3440,
  "type": "issue",
  "state": "open",
  "title": "[BUG] Exception: SkiaSharp.Views.WinUI.Native.PropertySetExtensions",
  "body": "### Description\n\nDeploying a MAUI app with LiveCharts2 that uses SkiaSharp 3.199.1 for drawing on Windows crashes on certain systems with the following exception:\n\n\u0060\u0060\u0060\nSystem.Runtime.InteropServices.COMException: Element not found.\n\n  at void Marshal.ThrowExceptionForHR(int errorCode)() in Marshal.cs:line 856\n  at new BaseActivationFactory(string typeNamespace, string typeFullName)()\n  at static PropertySetExtensions()()\n\nSystem.TypeInitializationException: The type initializer for \u0027SkiaSharp.Views.WinUI.Native.PropertySetExtensions\u0027 threw an exception.\n  at IObjectReference PropertySetExtensions.get__objRef_global__SkiaSharp_Views_WinUI_Native_IPropertySetExtensionsStatics()()\n  at void PropertySetExtensions.AddSingle(PropertySet propertySet, string key, float value)()\n  at void GlesContext.CreateSurface(SwapChainPanel panel, Size? renderSurfaceSize, float? resolutionScale)()\n  at void AngleSwapChainPanel.EnsureRenderSurface()()\n  at void AngleSwapChainPanel.OnLoaded(object sender, RoutedEventArgs e)()\n  at int RoutedEventHandler.Do_Abi_Invoke(IntPtr thisPtr, IntPtr sender, IntPtr e)()\n\u0060\u0060\u0060\n\nWe have tried both with HA enabled and disabled but the result is the same. Is there any idea what may cause this issue?\n\n### Code\n\n\u0060\u0060\u0060xaml\n\u003CliveCharts:CartesianChart x:Name=\u0022Graph\u0022\n                                   AbsoluteLayout.LayoutBounds=\u00220,0,1,1\u0022\n                                   AbsoluteLayout.LayoutFlags=\u0022PositionProportional,SizeProportional\u0022\n                                   ZoomMode=\u0022None\u0022\n                                   EasingFunction=\u0022{x:Null}\u0022\n                                   ... /\u003E\n\u0060\u0060\u0060\n\n### Expected Behavior\n\nSkiaSharp should render the graph as intended\n\n### Actual Behavior\n\nSkiaSharp crashes with an exception \n\n\u0060\u0060\u0060\nSystem.TypeInitializationException: The type initializer for \u0027SkiaSharp.Views.WinUI.Native.PropertySetExtensions\u0027 threw an exception.\n  at IObjectReference PropertySetExtensions.get__objRef_global__SkiaSharp_Views_WinUI_Native_IPropertySetExtensionsStatics()()\n  at void PropertySetExtensions.AddSingle(PropertySet propertySet, string key, float value)()\n  at void GlesContext.CreateSurface(SwapChainPanel panel, Size? renderSurfaceSize, float? resolutionScale)()\n  at void AngleSwapChainPanel.EnsureRenderSurface()()\n  at void AngleSwapChainPanel.OnLoaded(object sender, RoutedEventArgs e)()\n  at int RoutedEventHandler.Do_Abi_Invoke(IntPtr thisPtr, IntPtr sender, IntPtr e)()\n\u0060\u0060\u0060\n\n### Version of SkiaSharp\n\n3.116.0 (Current)\n\n### Last Known Good Version of SkiaSharp\n\nOther (Please indicate in the description)\n\n### IDE / Editor\n\nOther (Please indicate in the description)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\nWindows 11 (10.0.26100.7462)\n\n### Devices\n\nLenovo 83C4\n\n### Relevant Screenshots\n\n_No response_\n\n### Relevant Log Output\n\n\u0060\u0060\u0060shell\n\n\u0060\u0060\u0060\n\n### Code of Conduct\n\n- [x] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "jo-ruch",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    },
    {
      "name": "area/SkiaSharp.Views.Maui",
      "color": "0052cc"
    },
    {
      "name": "os/Windows-WinUI",
      "color": "fbca04"
    },
    {
      "name": "tenet/reliability",
      "color": "BFD4F2"
    },
    {
      "name": "backend/SkiaSharp",
      "color": "ededed"
    }
  ],
  "assignees": [],
  "createdAt": "2026-01-19T11:37:02",
  "updatedAt": "2026-01-19T11:37:49",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:21:53.9403502Z",
    "reactions": [],
    "comments": [
      {
        "id": 3767893108,
        "author": "github-actions[bot]",
        "body": "**Triage Summary**  \n\nLabels will be applied to highlight the affected components (SkiaSharp and WinUI) and the area of concern (SkiaSharp.Views.Maui) within the MAUI app environment.\n\nThis issue is not marked as a regression; however, it indicates reliability concerns with SkiaSharp when integrated in a MAUI app on Windows.\n\nAdditional remarks:\n* The issue seems to be linked to how graphical content is handled in the SkiaSharp library during MAUI app deployment.\n\n\u003Cdetails\u003E\n\u003Csummary\u003EDetailed Summary and Actions\u003C/summary\u003E\n\nSummary of the triage:\n\n- The issue relates to the SkiaSharp library, specifically the \u0060SkiaSharp.Views.WinUI.Native.PropertySetExtensions\u0060, which indicates a crash when handling graphical content.\n- The issue pertains to a MAUI application using SkiaSharp on Windows, specifically related to WinUI components.\n- There are reliability concerns regarding the crashing behavior of SkiaSharp in the MAUI app environment.\n- The issue specifically focuses on the SkiaSharp.Views component for rendering within MAUI applications.\n\nSummary of the actions that will be performed:\n\n| Action   | Item                              | Description                                                                                                           |\n| :------- | :-------------------------------- | :------------------------------------------------------------------------------------------------------------------ |\n| Apply Label | backend/SkiaSharp             | The issue is related to a crash in the SkiaSharp library, indicating a problem with graphical content handling.     |\n| Apply Label | os/Windows-WinUI              | The issue is connected to a MAUI app using SkiaSharp on Windows, indicating a crash related to WinUI components.    |\n| Apply Label | tenet/reliability              | The issue describes a crash behavior that aligns with reliability issues when deploying SkiaSharp in a MAUI app.    |\n| Apply Label | area/SkiaSharp.Views.Maui      | The issue pertains to the rendering problem of a MAUI app using SkiaSharp, focusing on the SkiaSharp.Views component. |\n\n\u003C/details\u003E\n\n_This entire triage process was automated by AI and mistakes may have been made. Please let us know so we can continue to improve._",
        "createdAt": "2026-01-19T11:37:48",
        "reactions": []
      }
    ]
  }
}