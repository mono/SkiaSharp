{
  "number": 3025,
  "type": "issue",
  "state": "closed",
  "title": "SkiaSharp.NativeAssets.Android contains a shared library \u0027libSkiaSharp.so\u0027 which is not correctly aligned",
  "body": "### Is your feature request related to a problem?\r\n\r\nBuilding a .net  MAUI project with Skia gives these warnings\r\n\r\n\u003E NuGet package \u0027SkiaSharp.NativeAssets.Android\u0027 version \u00273.0.0-preview.3.1\u0027 contains a shared library \u0027libSkiaSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n\r\n### Describe the solution you would like\r\n\r\nAlignment issues solved for .net 9 \r\n\r\n### Describe alternatives you have considered\r\n\r\nIt\u0027s not ab locking issue, since it can compile, just to leave this into consideration\r\n\r\n### Additional context\r\n\r\n_No response_\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "bcaceiro",
    "type": "User"
  },
  "labels": [
    {
      "name": "os/Android",
      "color": "fbca04"
    },
    {
      "name": "area/libSkiaSharp.native",
      "color": "0052cc"
    },
    {
      "name": "type/feature-request",
      "color": "ededed"
    }
  ],
  "assignees": [],
  "milestone": "3.118.0",
  "createdAt": "2024-10-01T13:07:12",
  "updatedAt": "2024-12-06T10:57:10",
  "closedAt": "2024-12-04T05:39:36",
  "commentCount": 13,
  "reactionCount": 6,
  "engagement": {
    "syncedAt": "2026-02-06T12:48:20.2491518Z",
    "reactions": [
      {
        "user": "tipa",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:48:20.249157Z"
      },
      {
        "user": "mormegil-cz",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:48:20.2491578Z"
      },
      {
        "user": "kokada420",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:48:20.249158Z"
      },
      {
        "user": "maxbrousseau",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:48:20.2491581Z"
      },
      {
        "user": "Domik234",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:48:20.2491582Z"
      },
      {
        "user": "lassana",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:48:20.2491583Z"
      }
    ],
    "comments": [
      {
        "id": 2439487288,
        "author": "mattleibow",
        "body": "@jonathanpeppers any thoughts on what this means?",
        "createdAt": "2024-10-26T10:47:17",
        "reactions": []
      },
      {
        "id": 2441838854,
        "author": "jonathanpeppers",
        "body": "This is the upcoming 16kb alignment requirement for Google Play, and probably Android 16 / API 36 next year.\r\n\r\n@grendello were you looking at this for SkiaSharp?",
        "createdAt": "2024-10-28T15:00:56",
        "reactions": []
      },
      {
        "id": 2442429865,
        "author": "grendello",
        "body": "@jonathanpeppers I tried to, but couldn\u0027t build it locally and then I got distracted by other tasks.  I\u0027ll try to look into it soon.",
        "createdAt": "2024-10-28T19:19:25",
        "reactions": []
      },
      {
        "id": 2442865712,
        "author": "mattleibow",
        "body": "Is there some compiler/linker flag? If this is a Google requirement, then I am sure the latest skia code will have it somewhere and I could find it with a code search and backport. ",
        "createdAt": "2024-10-28T23:31:27",
        "reactions": []
      },
      {
        "id": 2443724065,
        "author": "grendello",
        "body": "\u003E Is there some compiler/linker flag? If this is a Google requirement, then I am sure the latest skia code will have it somewhere and I could find it with a code search and backport.\r\n\r\nIf building with the NDK r28 (not yet released), the 16k alignment would be enabled automatically.  With older NDK versions, one has to pass the \u0060-Wl,-z,max-page-size=16384\u0060 flag to the compiler when linking (or \u0060-z max-page-size=16384\u0060 when invoking the linker directly)\r\n\r\nYou can find more details [here](https://android-developers.googleblog.com/2024/08/adding-16-kb-page-size-to-android.html) and [here](https://developer.android.com/guide/practices/page-sizes)",
        "createdAt": "2024-10-29T09:43:50",
        "reactions": []
      },
      {
        "id": 2510472623,
        "author": "maonaoda",
        "body": "Any news? Currently I can\u0027t start any page using SkiaSharp on the emulator that API over 35\r\n\u0060\u0060\u0060\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027HarfBuzzSharp.NativeAssets.Android\u0027 version \u00277.3.0.2\u0027 contains a shared library \u0027libHarfBuzzSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027SkiaSharp.NativeAssets.Android\u0027 version \u00273.118.0-preview.1.2\u0027 contains a shared library \u0027libSkiaSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027HarfBuzzSharp.NativeAssets.Android\u0027 version \u00277.3.0.2\u0027 contains a shared library \u0027libHarfBuzzSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027SkiaSharp.NativeAssets.Android\u0027 version \u00273.118.0-preview.1.2\u0027 contains a shared library \u0027libSkiaSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027\u003Cunknown\u003E\u0027 version \u0027\u003Cunknown\u003E\u0027 contains a shared library \u0027libbarhopper_v3.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027\u003Cunknown\u003E\u0027 version \u0027\u003Cunknown\u003E\u0027 contains a shared library \u0027libbarhopper_v3.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n\u0060\u0060\u0060\r\n\r\n![image](https://github.com/user-attachments/assets/07a5bba0-dbbb-4feb-a9ce-f7febb6f5e51)\r\n",
        "createdAt": "2024-12-02T03:10:27",
        "reactions": []
      },
      {
        "id": 2512643999,
        "author": "NickDufour",
        "body": "We are also encountering the 16 KB page size issue on Android 15 (API 35) with SkiaSharp when running our application on devices that require 16 KB paging",
        "createdAt": "2024-12-02T19:56:05",
        "reactions": []
      },
      {
        "id": 2513374005,
        "author": "mattleibow",
        "body": "@jonathanpeppers is this true? The sims won\u0027t even launch an app with non-aligned binaries? ",
        "createdAt": "2024-12-03T01:59:57",
        "reactions": []
      },
      {
        "id": 2513739726,
        "author": "fntc",
        "body": "Tried it yesterday. Can confirm that the very same apk can launch in emulator with image V34 but not with V35. However, I have a few other native libraries the build process complains about",
        "createdAt": "2024-12-03T07:21:15",
        "reactions": []
      },
      {
        "id": 2514773236,
        "author": "grendello",
        "body": "\u003E @jonathanpeppers is this true? The sims won\u0027t even launch an app with non-aligned binaries?\r\n\r\nYes, they won\u0027t.  However, in the emulator one [can disable](https://developer.android.com/guide/practices/page-sizes#developer-option) the 16k alignment (in x86_64 images at least)",
        "createdAt": "2024-12-03T14:45:32",
        "reactions": []
      },
      {
        "id": 2522538217,
        "author": "maonaoda",
        "body": "Do you need to modify this?\r\n\u0060\u0060\u0060\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027HarfBuzzSharp.NativeAssets.Android\u0027 version \u00277.3.0.2\u0027 contains a shared library \u0027libHarfBuzzSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n    /usr/local/share/dotnet/packs/Microsoft.Android.Sdk.Darwin/35.0.7/tools/Xamarin.Android.Common.targets(2076,3): warning XA0141: NuGet package \u0027HarfBuzzSharp.NativeAssets.Android\u0027 version \u00277.3.0.2\u0027 contains a shared library \u0027libHarfBuzzSharp.so\u0027 which is not correctly aligned. See https://developer.android.com/guide/practices/page-sizes for more details\r\n\u0060\u0060\u0060",
        "createdAt": "2024-12-06T08:49:56",
        "reactions": []
      },
      {
        "id": 2522661132,
        "author": "maonaoda",
        "body": "Well,that because the other packages I referenced are still using the old version",
        "createdAt": "2024-12-06T09:42:25",
        "reactions": []
      },
      {
        "id": 2522851368,
        "author": "mattleibow",
        "body": "To solve that, you can just install the latest HarfBuzzSharp and it will pull in the latest dependencies.",
        "createdAt": "2024-12-06T10:57:08",
        "reactions": [
          {
            "user": "maonaoda",
            "content": "heart",
            "createdAt": "2026-02-06T12:48:20.1989499Z"
          }
        ]
      }
    ]
  }
}