{
  "number": 2961,
  "type": "issue",
  "state": "closed",
  "title": "Unable to load shared library \u0027libSkiaSharp\u0027 exception occurs using DOT NET 8 AWS Lambda",
  "body": "### Description\r\n\r\nWe have created the SKBitmap and drawn a rectangle, circle, and line in .NET using AWS Lambda. We encountered an issue while using SkiaSharp.NativeAssets.Linux NuGet in an AWS Lambda - we faced the \u0027Unable to load shared library \u0027libSkiaSharp\u0027 exception. However, this issue does not occur when using .NET6 AWS Lambda.\r\n\r\nPlatform: AWS Lambda\r\nVisual Studio version: 2022\r\n.NET version :   .NET8 \r\nSkiaSharp version : 2.88.6\r\n\r\n### Code\r\n\r\nThe best way to share code for larger projects is a link to a GitHub repository: https://github.com/user/repo/tree/bug-123\r\n\r\nBut, you can also share a short block of code here:\r\n\u0060\u0060\u0060cs\r\npublic string FunctionHandler( ILambdaContext context)\r\n{\r\n     //Define the image dimensions\r\n     int width = 800;\r\n     int height = 600;\r\n     string base64String;\r\n \r\n     //Create a new bitmap\r\n     using (var bitmap = new SKBitmap(width, height))\r\n     {\r\n         // Create a canvas to draw on the bitmap\r\n         using (var canvas = new SKCanvas(bitmap))\r\n         {\r\n             // Clear the canvas with a white color\r\n             canvas.Clear(SKColors.White);\r\n \r\n             // Define the paint for drawing shapes\r\n             var paint = new SKPaint\r\n             {\r\n                 Color = SKColors.Blue,\r\n                 IsAntialias = true,\r\n                 Style = SKPaintStyle.Stroke,\r\n                 StrokeWidth = 5\r\n             };\r\n \r\n             // Draw a rectangle\r\n             var rect = new SKRect(100, 100, 300, 300);\r\n             canvas.DrawRect(rect, paint);\r\n \r\n             // Draw a circle\r\n             paint.Color = SKColors.Red;\r\n             canvas.DrawCircle(400, 400, 100, paint);\r\n \r\n             // Draw a line\r\n             paint.Color = SKColors.Green;\r\n             canvas.DrawLine(500, 100, 700, 300, paint);\r\n \r\n             // Save the bitmap to a file\r\n             using (var image = SKImage.FromBitmap(bitmap))\r\n             using (var data = image.Encode(SKEncodedImageFormat.Png, 100))\r\n \r\n             using (var memoryStream = new MemoryStream())\r\n             {\r\n                 data.SaveTo(memoryStream);\r\n                 byte[] imageBytes = memoryStream.ToArray();\r\n                 base64String = Convert.ToBase64String(imageBytes);\r\n                 Console.WriteLine(base64String);\r\n \r\n                 // Print or return the base64 string\r\n             }\r\n         }\r\n     }\r\n     return base64String;\r\n}\r\n// some C# code here\r\n\u0060\u0060\u0060\r\nYou can also share some XAML:\r\n\u0060\u0060\u0060xaml\r\n\u003C!-- xaml code here --\u003E\r\n\u0060\u0060\u0060\r\n\r\n\r\n### Expected Behavior\r\n\r\nThe program should run without any exceptions in AWS Lambda .NET8 \r\n\r\n### Actual Behavior\r\n\r\nGet an exception is **.NET version 8** \r\nWorking fine in **.NET version 6**\r\n\r\n**System.DllNotFoundException: Unable to load shared library \u0027libSkiaSharp\u0027 or one of its dependencies. In order to help diagnose loading problems, consider using a tool like Strace. If you\u0027re using glibc, consider setting the LD_DEBUG environment variable.** \r\n\r\n### Version of SkiaSharp\r\n\r\nOther (Please indicate in the description)\r\n\r\n### Last Known Good Version of SkiaSharp\r\n\r\n2.88.2 (Previous)\r\n\r\n### IDE / Editor\r\n\r\nVisual Studio (Windows)\r\n\r\n### Platform / Operating System\r\n\r\nWindows\r\n\r\n### Platform / Operating System Version\r\n\r\nWindows 11\r\n\r\n### Devices\r\n\r\nAsus 12th Gen Intel(R) Core(TM) i5-1235U   1.30 GHz\r\n \r\n\r\n### Relevant Screenshots\r\n\r\n_No response_\r\n\r\n### Relevant Log Output\r\n\r\n_No response_\r\n\r\n### Code of Conduct\r\n\r\n- [x] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "pandi123",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    },
    {
      "name": "status/needs-info",
      "color": "B8EC4A"
    },
    {
      "name": "status/no-recent-activity",
      "color": "B8EC4A"
    }
  ],
  "assignees": [],
  "createdAt": "2024-07-30T12:38:58",
  "updatedAt": "2024-11-04T03:35:50",
  "closedAt": "2024-11-04T03:35:50",
  "commentCount": 7,
  "reactionCount": 3,
  "engagement": {
    "syncedAt": "2026-02-06T12:49:48.6127956Z",
    "reactions": [
      {
        "user": "2mik",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:49:48.6128002Z"
      },
      {
        "user": "iharmaiseyeu",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:49:48.6128011Z"
      },
      {
        "user": "Soundman32",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:49:48.6128013Z"
      }
    ],
    "comments": [
      {
        "id": 2271582872,
        "author": "2mik",
        "body": "Got the same issue on Debian GNU/Linux 12 (bookworm), .NET8, and SkiaSharp 2.88.6.",
        "createdAt": "2024-08-06T15:33:59",
        "reactions": []
      },
      {
        "id": 2272706974,
        "author": "2mik",
        "body": "In my case \u0060sudo apt install libfontconfig1\u0060 solved the issue. But the error message (in the page title) is not clear for that purpose. See [this](https://github.com/mono/SkiaSharp/issues/1341) thread.",
        "createdAt": "2024-08-07T06:22:30",
        "reactions": [
          {
            "user": "jxingnet",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:49:47.6001961Z"
          }
        ]
      },
      {
        "id": 2310428495,
        "author": "iharmaiseyeu",
        "body": "I have the same issue after moving Linux Azure Functions to .NET 8. Everything works perfectly fine on .NET 6. \r\n\r\nBecause it is Azure Function I cannot use \u0060sudo apt install libfontconfig1\u0060 to install additional dependencies. \r\n\r\nThe following packages were installed:\r\n\u0060\u0060\u0060\r\n\u003CPackageReference Include=\u0022SkiaSharp\u0022 Version=\u00222.88.8\u0022 /\u003E\r\n\u003CPackageReference Include=\u0022SkiaSharp.NativeAssets.Linux.NoDependencies\u0022 Version=\u00222.88.8\u0022 /\u003E\r\n\u0060\u0060\u0060\r\n\r\nThere is the [solution](https://github.com/mono/SkiaSharp/issues/1341#issuecomment-1172472310) in the thread #1341 but it looks mostly like a workaround, not like a real fix.",
        "createdAt": "2024-08-26T15:00:27",
        "reactions": []
      },
      {
        "id": 2388552485,
        "author": "Soundman32",
        "body": "Same issue on AWS Lambda with .NET8.  Haven\u0027t tried .NET6.",
        "createdAt": "2024-10-02T12:43:34",
        "reactions": []
      },
      {
        "id": 2439585128,
        "author": "mattleibow",
        "body": "I am testing here with AWS and it works for me: https://github.com/mattleibow/SkiaSharpAwsLambda\r\n\r\nI am using the \u0060SkiaSharp.NativeAssets.Linux.NoDependencies\u0060 package to avoid having to install OS dependencies. If you don\u0027t want this one, then you will have to use the docker containers.\r\n\r\nI have included both examples in the repo.",
        "createdAt": "2024-10-26T13:29:40",
        "reactions": []
      },
      {
        "id": 2439600645,
        "author": "dotnet-policy-service[bot]",
        "body": "Hi @pandi123. We have added the \u0060status/needs-info\u0060 label to this issue, which indicates that we have an open question for you before we can take further action. This issue will be closed automatically in 7 days if we do not hear back from you by then - please feel free to re-open it if you come back to this issue after that time.\n\u003C!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003E",
        "createdAt": "2024-10-26T14:22:52",
        "reactions": []
      },
      {
        "id": 2449515326,
        "author": "dotnet-policy-service[bot]",
        "body": "This issue has been automatically marked as stale because it has been marked as requiring author feedback but has not had any activity for **4 days**. It will be closed if no further activity occurs **within 3 days of this comment**. If it *is* closed, feel free to comment when you are able to provide the additional information and we will re-investigate.\n\u003C!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003E",
        "createdAt": "2024-10-31T10:22:49",
        "reactions": []
      }
    ]
  }
}