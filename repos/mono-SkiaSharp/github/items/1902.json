{
  "number": 1902,
  "type": "issue",
  "state": "open",
  "title": "SKTypeface.FromFamilyName does not change the font or text style in SkiaSharp.Views.Blazor",
  "body": "Unexpected behavior when changing the text font when drawing text. If you query what type of text it should have after assigning **Typeface**, it is always \u0060\u0060\u0060typeFace: Noto Mono.\u0060\u0060\u0060\r\n\r\nThe following example illustrates the supposed issue,\r\n\r\n\u0060\u0060\u0060csharp\r\n@page \u0022/drawing-text\u0022\r\n@using SkiaSharp\r\n@using SkiaSharp.Views.Blazor\r\n\r\n\u003CSKCanvasView OnPaintSurface=\u0022OnPaintSurface\u0022  /\u003E\r\n\r\n@code {\r\n    void OnPaintSurface(SKPaintSurfaceEventArgs e)\r\n    {\r\n        var canvas = e.Surface.Canvas;\r\n\r\n        var fontFamily = \u0022Tahoma\u0022; // \u0022Arial\u0022 | \u0022Calibri\u0022 | ... none works?\r\n        var typeFace = SKTypeface.FromFamilyName(fontFamily, SKFontStyle.BoldItalic);\r\n        // query\r\n        Console.WriteLine(\u0022typeFace: {0}\u0022, typeFace.FamilyName); //? typeFace: Noto Mono\r\n\r\n        using SKPaint paint = new() {\r\n                Style = SKPaintStyle.Fill,\r\n                TextSize = 26,\r\n                IsAntialias = true,\r\n                Typeface = typeFace\r\n            };\r\n\r\n        canvas.DrawText(\u0022Fancy Text\u0022, 30, 30, paint); //? draw with Noto Mono\r\n    }\r\n}\r\n\u0060\u0060\u0060\r\n\u003E The expected behavior is that the text is drawn with the text font and text style. I have tried the equivalent code in other scenarios and it works fine.\r\n\r\n\r\n\r\n\r\n",
  "author": {
    "login": "harveytriana",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2021-12-22T17:19:59",
  "updatedAt": "2025-01-17T19:28:42",
  "commentCount": 14,
  "reactionCount": 1,
  "engagement": {
    "syncedAt": "2026-02-06T13:30:43.4238024Z",
    "reactions": [
      {
        "user": "baskren",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:30:43.4238073Z"
      }
    ],
    "comments": [
      {
        "id": 1000231967,
        "author": "Gillibald",
        "body": "Skia\u0027s font manager is highly limited under wasm so  you can\u0027t expect a functional font manager. It is better to load fonts explicitly via stream in a sandbox environment.",
        "createdAt": "2021-12-23T11:15:15",
        "reactions": [
          {
            "user": "harveytriana",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:30:40.8230417Z"
          }
        ]
      },
      {
        "id": 1000528297,
        "author": "harveytriana",
        "body": "True Gillibald. Studying the \u00ABissue \u00BB, it can be deduced that from WASM we do not have access to the Browser resources, so *SKTypeface* returns the *Default*, without warning. - Although I guess should be possible to do so, just like CSS you can use \u0022Arial\u0022, to name something.\r\n\r\nIf anything, that\u0027s correct, I had already found a way to fix it.\r\n\r\n- The file TTF file is added as an embedded resource (ideal)\r\n- The font is loaded with SKTypeface.FromStream, reading the resource with Reflection.\r\n- To improve the matter, it is provided as a Singleton service in the application. **Issue resolved**\r\n\r\n\r\n\r\n",
        "createdAt": "2021-12-23T21:20:14",
        "reactions": []
      },
      {
        "id": 1047966496,
        "author": "RChrisCoble",
        "body": "This is a deal killer for using SkiaSharp on WASM if every font needs to be an embedded resource.  We have a drawing package we\u0027re porting to Blazor WASM with SkiaSharp wherein the user picks as many fonts as they want in the design portion, with the runtime portion showing the designed graphics.\r\n\r\n@mattleibow do we have options here?",
        "createdAt": "2022-02-22T16:20:16",
        "reactions": [
          {
            "user": "LeaFrock",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:30:41.2050852Z"
          }
        ]
      },
      {
        "id": 1047999905,
        "author": "Gillibald",
        "body": "MAUI does the same there is no way around it and that\u0027s how the web works. Usually those assets are provided via a webservice so font assets can be cached by the browser you don\u0027t have to bloat up your application size.",
        "createdAt": "2022-02-22T16:48:58",
        "reactions": []
      },
      {
        "id": 1048003166,
        "author": "RChrisCoble",
        "body": "I\u0027m fine pulling the fonts from a webservice, as long as there\u0027s _some_ way to do it.  So you\u0027re saying a WASM app pulls the fonts down in some capacity it can be generally loaded with \u0022SKTypeface.FromStream\u0022 ?",
        "createdAt": "2022-02-22T16:52:09",
        "reactions": []
      },
      {
        "id": 1048027778,
        "author": "Gillibald",
        "body": "Yes exactly. Javascript fetch API is available via JSInterop or directly via Emscripten so you will get caching out of the box as long as your service provides proper headers.",
        "createdAt": "2022-02-22T17:17:48",
        "reactions": []
      },
      {
        "id": 1048143989,
        "author": "harveytriana",
        "body": "In this post, https://www.blazorspread.net/blogview/82, I show possibly one of the best ways to handle fonts in Blazor, of course, it also covers MAUI\r\n![image](https://user-images.githubusercontent.com/5245381/155205886-d38c4147-09ea-40b3-9e8e-ad9bf3986ead.png)\r\n",
        "createdAt": "2022-02-22T19:36:12",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "heart",
            "createdAt": "2026-02-06T13:30:42.0125771Z"
          },
          {
            "user": "mattleibow",
            "content": "hooray",
            "createdAt": "2026-02-06T13:30:42.0125773Z"
          }
        ]
      },
      {
        "id": 1048442258,
        "author": "mattleibow",
        "body": "Can\u0027t you also hack the system and have a separate assembly with just fonts. And then use the feature of Blazor to load assemblies on demand? Is that even possible? ",
        "createdAt": "2022-02-23T04:34:25",
        "reactions": []
      },
      {
        "id": 1048755923,
        "author": "harveytriana",
        "body": "Yes",
        "createdAt": "2022-02-23T12:58:36",
        "reactions": []
      },
      {
        "id": 1048973456,
        "author": "RChrisCoble",
        "body": "Is this even legal though?\r\n\r\n[Font redistribution FAQ - Typography | Microsoft Docs](https://docs.microsoft.com/en-us/typography/fonts/font-faq)[](https://docs.microsoft.com/en-us/typography/fonts/font-faq)\r\n\r\nWeb fonts are fonts that are hosted on a web server. You do not have rights to:\r\n\r\ncopy fonts from a Windows installation to a web server, a process known as web font \u201Cself-hosting\u201D.\r\nconvert the font to the formats typically associated with web fonts, such as the WOFF or WOFF2 format.",
        "createdAt": "2022-02-23T16:34:11",
        "reactions": []
      },
      {
        "id": 1106712240,
        "author": "jonchardy",
        "body": "This is a major pain point. I work on a diagramming library and we\u0027re hoping to add Blazor as a target. We need to provide our users with flexibility in fonts. How would one go about creating an SKTypeface dynamically, from a given family name, where we don\u0027t control what potential families may be used?",
        "createdAt": "2022-04-22T17:20:19",
        "reactions": []
      },
      {
        "id": 1888541284,
        "author": "qwertzou",
        "body": "\u003E \u5728\u8FD9\u7BC7\u6587\u7AE0\u4E2D\uFF0Chttps://www.blazorspread.net/blogview/82\uFF0C\u6211\u5C55\u793A\u4E86\u53EF\u80FD\u662F Blazor \u4E2D\u5904\u7406\u5B57\u4F53\u7684\u6700\u4F73\u65B9\u6CD5\u4E4B\u4E00\uFF0C\u5F53\u7136\uFF0C\u5B83\u8FD8\u6DB5\u76D6\u4E86 MAUI ![\u56FE\u50CF](https://user-images.githubusercontent.com/5245381/155205886-d38c4147-09ea-40b3-9e8e-ad9bf3986ead.png)\r\n\r\ncannot access",
        "createdAt": "2024-01-12T07:08:43",
        "reactions": []
      },
      {
        "id": 2575556716,
        "author": "mennowo",
        "body": "Any news or ideas on this? I am running into this issue working on a WASM Blazor app where I\u0027d like to use OxyPlot via SkiaSharp such as done in [this library](https://github.com/JensKrumsieck/OxyPlot.SkiaSharp.Blazor). Right now, it all works, but only renders using a monospaced default font. Setting \u0060DefaultFont\u0060 on the \u0060PlotModel\u0060 has no effect at all. Is there a solution other than embedding fonts in my app?",
        "createdAt": "2025-01-07T15:18:55",
        "reactions": []
      },
      {
        "id": 2599052421,
        "author": "mennowo",
        "body": "Actually, the comment by @harveytriana [here](https://github.com/mono/SkiaSharp/issues/1902#issuecomment-1000528297) solves this issue. Embedding a font in my WASM Blazor app and loading it via a stream does indeed work.\r\n\r\nA different solution seems unlikely, given that WASM has no direct access to browser resources, as far as I understand. Unless there is some clean way to do this via JS interop inside the SkiaSharp.Views.Blazor library.\r\n\r\nIn my opion, unless a potential better solution is doable some time soon, this issue should be closed for clarity. ",
        "createdAt": "2025-01-17T19:28:41",
        "reactions": []
      }
    ]
  }
}