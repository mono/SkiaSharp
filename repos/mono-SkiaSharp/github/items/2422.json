{
  "number": 2422,
  "type": "issue",
  "state": "closed",
  "title": "[QUESTION] why picture will lose color?",
  "body": "- this is my code, is any place can set color config?\r\n- saved picture will become lighter\uFF0Cwhy?\r\n\u0060\u0060\u0060\u0060\r\nvar _img = SKBitmap.Decode(selectedImagePath)\r\nSKImage image = SKImage.FromBitmap(_img);\r\nSKData data = image.Encode(SKEncodedImageFormat.Jpeg, 100);\r\nvar stream = data.AsStream(false);\r\nusing (FileStream rs = new FileStream(savePath, FileMode.Create, FileAccess.Write))\r\n{\r\n\tdata.SaveTo(rs);\r\n}\r\n\u0060\u0060\u0060\u0060",
  "author": {
    "login": "3egirlsdream",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2023-03-19T11:23:21",
  "updatedAt": "2023-05-25T06:00:52",
  "closedAt": "2023-04-25T05:26:53",
  "commentCount": 4,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:46:10.0364672Z",
    "reactions": [],
    "comments": [
      {
        "id": 1503358914,
        "author": "themcoo",
        "body": "Washed away colors are usually related with color profiles. Can you post the original image?",
        "createdAt": "2023-04-11T13:31:29",
        "reactions": []
      },
      {
        "id": 1519000854,
        "author": "3egirlsdream",
        "body": "\u003E Washed away colors are usually related with color profiles. Can you post the original image?\r\n\r\n- this is zip path : http://cdn.thankful.top/images.zip    \r\n- smaller is original image",
        "createdAt": "2023-04-23T08:58:21",
        "reactions": []
      },
      {
        "id": 1520025612,
        "author": "themcoo",
        "body": "So indeed the file you provided contains Adobe RGB color space profile. And apparently using SKBitmap omits the color space embedded in file.\r\nIf you use SKImage to load the file the ColorSpace property is populated and skia color management works. You can either re-save the file using the same color profile or convert to a common sRGB one (or any other depending on requirement):\r\n\r\n\u0060\u0060\u0060\r\n\r\n\tusing var img = SKImage.FromEncodedData(\u0022DSC04207.jpg\u0022);\r\n\r\n// -- conversion to sRGB using intermediate surface\r\n\tusing var surf = SKSurface.Create(new SKImageInfo(img.Width, img.Height, img.ColorType, img.AlphaType, SKColorSpace.CreateSrgb()));\r\n\r\n\tsurf.Canvas.DrawImage(img, 0,0);\r\n\t\r\n\tusing var drawn = surf.Snapshot();\r\n\tusing var encoded = drawn.Encode(SKEncodedImageFormat.Jpeg, 100);\r\n// -- end of conversion\r\n\r\n// encoding the image directly will preserve original color space:\r\n\t//using var encoded = img.Encode(SKEncodedImageFormat.Jpeg, 100);\r\n\r\n\tusing var file = File.Create(\u0022saved_DSC04207.jpg\u0022);\r\n\tencoded.SaveTo(file);\r\n\u0060\u0060\u0060",
        "createdAt": "2023-04-24T12:04:05",
        "reactions": []
      },
      {
        "id": 1521172041,
        "author": "3egirlsdream",
        "body": "thank you",
        "createdAt": "2023-04-25T05:26:53",
        "reactions": []
      }
    ]
  }
}