{
  "number": 3398,
  "type": "issue",
  "state": "open",
  "title": "[BUG] crash when avalonia desktop run.",
  "body": "### Description\n\n\u003Cimg width=\u00221413\u0022 height=\u0022683\u0022 alt=\u0022Image\u0022 src=\u0022https://github.com/user-attachments/assets/cf361924-61d3-4773-9689-b4c36b927b71\u0022 /\u003E\n\n\u003Cimg width=\u00221433\u0022 height=\u0022816\u0022 alt=\u0022Image\u0022 src=\u0022https://github.com/user-attachments/assets/40e7de45-62b9-42bf-9c05-7073203d9258\u0022 /\u003E\n\n always collapse when drawing graphics,\nOccasionally, it does not necessarily appear, but it appears frequently.\n\n### Code\n\nAvalonia\u0027s underlying rendered mapsui, and then the crash appears in this.\n\n### Expected Behavior\n\nThe program does not crash.\n\n### Actual Behavior\n\nThe Avalonia version is 11.3.7.\nThe crash indeed occurred during the process of using MapInfo\u0027s query GetMapInfo().\nIt was retrieving MapInfo in the PointerMoved event.\n\n\n\n### Version of SkiaSharp\n\n3.116.0 (Current)\n\n### Last Known Good Version of SkiaSharp\n\n2.88.9 (Previous)\n\n### IDE / Editor\n\nVisual Studio (Windows)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\nWin 11\n\n### Devices\n\n_No response_\n\n### Relevant Screenshots\n\n_No response_\n\n### Relevant Log Output\n\n\u0060\u0060\u0060shell\n\n\u0060\u0060\u0060\n\n### Code of Conduct\n\n- [x] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "RookieShine",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    },
    {
      "name": "os/Windows-Classic",
      "color": "fbca04"
    },
    {
      "name": "tenet/reliability",
      "color": "BFD4F2"
    }
  ],
  "assignees": [],
  "createdAt": "2025-10-29T10:12:06",
  "updatedAt": "2025-10-30T21:00:41",
  "commentCount": 4,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:23:14.6693237Z",
    "reactions": [],
    "comments": [
      {
        "id": 3460726010,
        "author": "github-actions[bot]",
        "body": "**Triage Summary**  \n\nLabels will be applied indicating reliability concerns related to the crash in the application during its use on Windows 11.\n\nThis issue is not classified as a regression, but it describes unexpected behavior indicating a reliability concern.\n\nAdditional remarks:\n* The issue primarily involves a crash with the Avalonia UI framework and mentions the use of SkiaSharp for rendering, but lacks specific details to apply more specialized backend labels.\n\n\u003Cdetails\u003E\n\u003Csummary\u003EDetailed Summary and Actions\u003C/summary\u003E\n\nSummary of the triage:\n\n- The issue describes a crash occurring during application use, raising reliability concerns.\n- The crash is reported specifically on Windows 11, aligning with the Windows-Classic platform label.\n- The context involves Avalonia, a UI framework, with graphics rendering likely connected to SkiaSharp.\n\nSummary of the actions that will be performed:\n\n| Action         | Item                    | Description                                                                                              |\n| :------------- | :--------------------- | :------------------------------------------------------------------------------------------------------- |\n| Apply Label    | tenet/reliability      | The issue describes a crash which relates directly to reliability concerns during application execution. |\n| Apply Label    | os/Windows-Classic     | The issue specifies that the behavior is occurring on Windows 11, warranting the Windows-Classic label. |\n\n\u003C/details\u003E\n\n_This entire triage process was automated by AI and mistakes may have been made. Please let us know so we can continue to improve._",
        "createdAt": "2025-10-29T10:13:46",
        "reactions": []
      },
      {
        "id": 3460744462,
        "author": "RookieShine",
        "body": "the  SkiaSharp.dll version is  2.88.8.0",
        "createdAt": "2025-10-29T10:17:46",
        "reactions": []
      },
      {
        "id": 3466953514,
        "author": "RookieShine",
        "body": "Application: AeroSpirit.Desktop.exe\nCoreCLR Version: 9.0.725.31616\n.NET Version: 9.0.7\nDescription: The process was terminated due to an unhandled exception.\nStack:\n   at SkiaSharp.SkiaApi.sk_canvas_draw_path(IntPtr, IntPtr, IntPtr)\n   at SkiaSharp.SkiaApi.sk_canvas_draw_path(IntPtr, IntPtr, IntPtr)\n   at SkiaSharp.SKCanvas.DrawPath(SkiaSharp.SKPath, SkiaSharp.SKPaint)\n   at Mapsui.Rendering.Skia.Extensions.SkCanvasExtensions.DrawPath(SkiaSharp.SKCanvas, Mapsui.Rendering.Caching.CacheTracker\u00601\u003CSkiaSharp.SKPath\u003E, Mapsui.Rendering.Caching.CacheTracker\u00601\u003CSkiaSharp.SKPaint\u003E)\n   at Mapsui.Rendering.Skia.LineStringRenderer.Draw(SkiaSharp.SKCanvas, Mapsui.Viewport, Mapsui.Styles.VectorStyle, Mapsui.IFeature, NetTopologySuite.Geometries.LineString, Single, Mapsui.Rendering.RenderService, Int32)\n   at Mapsui.Rendering.Skia.VectorStyleRenderer.\u003CDraw\u003Eg__DrawGeometry|0_0(NetTopologySuite.Geometries.Geometry, Int32, \u003C\u003Ec__DisplayClass0_0 ByRef)\n   at Mapsui.Rendering.Skia.VectorStyleRenderer.Draw(SkiaSharp.SKCanvas, Mapsui.Viewport, Mapsui.Layers.ILayer, Mapsui.IFeature, Mapsui.Styles.IStyle, Mapsui.Rendering.RenderService, Int64)\n   at Mapsui.Rendering.Skia.MapRenderer.RenderFeature(SkiaSharp.SKCanvas, Mapsui.Viewport, Mapsui.Layers.ILayer, Mapsui.Styles.IStyle, Mapsui.IFeature, Mapsui.Rendering.RenderService, Single, Int64)\n   at Mapsui.Rendering.Skia.MapRenderer\u002B\u003C\u003Ec__DisplayClass23_1.\u003CGetMapInfo\u003Eb__2(Mapsui.Viewport, Mapsui.Layers.ILayer, Mapsui.Styles.IStyle, Mapsui.IFeature, Single, Int64)\n   at Mapsui.Rendering.VisibleFeatureIterator.IterateLayer(Mapsui.Viewport, Mapsui.Layers.ILayer, Int64, System.Action\u00606\u003CMapsui.Viewport,Mapsui.Layers.ILayer,Mapsui.Styles.IStyle,Mapsui.IFeature,Single,Int64\u003E)\n   at Mapsui.Rendering.VisibleFeatureIterator.IterateLayers(Mapsui.Viewport, System.Collections.Generic.IEnumerable\u00601\u003CMapsui.Layers.ILayer\u003E, Int64, System.Action\u00606\u003CMapsui.Viewport,Mapsui.Layers.ILayer,Mapsui.Styles.IStyle,Mapsui.IFeature,Single,Int64\u003E, System.Action\u00601\u003CMapsui.Layers.ILayer\u003E)\n   at Mapsui.Rendering.Skia.MapRenderer.GetMapInfo(Mapsui.Manipulations.ScreenPosition, Mapsui.Viewport, System.Collections.Generic.IEnumerable\u00601\u003CMapsui.Layers.ILayer\u003E, Mapsui.Rendering.RenderService, Int32)\n   at Mapsui.Rendering.RenderController.GetMapInfo(Mapsui.Manipulations.ScreenPosition, Mapsui.Viewport, System.Collections.Generic.IEnumerable\u00601\u003CMapsui.Layers.ILayer\u003E, Mapsui.Rendering.RenderService, Int32)\n   at Mapsui.UI.Avalonia.MapControl.GetMapInfo(Mapsui.Manipulations.ScreenPosition, System.Collections.Generic.IEnumerable\u00601\u003CMapsui.Layers.ILayer\u003E)\n   at AeroSpirit.ViewModels.TaskMonitor.FlightControlViewModel.MapControl_PointerMoved(System.Object, Avalonia.Input.PointerEventArgs)\n   at Avalonia.Interactivity.Interactive.\u003CAddHandler\u003Eg__InvokeAdapter|8_0[[System.__Canon, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]](System.Delegate, System.Object, Avalonia.Interactivity.RoutedEventArgs)\n   at Avalonia.Interactivity.Interactive\u002B\u003C\u003Ec__8\u00601[[System.__Canon, System.Private.CoreLib, Version=9.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]].\u003CAddHandler\u003Eb__8_1(System.Delegate, System.Object, Avalonia.Interactivity.RoutedEventArgs)\n   at Avalonia.Interactivity.EventRoute.RaiseEventImpl(Avalonia.Interactivity.RoutedEventArgs)\n   at Avalonia.Interactivity.EventRoute.RaiseEvent(Avalonia.Interactivity.Interactive, Avalonia.Interactivity.RoutedEventArgs)\n   at Avalonia.Interactivity.Interactive.RaiseEvent(Avalonia.Interactivity.RoutedEventArgs)\n   at Avalonia.Input.MouseDevice.MouseMove(Avalonia.Input.IMouseDevice, UInt64, Avalonia.Input.IInputRoot, Avalonia.Point, Avalonia.Input.PointerPointProperties, Avalonia.Input.KeyModifiers, System.Lazy\u00601\u003CSystem.Collections.Generic.IReadOnlyList\u00601\u003CAvalonia.Input.Raw.RawPointerPoint\u003E\u003E, Avalonia.Input.IInputElement)\n   at Avalonia.Input.MouseDevice.ProcessRawEvent(Avalonia.Input.Raw.RawPointerEventArgs)\n   at Avalonia.Input.MouseDevice.ProcessRawEvent(Avalonia.Input.Raw.RawInputEventArgs)\n   at Avalonia.Input.InputManager.ProcessInput(Avalonia.Input.Raw.RawInputEventArgs)\n   at Avalonia.Controls.TopLevel\u002B\u003C\u003Ec.\u003CHandleInput\u003Eb__150_0(System.Object)\n   at Avalonia.Threading.Dispatcher.Send(System.Threading.SendOrPostCallback, System.Object, System.Nullable\u00601\u003CAvalonia.Threading.DispatcherPriority\u003E)\n   at Avalonia.Controls.TopLevel.HandleInput(Avalonia.Input.Raw.RawInputEventArgs)\n   at Avalonia.Win32.WindowImpl.AppWndProc(IntPtr, UInt32, IntPtr, IntPtr)\n   at Avalonia.Win32.WindowImpl.WndProcMessageHandler(IntPtr, UInt32, IntPtr, IntPtr)\n   at FluentAvalonia.Interop.Win32Interop.CallWindowProcW(IntPtr, FluentAvalonia.Interop.Win32.HWND, UInt32, FluentAvalonia.Interop.Win32.WPARAM, FluentAvalonia.Interop.Win32.LPARAM)\n   at FluentAvalonia.Interop.Win32Interop.CallWindowProcW(IntPtr, FluentAvalonia.Interop.Win32.HWND, UInt32, FluentAvalonia.Interop.Win32.WPARAM, FluentAvalonia.Interop.Win32.LPARAM)\n   at FluentAvalonia.UI.Windowing.Win32WindowManager.WndProc(FluentAvalonia.Interop.Win32.HWND, UInt32, FluentAvalonia.Interop.Win32.WPARAM, FluentAvalonia.Interop.Win32.LPARAM)\n   at FluentAvalonia.UI.Windowing.Win32WindowManager.WndProcStatic(IntPtr, UInt32, IntPtr, IntPtr)\n   at Avalonia.Win32.Interop.UnmanagedMethods.DispatchMessage(MSG ByRef)\n   at Avalonia.Win32.Interop.UnmanagedMethods.DispatchMessage(MSG ByRef)\n   at Avalonia.Win32.Win32DispatcherImpl.RunLoop(System.Threading.CancellationToken)\n   at Avalonia.Threading.DispatcherFrame.Run(Avalonia.Threading.IControlledDispatcherImpl)\n   at Avalonia.Threading.Dispatcher.PushFrame(Avalonia.Threading.DispatcherFrame)\n   at Avalonia.Threading.Dispatcher.MainLoop(System.Threading.CancellationToken)\n   at Avalonia.Controls.ApplicationLifetimes.ClassicDesktopStyleApplicationLifetime.StartCore(System.String[])\n   at Avalonia.Controls.ApplicationLifetimes.ClassicDesktopStyleApplicationLifetime.Start(System.String[])\n   at Avalonia.ClassicDesktopStyleApplicationLifetimeExtensions.StartWithClassicDesktopLifetime(Avalonia.AppBuilder, System.String[], System.Action\u00601\u003CAvalonia.Controls.ApplicationLifetimes.IClassicDesktopStyleApplicationLifetime\u003E)\n   at AeroSpirit.Desktop.Program.Main(System.String[])\n",
        "createdAt": "2025-10-30T09:36:18",
        "reactions": []
      },
      {
        "id": 3470214845,
        "author": "molesmoke",
        "body": "Looks more like a Mapsui issue? There\u0027s doesn\u0027t look like there\u0027s anything here that suggests that SkiaSharp is at fault...",
        "createdAt": "2025-10-30T21:00:41",
        "reactions": []
      }
    ]
  }
}