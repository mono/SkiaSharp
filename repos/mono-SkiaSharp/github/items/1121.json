{
  "number": 1121,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] Crashes in sk_canvas_restore_to_count on Mac 10.15",
  "body": "Apps using \u0060SKGLView\u0060 sporadically \u0060abort()\u0060 when SkiaSharp calls \u0060sk_canvas_restore_to_count\u0060 with this typical stack trace:\r\n\r\n\u0060\u0060\u0060\r\nThread 0 Crashed:: tid_307  Dispatch queue: com.apple.main-thread\r\n0   libsystem_kernel.dylib        \t0x00007fff6f20e7fa __pthread_kill \u002B 10\r\n1   libsystem_pthread.dylib       \t0x00007fff6f2cbbc1 pthread_kill \u002B 432\r\n2   libsystem_c.dylib             \t0x00007fff6f195a1c abort \u002B 120\r\n3   com.kruegersystems.circuitmac \t0x0000000108fd3518 altstack_handle_and_restore.cold.1 \u002B 40\r\n4   com.kruegersystems.circuitmac \t0x0000000108ce490c altstack_handle_and_restore \u002B 188\r\n5   libSkiaSharp.dylib            \t0x000000010927d784 0x10924c000 \u002B 202628\r\n6   ???                           \t0x000000011062618e 0 \u002B 4569850254\r\n7   ???                           \t0x000000010f7e8b4e 0 \u002B 4554918734\t  at \u003Cunknown\u003E \u003C0xffffffff\u003E\r\n\r\n\t  at SkiaSharp.SkiaApi:sk_canvas_restore_to_count \u003C0x000ad\u003E\r\n\t  at SkiaSharp.SKCanvas:RestoreToCount \u003C0x0005a\u003E\r\n\t  at SkiaSharp.SKAutoCanvasRestore:Restore \u003C0x00052\u003E\r\n\t  at SkiaSharp.SKAutoCanvasRestore:Dispose \u003C0x00042\u003E\r\n\t  at SkiaSharp.Views.Mac.MySKGLView:DrawRect \u003C0x005d0\u003E\r\n\t  at \u003CModule\u003E:runtime_invoke_void__this___CGRect \u003C0x000fd\u003E\r\n\t  at \u003Cunknown\u003E \u003C0xffffffff\u003E\r\n\t  at AppKit.NSApplication:NSApplicationMain \u003C0x001a4\u003E\r\n\t  at AppKit.NSApplication:Main \u003C0x00112\u003E\r\n\t  at Circuit.Mac.MainClass:Main \u003C0x00052\u003E\r\n\t  at \u003CModule\u003E:runtime_invoke_void_object \u003C0x000b0\u003E\r\n\u0060\u0060\u0060\r\n\r\nAll crashes are here: https://gist.github.com/praeclarum/d5dbcda0782daa0ae81b494969b4d93f\r\n\r\n**Code**\r\n\r\n\u0060\u0060\u0060c#\r\nnew SKGLView();\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nNo crash\r\n\r\n**Actual Behavior**\r\n\r\nCrash after some period of time. It always crashes, but can take awhile.\r\n\r\n**Basic Information**\r\n\r\n- Version with issue: 1.68.2.preview21\r\n- IDE:  Visual Studio for Mac\r\n- Platform Target Frameworks:\r\n  - macOS:  10.15\r\n\r\n",
  "author": {
    "login": "praeclarum",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "milestone": "v1.68.2",
  "createdAt": "2020-01-29T21:19:03",
  "updatedAt": "2022-08-19T06:02:55",
  "closedAt": "2020-03-24T16:09:39",
  "commentCount": 23,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T20:49:24.7033697Z",
    "reactions": [],
    "comments": [
      {
        "id": 580075383,
        "author": "mattleibow",
        "createdAt": "2020-01-30T04:15:52",
        "reactions": []
      },
      {
        "id": 580380046,
        "author": "praeclarum",
        "createdAt": "2020-01-30T18:04:07",
        "reactions": []
      },
      {
        "id": 580523246,
        "author": "praeclarum",
        "createdAt": "2020-01-31T00:18:26",
        "reactions": []
      },
      {
        "id": 585141591,
        "author": "mattleibow",
        "createdAt": "2020-02-12T10:36:15",
        "reactions": []
      },
      {
        "id": 585373326,
        "author": "praeclarum",
        "createdAt": "2020-02-12T19:21:23",
        "reactions": []
      },
      {
        "id": 585402956,
        "author": "praeclarum",
        "createdAt": "2020-02-12T20:29:38",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "hooray",
            "createdAt": "2026-02-04T20:49:21.5080937Z"
          }
        ]
      },
      {
        "id": 585431307,
        "author": "mattleibow",
        "createdAt": "2020-02-12T21:40:18",
        "reactions": []
      },
      {
        "id": 585812263,
        "author": "mattleibow",
        "createdAt": "2020-02-13T15:23:12",
        "reactions": []
      },
      {
        "id": 585831304,
        "author": "praeclarum",
        "createdAt": "2020-02-13T15:59:17",
        "reactions": []
      },
      {
        "id": 585833895,
        "author": "mattleibow",
        "createdAt": "2020-02-13T16:04:36",
        "reactions": []
      },
      {
        "id": 585844787,
        "author": "mattleibow",
        "createdAt": "2020-02-13T16:26:50",
        "reactions": [
          {
            "user": "praeclarum",
            "content": "hooray",
            "createdAt": "2026-02-04T20:49:22.5291629Z"
          }
        ]
      },
      {
        "id": 590362470,
        "author": "praeclarum",
        "createdAt": "2020-02-24T14:57:58",
        "reactions": []
      },
      {
        "id": 594754204,
        "author": "gregsn",
        "createdAt": "2020-03-04T19:00:14",
        "reactions": [
          {
            "user": "praeclarum",
            "content": "laugh",
            "createdAt": "2026-02-04T20:49:22.8739195Z"
          }
        ]
      },
      {
        "id": 599292129,
        "author": "mattleibow",
        "createdAt": "2020-03-16T00:54:06",
        "reactions": []
      },
      {
        "id": 600785738,
        "author": "mattleibow",
        "createdAt": "2020-03-18T18:15:12",
        "reactions": []
      },
      {
        "id": 601365916,
        "author": "mattleibow",
        "createdAt": "2020-03-19T19:13:11",
        "reactions": []
      },
      {
        "id": 601366410,
        "author": "praeclarum",
        "createdAt": "2020-03-19T19:14:17",
        "reactions": []
      },
      {
        "id": 601863724,
        "author": "ugnivs",
        "createdAt": "2020-03-20T19:01:01",
        "reactions": []
      },
      {
        "id": 601936957,
        "author": "mattleibow",
        "createdAt": "2020-03-20T22:27:33",
        "reactions": []
      },
      {
        "id": 602006801,
        "author": "ugnivs",
        "createdAt": "2020-03-21T07:16:53",
        "reactions": []
      },
      {
        "id": 603327653,
        "author": "gregsn",
        "createdAt": "2020-03-24T15:58:34",
        "reactions": []
      },
      {
        "id": 603503693,
        "author": "mattleibow",
        "createdAt": "2020-03-24T21:03:47",
        "reactions": [
          {
            "user": "gregsn",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:49:24.4790294Z"
          }
        ]
      },
      {
        "id": 608434171,
        "author": "mattleibow",
        "createdAt": "2020-04-03T13:29:43",
        "reactions": []
      }
    ]
  }
}