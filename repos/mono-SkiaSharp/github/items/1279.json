{
  "number": 1279,
  "type": "issue",
  "state": "open",
  "title": "Unable to create \u0022Euclid Flex Semibold\u0022 Typeface while running in Docker",
  "body": "**Description**\r\n\r\nWe are Unable to create \u0022Euclid Flex Semibold\u0022 font typeface with skia sharp when running in Docker.\r\n\r\n**Code**\r\n\r\n            SKTypeface typeface = GetTypeface(\u0022Euclid Flex Semibold\u0022, SKTypefaceStyle.Normal);\r\n            FileStream fontStream = new FileStream(Path.Combine(Path.GetDirectoryName(inputTemplate), \u0022semibold.otf\u0022), FileMode.Create, FileAccess.ReadWrite);\r\n            SKStreamAsset stream = typeface.OpenStream();\r\n            if (stream != null \u0026\u0026 stream.Length \u003E 0)\r\n            {\r\n                Console.WriteLine(\u0022stream is not null\u0022);\r\n                byte[] fontData = new byte[stream.Length - 1];\r\n                stream.Read(fontData, stream.Length);\r\n                MemoryStream m_stream = new MemoryStream(fontData);\r\n                CreatePDF(m_stream, inputTemplate);\r\n                Console.WriteLine(m_stream.Length);\r\n                m_stream.WriteTo(fontStream);\r\n                fontStream.Flush();\r\n                SKTypeface sKTypeface = SKTypeface.FromStream(stream);\r\n                Console.WriteLine(sKTypeface.FamilyName);\r\n                stream.Dispose();\r\n                m_stream.Dispose();\r\n            }\r\n\r\n        internal static SKTypeface GetTypeface(string fontName, SKTypefaceStyle style)\r\n        {\r\n            SKFontStyleWeight sKFontStyleWeight = SKFontStyleWeight.Normal;\r\n            SKFontStyleSlant sKFontStyleSlant = SKFontStyleSlant.Upright;\r\n            SKFontStyleWidth sKFontStyleWidth = SKFontStyleWidth.Normal;\r\n            string actualFontName = fontName;\r\n            System.Diagnostics.Debug.WriteLine(fontName);\r\n            if (style == SKTypefaceStyle.Italic || style == SKTypefaceStyle.BoldItalic || fontName.Contains(\u0022Italic\u0022) || fontName.Contains(\u0022It\u0022))\r\n            {\r\n                sKFontStyleSlant = SKFontStyleSlant.Italic;\r\n                if (fontName.Contains(\u0022Italic\u0022))\r\n                    fontName = fontName.Replace(\u0022Italic\u0022, string.Empty).Trim();\r\n                else if (fontName.Contains(\u0022It\u0022))\r\n                    fontName = fontName.Replace(\u0022It\u0022, string.Empty).Trim();\r\n            }\r\n\r\n            if (style == SKTypefaceStyle.Bold || style == SKTypefaceStyle.BoldItalic||fontName.Contains(\u0022Bold\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.Bold;\r\n                if (fontName.Contains(\u0022Bold\u0022))\r\n                    fontName = fontName.Replace(\u0022Bold\u0022, string.Empty).Trim();\r\n            }\r\n\r\n            if (fontName.Contains(\u0022Semibold\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.SemiBold;\r\n                fontName = fontName.Replace(\u0022Semibold\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Extra Bold\u0022) || fontName.Contains(\u0022Ultra Bold\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.ExtraBold;\r\n                if (fontName.Contains(\u0022Extra Bold\u0022))\r\n                    fontName = fontName.Replace(\u0022Extra Bold\u0022, string.Empty).Trim();\r\n                else\r\n                    fontName = fontName.Replace(\u0022Ultra Bold\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Medium\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.Medium;\r\n                fontName = fontName.Replace(\u0022Medium\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022UltraLight\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.ExtraLight;\r\n                fontName = fontName.Replace(\u0022UltraLight\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Regular\u0022))\r\n            {\r\n                fontName = fontName.Replace(\u0022Regular\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022 Light\u0022) || fontName.Contains(\u0022Semilight\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.Light;\r\n                if (fontName.Contains(\u0022 Light\u0022))\r\n                    fontName = fontName.Replace(\u0022Light\u0022, string.Empty).Trim();\r\n                else\r\n                    fontName = fontName.Replace(\u0022Semilight\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Extra Light\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.ExtraLight;\r\n                fontName = fontName.Replace(\u0022Extra Light\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Black\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.Black;\r\n                fontName = fontName.Replace(\u0022Black\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Extra Black\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.ExtraBlack;\r\n                fontName = fontName.Replace(\u0022Extra Black\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Heavy\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.ExtraBold;\r\n                fontName = fontName.Replace(\u0022Heavy\u0022, string.Empty).Trim();\r\n            }\r\n            if (fontName.Contains(\u0022Condensed\u0022) || fontName.Contains(\u0022Cond\u0022) || fontName.Contains(\u0022Cn\u0022))\r\n            {\r\n                sKFontStyleWidth = SKFontStyleWidth.Condensed;\r\n                if (fontName.Contains(\u0022Condensed\u0022))\r\n                    fontName = fontName.Replace(\u0022Condensed\u0022, string.Empty).Trim();\r\n                else if (fontName.Contains(\u0022Cn\u0022))\r\n                    fontName = fontName.Replace(\u0022Cn\u0022, string.Empty).Trim();\r\n                else\r\n                    fontName = fontName.Replace(\u0022Cond\u0022, string.Empty).Trim();\r\n            }\r\n            else if (fontName.Contains(\u0022Thin\u0022))\r\n            {\r\n                sKFontStyleWeight = SKFontStyleWeight.Thin;\r\n                fontName = fontName.Replace(\u0022Thin\u0022, string.Empty).Trim();\r\n            }\r\n            SKTypeface typeface = SKTypeface.FromFamilyName(actualFontName, sKFontStyleWeight, sKFontStyleWidth, sKFontStyleSlant);\r\n            //No need to trim the font name if the valid font was created with full name.\r\n            if (typeface != null \u0026\u0026 typeface.FamilyName == actualFontName)\r\n            {\r\n                Console.WriteLine(actualFontName \u002B \u0022 - \u0022 \u002B typeface.FamilyName \u002B \u0022-\u0022 \u002B sKFontStyleWeight.ToString() \u002B \u0022-\u0022 \u002B sKFontStyleWidth.ToString() \u002B \u0022-\u0022 \u002B sKFontStyleSlant.ToString());\r\n                return typeface;\r\n            }\r\n                \r\n            typeface = SKTypeface.FromFamilyName(fontName, sKFontStyleWeight, sKFontStyleWidth, sKFontStyleSlant);\r\n            // When a font name and typeface family name are mismatch, we check that font name are present in the embedded font name.\r\n            // if font name match with embedded font name and we create typeface from the embedded font stream.\r\n            Console.WriteLine(actualFontName \u002B \u0022 - \u0022 \u002B typeface.FamilyName \u002B \u0022-\u0022 \u002B sKFontStyleWeight.ToString()\u002B\u0022-\u0022\u002B sKFontStyleWidth.ToString()\u002B\u0022-\u0022\u002B sKFontStyleSlant.ToString());\r\n\r\n            return typeface;\r\n        }\r\n\r\n**Expected Behavior**\r\n\r\nThe create font should contain font name \u0022Euclid Flex Semibold\u0022\r\n\r\n**Actual Behavior**\r\nThe create font name is \u0022Euclid Flex Semibolditalic\u0022\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  1.68.1.1\r\n- IDE:  Visual studio 2019\r\n- Platform Target Frameworks: .Net core 3.0\r\n  - Docker: 2.2.0.5\r\n\r\n\r\n**Reproduction Link**\r\n\r\nRun the code sample in docker environment and check the generated font to reproduce the issue.\r\n",
  "author": {
    "login": "Jack-Paul",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2020-05-08T14:44:33",
  "updatedAt": "2021-12-17T07:03:25",
  "commentCount": 9,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T14:23:25.6990902Z",
    "reactions": [],
    "comments": [
      {
        "id": 625859542,
        "author": "Gillibald",
        "body": "Docker is no platform it is a container so please let us know your platform",
        "createdAt": "2020-05-08T15:04:18",
        "reactions": []
      },
      {
        "id": 628641691,
        "author": "Jack-Paul",
        "body": "Windows 10",
        "createdAt": "2020-05-14T13:39:00",
        "reactions": []
      },
      {
        "id": 629003176,
        "author": "mattleibow",
        "body": "What is the base image for your dockerfile? Are you able to share that at all, the dockerfile? ",
        "createdAt": "2020-05-15T03:19:11",
        "reactions": []
      },
      {
        "id": 633824001,
        "author": "Jack-Paul",
        "body": "Hi @mattleibow ,\r\n\r\nPlease find the docker code below which i used.\r\n\r\n\u0060\u0060\u0060\r\nFROM mcr.microsoft.com/dotnet/core/sdk:3.1 AS build\r\n\r\n# Install production dependencies.\r\n# Copy csproj and restore as distinct layers.\r\nWORKDIR /app\r\nCOPY ./ ./\r\n\r\nRUN dotnet restore ./ConsoleApp1/ConsoleApp1.csproj\r\n\r\nWORKDIR /app/ConsoleApp1\r\nRUN dotnet build -c Release --no-restore\r\n\r\nFROM build AS publish\r\nWORKDIR /app/ConsoleApp1\r\nRUN dotnet publish -c Release -o /app/out --no-build\r\n\r\nFROM mcr.microsoft.com/dotnet/core/runtime:3.1 AS runtime\r\nWORKDIR /app\r\nCOPY --from=publish /app/out ./\r\n\r\nRUN apt-get update -y \u0026\u0026 apt-get install -y libfontconfig fontconfig \u0026\u0026 rm -rf /var/lib/apt/lists/*\r\n\r\nCOPY ./fonts/Euclid/ /usr/share/fonts/\r\nCOPY ./fonts/Gotham/ /usr/share/fonts/\r\n\r\nRUN fc-cache -f -v\r\n\r\nENTRYPOINT [\u0022dotnet\u0022, \u0022ConsoleApp1.dll\u0022]\r\n\r\n\u0060\u0060\u0060\r\n\r\nPlease let me know if you need any additional details to reproduce this issue.\r\n\r\nRegards,\r\nJackson Paul T",
        "createdAt": "2020-05-26T06:02:31",
        "reactions": []
      },
      {
        "id": 652207593,
        "author": "ManikandanRavichandranSync",
        "body": "Hi @mattleibow ,\r\n\r\nAny update on this?\r\n\r\n\r\nRegards,\r\nManish R",
        "createdAt": "2020-07-01T05:53:36",
        "reactions": []
      },
      {
        "id": 708062982,
        "author": "mattleibow",
        "body": "@ManishSync or Jack-Paul  I just want to clarify this statement:\r\n\r\n\u003E The create font name is \u0022Euclid Flex Semibolditalic\u0022\r\n\r\nAre you saying that it _does_ find a font, but it is the wrong font? Or is that the font that it ends up trying to find, but can\u0027t?\r\n\r\nAre you able to create a small repro case so I can have a look? I see you are copying fonts from somewhere, so maybe the font is missing?",
        "createdAt": "2020-10-13T23:25:51",
        "reactions": []
      },
      {
        "id": 720645537,
        "author": "ManikandanRavichandranSync",
        "body": "Hi @mattleibow,\r\n\r\nThanks for your update.\r\n\r\nYes, it found the font but it is not exactly what we need. The expected font is \u0022Euclid Flex SemiBold\u0022 but the returned font name from skia is \u0022Euclid Flex Semibolditalic\u0022. We will prepare the sample to reproduce the mentioned issue and share to you ASAP.\r\n\r\nRegards,\r\nManish R",
        "createdAt": "2020-11-02T18:24:46",
        "reactions": []
      },
      {
        "id": 759404915,
        "author": "ManikandanRavichandranSync",
        "body": "Hi @mattleibow,\r\n\r\nPlease find the sample from the below link\r\nhttps://www.syncfusion.com/downloads/support/directtrac/general/ze/DockerSample_Skia765811286\r\n\r\nKindly check this sample and share the details for this issue\r\n\r\nRegards,\r\nManish R",
        "createdAt": "2021-01-13T12:03:41",
        "reactions": []
      },
      {
        "id": 996485051,
        "author": "ManikandanRavichandranSync",
        "body": "Any update on this?",
        "createdAt": "2021-12-17T07:03:25",
        "reactions": []
      }
    ]
  }
}