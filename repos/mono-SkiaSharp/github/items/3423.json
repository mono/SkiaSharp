{
  "number": 3423,
  "type": "issue",
  "state": "open",
  "title": "[BUG] .Net Framework 4.7.2 ClickOnce package -  Unable to load library \u0027libSkiaSharp\u0027",
  "body": "### Description\n\nSkiaSharp Nuget version: 3.119.1\n\nWe\u0027re adding SkiaSharp to our .net winforms app (framework 4.7.2) for the first time, and we have a problem where the ClickOnce version of the app throws the following exception.\n\n\u0060\u0060\u0060\nSystem.TypeInitializationException: The type initializer for \u0027SkiaSharp.SKData\u0027 threw an exception. ---\u003E System.DllNotFoundException: Unable to load library \u0027libSkiaSharp\u0027.\n   at SkiaSharp.LibraryLoader.LoadLocalLibrary[T](String libraryName)\n   at System.Lazy\u00601.CreateValue()\n   at System.Lazy\u00601.LazyInitValue()\n   at SkiaSharp.SkiaApi.sk_data_new_empty()\n   at SkiaSharp.SKData..cctor()\n   --- End of inner exception stack trace ---\n   at SkiaSharp.SKData.Create(IntPtr address, Int32 length)\n   at SkiaSharp.SKBitmap.Decode(ReadOnlySpan\u00601 buffer)\n   at SkiaSharp.SKBitmap.Decode(Byte[] buffer)\n\u0060\u0060\u0060\n\nOur MSIX version of the app does not however, and I think its because \u0060libSkiaSharp.dylib\u0060 is not being included in the ClickOnce publish, even though I have it configured to (the Application Files dialog says its not referenced).  That file IS included in the MSIX package however.\n\n### Code\n\n\u0060\u0060\u0060\nvar image = SKBitmap.Decode(imageData ?? throw new ArgumentNullException(nameof(imageData)))\n\u0060\u0060\u0060\n\nIn a WinForms app, then published with ClickOnce.\n\n### Expected Behavior\n\nI expect the image to be decoded.\n\n### Actual Behavior\n\nAn exception:  System.DllNotFoundException: Unable to load library \u0027libSkiaSharp\u0027\n\n### Version of SkiaSharp\n\n3.116.0 (Current)\n\n### Last Known Good Version of SkiaSharp\n\nOther (Please indicate in the description)\n\n### IDE / Editor\n\nVisual Studio (Windows)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\n- Windows 11\n- Windows 10\n\n### Devices\n\n- Dell workstations\n\n### Relevant Screenshots\n\n_No response_\n\n### Relevant Log Output\n\n\u0060\u0060\u0060shell\n\n\u0060\u0060\u0060\n\n### Code of Conduct\n\n- [x] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "ajohnstone-ks",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    },
    {
      "name": "os/Windows-Classic",
      "color": "fbca04"
    },
    {
      "name": "area/libSkiaSharp.native",
      "color": "0052cc"
    },
    {
      "name": "tenet/reliability",
      "color": "BFD4F2"
    }
  ],
  "assignees": [],
  "createdAt": "2025-11-25T19:47:59",
  "updatedAt": "2026-02-09T12:06:57",
  "commentCount": 3,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:19:47.6858653Z",
    "reactions": [],
    "comments": [
      {
        "id": 3577321160,
        "author": "github-actions[bot]",
        "body": "**Triage Summary**  \n\nLabels will be applied for the affected library (libSkiaSharp), the operating system (Windows Classic), and the issue\u0027s nature (reliability). \n\nThis issue does not appear to be a regression, but it does involve a critical reliability problem due to a crash.\n\nAdditional remarks:\n* No suitable labels were found for an issue specifically involving SkiaSharp in a .NET WinForms context, as it does not fit into any standard backend categories like OpenGL or Metal.\n\n\u003Cdetails\u003E\n\u003Csummary\u003EDetailed Summary and Actions\u003C/summary\u003E\n\nSummary of the triage:\n\n- The issue pertains specifically to a library loading problem with \u0027libSkiaSharp\u0027, categorized under native libraries for SkiaSharp.\n- It affects applications built with .NET WinForms running on Windows using Win32 APIs, particularly in the context of ClickOnce deployment.\n- The issue is related to reliability, as it experiences a crash due to the inability to load the required library.\n\nSummary of the actions that will be performed:\n\n| Action         | Item                              | Description                                                                                      |\n| :------------- | :-------------------------------- | :----------------------------------------------------------------------------------------------- |\n| Apply Label    | area/libSkiaSharp.native         | The issue relates to a specific library loading problem with \u0027libSkiaSharp\u0027, a native library. |\n| Apply Label    | os/Windows-Classic               | The issue relates to a WinForms application running on Windows using Win32 APIs.               |\n| Apply Label    | tenet/reliability                | The issue describes a crash related to the inability to load a required library.                |\n\n\u003C/details\u003E\n\n_This entire triage process was automated by AI and mistakes may have been made. Please let us know so we can continue to improve._",
        "createdAt": "2025-11-25T19:48:38",
        "reactions": []
      },
      {
        "id": 3859787091,
        "author": "ERPCG",
        "body": "Hello,\n\nI had the same problem with VS22 and .NET Framework 4.8 and couldn\u0027t find a solution on the net on how to solve it.\nBut after trying several things, I found a way to solve the problem.\n\nI use SkiaSharp 3.119.1, and have the following packages :\n- HarfBuzz\n- NativeAssets.Linux.NoDependencies\n- NativeAssets.macOS\n- NativeAssets.Win32\n- Views.Desktop.Common\n- Views.WindowsForms\n\nFirst, you need to find the libSkiaSharp.dll file in the following path :\n\u0022{$YOUR_PROJECT_PATH}\\packages\\SkiaSharp.NativeAssets.Win32.3.119.1\\runtimes\\\u0022\nIf you try to publish your project in x64, then chose the one in \u0022\\win-x64\\native\u0022, if it\u0027s either x86 or Any CPU (Prefered x32), then it\u0027s the one in \u0022\\win-x86\\native\u0022.\n\nSecond, in Visual Studio, right click on your project, then \u0022Add -\u003E Existing element\u0022, and go find the dll in the folder according to your project.\n\nThird, right click on the added dll file, \u0022Properties\u0022, select \u0022Build Action = Content\u0022 and \u0022Copy to Output Directory = Copy if newer\u0022.\n\nFourth, go check if the dll is correctly included in your project, \u0022Projet -\u003E Properties -\u003E Publish -\u003E Application Files\u0022, libSkiaSharp.dll should be on the list, with the following options \u0022Action = Include\u0022 and \u0022Download Group = Required\u0022.\n\nNow you can try and publish your solution using ClickOnce.\n\nI haven\u0027t found a way to have the dll file elsewhere or include the native path to the project, but for now it\u0027s working for me.",
        "createdAt": "2026-02-06T11:09:38",
        "reactions": []
      }
    ]
  }
}