{
  "number": 2157,
  "type": "pr",
  "state": "closed",
  "title": "add SKNativeObject allocation logging",
  "body": "**Description of Change**\r\n\r\ncan be toggled on/off via \u0060SKNativeObject.LOG_ALLOCATIONS\u0060 (default is false)\r\n\r\n\u003C!-- Describe your changes here. --\u003E\r\n\r\n**Bugs Fixed**\r\n\r\nNone.\r\n\r\n\u003C!-- Provide links to issues here. Ensure that a GitHub issue was created for your feature or bug fix before sending PR. --\u003E\r\n\r\n**API Changes**\r\n\r\nNone.\r\n\r\n\u003C!-- REPLACE THIS COMMENT\r\n\r\nList all API changes here (or just put None), example:\r\n\r\nAdded: \r\n \r\n- \u0060string Class.Property { get; set; }\u0060\r\n- \u0060void Class.Method();\u0060\r\n\r\nChanged:\r\n\r\n - \u0060object Cell.OldPropertyName =\u003E object Cell.NewPropertyName\u0060\r\n\r\n--\u003E\r\n\r\n**Behavioral Changes**\r\n\r\nNone.\r\n\r\n\u003C!-- Describe any non-bug related behavioral changes that may change how users app behaves when upgrading to this version of the codebase. --\u003E\r\n\r\n**Required skia PR**\r\n\r\nhttps://github.com/mono/SkiaSharp/pull/2157\r\n\r\n**PR Checklist**\r\n\r\n- [ ] Has tests (if omitted, state reason in description)\r\n- [ ] Rebased on top of main at time of PR\r\n- [ ] Merged related skia PRs\r\n- [ ] Changes adhere to coding standard\r\n- [ ] Updated documentation\r\n",
  "author": {
    "login": "mgood7123",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-07-07T14:06:02",
  "updatedAt": "2024-03-05T15:47:14",
  "closedAt": "2024-03-02T13:56:02",
  "commentCount": 2,
  "reactionCount": 0,
  "draft": false,
  "mergeable": false,
  "merged": false,
  "mergeableState": "dirty",
  "baseBranch": "main",
  "headBranch": "skobject",
  "additions": 74,
  "deletions": 4,
  "changedFiles": 1,
  "commits": 5,
  "reviews": [
    {
      "author": "mattleibow",
      "state": "CHANGES_REQUESTED",
      "submittedAt": "2022-08-15T23:01:28"
    }
  ],
  "engagement": {
    "syncedAt": "2026-02-06T12:56:26.4830747Z",
    "reactions": [],
    "comments": [
      {
        "id": 1217394115,
        "author": "mgood7123",
        "body": "\u003E Thanks for this PR. We should add some logging, but this must be a Debug-only feature, internal and opt-in by setting some property.\r\n\u003E \r\n\u003E If you have a look at the way I set up \u0060THROW_OBJECT_EXCEPTIONS\u0060. It is a define that was added in debug builds:\r\n\u003E \r\n\u003E     * https://github.com/mono/SkiaSharp/blob/cb424e5230471ed300319e97cc7cb4fd9f771e03/source/SkiaSharp.Build.props#L88\r\n\u003E \r\n\u003E     * https://github.com/mono/SkiaSharp/blob/e603133c3548bbd3835cf1012eac80ce5640f209/binding/Binding/HandleDictionary.cs#L16\r\n\u003E \r\n\u003E \r\n\u003E The reason for internal is to avoid any accidental APIS leaking, and then when it is in the conditions, we can do checks with and without the logging - maybe for perf or to determine things are working correctly for tests.\r\n\r\nhmmmm i still like that it is toggle-able and public, as it may help end users track down allocations that they forget to dispose (which will add memory pressure until GC occurs)\r\n\r\nmaking it togglable via building skiasharp itself (and via debug build) would likely be combersome since the end user will likely be debug building their app and not expect to build a debug build of skiasharp just to enable allocation logging\r\n\r\nmaybe we could offer both a debug nuget and a release nuget so that the end user does not need to manually build skiasharp as debug?\r\n\r\nthis way, we still keep the API\u0027s but only expose them in the debug build of skiasharp (assumable via \u0060#if DEBUG\u0060)",
        "createdAt": "2022-08-17T02:45:30",
        "reactions": []
      },
      {
        "id": 1974802938,
        "author": "mattleibow",
        "body": "Closing this one as I am not sure this is the best way. Some more design/discussion/research needs to be done to make use of the tracing features in the .NET SDK: https://github.com/mono/SkiaSharp/issues/2777",
        "createdAt": "2024-03-02T13:56:02",
        "reactions": [
          {
            "user": "mgood7123",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:56:26.43282Z"
          }
        ]
      }
    ]
  }
}