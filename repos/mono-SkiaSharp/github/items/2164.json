{
  "number": 2164,
  "type": "issue",
  "state": "open",
  "title": "[BUG] Unexpected behavior of Encode with quality parameter",
  "body": "**Description**\r\n\r\n\u0060SKPixmap\u0060 and [SKBitmap.Encode](https://docs.microsoft.com/en-us/dotnet/api/skiasharp.skbitmap.encode?view=skiasharp-2.88#skiasharp-skbitmap-encode(skiasharp-skencodedimageformat-system-int32)) take second parameter as a \u0060quality\u0060, but inverses the value, e.g. 1 is a best quality and 100 is the worst. \r\n\r\nDevelopers can easily check the quality by number of bytes produced by this method. \r\n\r\n**Code - WPF**\r\n\r\n\u0060\u0060\u0060XML\r\n\u003CWindow x:Class=\u0022QualitySample.MainWindow\u0022\r\n        xmlns=\u0022http://schemas.microsoft.com/winfx/2006/xaml/presentation\u0022\r\n        xmlns:x=\u0022http://schemas.microsoft.com/winfx/2006/xaml\u0022\r\n        xmlns:d=\u0022http://schemas.microsoft.com/expression/blend/2008\u0022\r\n        xmlns:mc=\u0022http://schemas.openxmlformats.org/markup-compatibility/2006\u0022\r\n        xmlns:local=\u0022clr-namespace:QualitySample\u0022\r\n        xmlns:skia=\u0022clr-namespace:SkiaSharp.Views.WPF;assembly=SkiaSharp.Views.WPF\u0022\r\n        mc:Ignorable=\u0022d\u0022\r\n        Title=\u0022MainWindow\u0022 Height=\u0022450\u0022 Width=\u0022800\u0022\u003E\r\n    \u003CGrid\u003E\r\n    \u003Cskia:SKElement\r\n      Name=\u0022Demo\u0022\r\n      PaintSurface=\u0022OnPaint\u0022/\u003E\r\n  \u003C/Grid\u003E\r\n\u003C/Window\u003E\r\n\u0060\u0060\u0060\r\n\r\n\u0060\u0060\u0060C#\r\nusing SkiaSharp;\r\nusing SkiaSharp.Views.WPF;\r\nusing System.Collections.Generic;\r\nusing System.IO;\r\nusing System.Windows;\r\n\r\nnamespace QualitySample\r\n{\r\n  public partial class MainWindow : Window\r\n  {\r\n    public MainWindow()\r\n    {\r\n      InitializeComponent();\r\n    }\r\n\r\n    private void OnPaint(object sender, SkiaSharp.Views.Desktop.SKPaintSurfaceEventArgs e)\r\n    {\r\n      var element = sender as SKElement;\r\n      var canvas = e.Surface.Canvas;\r\n\r\n      canvas.Clear(SKColors.Transparent);\r\n\r\n      var curve = new SKPath();\r\n      var pen = new SKPaint\r\n      {\r\n        Color = SKColors.Black,\r\n        Style = SKPaintStyle.Fill,\r\n        FilterQuality = SKFilterQuality.High,\r\n        IsAntialias = false,\r\n        IsStroke = false,\r\n        IsDither = false\r\n      };\r\n\r\n      var points = new List\u003CSKPoint\u003E\r\n      {\r\n        new SKPoint(-1, -1),\r\n        new SKPoint((float)element.ActualWidth \u002B 1, -1),\r\n        new SKPoint((float)element.ActualWidth \u002B 1, (float)element.ActualHeight \u002B 1),\r\n        new SKPoint(-1, (float)element.ActualHeight \u002B 1),\r\n        new SKPoint(-1, -1)\r\n      };\r\n\r\n      curve.MoveTo(points[0].X, points[0].Y);\r\n\r\n      for (var i = 1; i \u003C points.Count; i\u002B\u002B)\r\n      {\r\n        curve.LineTo(points[i].X, points[i].Y);\r\n      }\r\n\r\n      canvas.DrawPath(curve, pen);\r\n\r\n      var pixmap = e.Surface.PeekPixels();\r\n\r\n      using (var image = pixmap.Encode(SKEncodedImageFormat.Webp, 1))  // Change 1 to 100 and check bytes variable\r\n      {\r\n        var bytes = image.AsSpan().ToArray();\r\n        File.WriteAllBytes(System.IO.Path.GetTempPath() \u002B \u0022/demo.webp\u0022, bytes);\r\n      }\r\n\r\n      pen.Dispose();\r\n      curve.Dispose();\r\n    }\r\n  }\r\n}\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nQuality of 100 should produce better picture than quality of 1. \r\n\r\n**Actual Behavior**\r\n\r\nBehavior is inverted.\r\nNumbers below are arbitrary and depend on the size of canvas, but should give an understanding of the difference. \r\nEncoding with \u0060quality\u0060 set to 100 returns around 50 bytes. \r\nEncoding with \u0060quality\u0060 set to 1 returns around 640 bytes. \r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  2.88.1-preview.79\r\n- Last known good version:  N/A\r\n- IDE:  VS 2022 Preview 3\r\n- Platform Target Frameworks: \r\n  - Windows Classic:  WPF for Windows Pro x64\r\n- Target Devices:  Windows Desktop\r\n  \r\n**Screenshots**\r\n\r\n![image](https://user-images.githubusercontent.com/5140879/178651507-9b6f89a4-d434-4a49-9d5e-42afc98a2e75.png)\r\n\r\n**Reproduction Link**\r\n\r\nEntire code was posted above. \r\n",
  "author": {
    "login": "artemiusgreat",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-07-13T04:35:46",
  "updatedAt": "2022-07-13T04:38:17",
  "commentCount": 0,
  "reactionCount": 0
}