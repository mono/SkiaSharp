{
  "number": 2000,
  "type": "issue",
  "state": "closed",
  "title": "[QUESTION] How to use SKCanvas.Scale(float sx, float sy, float px, float py) to mimic a translation followed by a scaling (or the reverse)?",
  "body": "## Method 1 (OK)\r\n\r\n    // Method 1: Scale and then translate\r\n    canvas.Scale(scale, -scale);\r\n    canvas.Translate(-domain.Left, -domain.Top);\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n## Method 2 (OK)\r\n\r\n    // Method 2: Translate and then scale\r\n    canvas.Translate(-domain.Left * scale, domain.Top * scale);\r\n    canvas.Scale(scale, -scale);\r\n\r\n[![enter image description here][2]][2]\r\n\r\n## Method 3 (Fail)\r\n\r\n\r\n    // Method 3: Scale relative to a certain point\r\n    // Right now this approach still does not work.\r\n    canvas.Scale(scale, -scale, domain.Left, domain.Top);\r\n\r\n[![enter image description here][3]][3]\r\n\r\nAs you can see, the top right corner of the red rectangle is not exactly aligned with the top right corner of the canvas.\r\n\r\n## Question\r\nHow to fix the third method such that it produces an identical result as what the other methods produce?\r\n\r\n\r\n## Minimal Example\r\n\r\n    using SkiaSharp; // needs skiasharp nuget\r\n    \r\n    class Program\r\n    {\r\n        const float scale = SKDocument.DefaultRasterDpi / 2.54f; // dots per cm\r\n    \r\n        static float PtToCm(float pt) =\u003E pt / scale;\r\n    \r\n        public static void Draw(string filename, int selector)\r\n        {\r\n    \r\n            SKRect domain = new SKRect(-2, 2, 4, -4);\r\n    \r\n            float width = domain.Width * scale;\r\n            float height = -domain.Height * scale;\r\n            // SkiaSharp uses a convention where positive y axis goes down.\r\n            // As a result, domain.Height is -6. \r\n            // It is internally calculated as domain.Bottom - domain.Top.\r\n    \r\n    \r\n            using (var stream = new SKFileWStream($\u0022{filename}.pdf\u0022))\r\n            using (var document = SKDocument.CreatePdf(stream))\r\n            using (var canvas = document.BeginPage(width, height))\r\n            {\r\n    \r\n                switch (selector)\r\n                {\r\n                    // Method 1: Scale and then translate\r\n                    case 1:\r\n                        canvas.Scale(scale, -scale);\r\n                        canvas.Translate(-domain.Left, -domain.Top);\r\n                        break;\r\n    \r\n                    // Method 2: Translate and then scale\r\n                    case 2:\r\n                        canvas.Translate(-domain.Left * scale, domain.Top * scale);\r\n                        canvas.Scale(scale, -scale);\r\n                        break;\r\n    \r\n                    // Method 3: Scale relative to a certain point\r\n                    // Right now this approach still does not work.\r\n                    case 3:\r\n                        canvas.Scale(scale, -scale, domain.Left, domain.Top);\r\n                        break;\r\n                }\r\n     \r\n    \r\n                var red = new SKPaint { Style = SKPaintStyle.Stroke, StrokeWidth = PtToCm(0.8f), Color=SKColors.Red };\r\n                var blue = new SKPaint { Style = SKPaintStyle.Stroke, StrokeWidth = PtToCm(0.8f), Color=SKColors.Blue };\r\n                \r\n                canvas.DrawRect(domain, red);\r\n                canvas.DrawLine(new SKPoint(domain.Left, 0), new SKPoint(domain.Right, 0), blue);\r\n                canvas.DrawLine(new SKPoint(0, domain.Bottom), new SKPoint(0, domain.Top), blue);\r\n                document.EndPage();\r\n            }\r\n        }\r\n        static void Main()\r\n        {\r\n            Draw(\u0022Method1\u0022, 1);\r\n            Draw(\u0022Method2\u0022, 2);\r\n            Draw(\u0022Method3\u0022, 3);\r\n        }\r\n    }\r\n\r\n  [1]: https://i.stack.imgur.com/CJgTt.png\r\n  [2]: https://i.stack.imgur.com/ZWsiU.png\r\n  [3]: https://i.stack.imgur.com/L9m9P.png",
  "author": {
    "login": "mauler2025",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-04-14T13:45:52",
  "updatedAt": "2022-08-19T00:01:43",
  "closedAt": "2022-05-12T01:55:06",
  "commentCount": 0,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T20:56:35.5482237Z",
    "reactions": [],
    "comments": []
  }
}