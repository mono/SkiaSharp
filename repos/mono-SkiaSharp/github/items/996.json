{
  "number": 996,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] Memory leak when create SKTypeface from file name or stream.",
  "body": "**Description**\r\n\r\nIf create SKTypeface from file name or from stream, memory is not released. In the code example, there are commented lines, uncomment them to test creating typeface from family name (no problems with this one), from file name and memory stream. Attached screenshots shows that in the last two cases memory usage raise constantly.  \r\n\r\n**Code**\r\n\r\n            for (int i = 0; i \u003C 1000; i\u002B\u002B)\r\n            {\r\n                using (SkiaSharp.SKBitmap bmp = new SkiaSharp.SKBitmap(100, 100))\r\n                using (SkiaSharp.SKCanvas canvas = new SkiaSharp.SKCanvas(bmp))\r\n                using (SkiaSharp.SKPaint paint = new SkiaSharp.SKPaint())\r\n                //using (SkiaSharp.SKTypeface typeface = SkiaSharp.SKTypeface.FromFamilyName(\u0022Calibri\u0022)) // If create Typeface from family there is no memory leak.\r\n                using (SkiaSharp.SKTypeface typeface = SkiaSharp.SKTypeface.FromFile(\u0022C:\\\\WINDOWS\\\\Fonts\\\\calibri.ttf\u0022)) // If create Typeface from file name\r\n                //using (MemoryStream ms = new MemoryStream(File.ReadAllBytes(\u0022C:\\\\WINDOWS\\\\Fonts\\\\calibri.ttf\u0022))) // Or stream, there is memory leak.\r\n                //using (SkiaSharp.SKTypeface typeface = SkiaSharp.SKTypeface.FromStream(ms))\r\n                {\r\n                    paint.Typeface = typeface;\r\n                    paint.TextSize = 12;\r\n\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 10), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 20), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 30), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 40), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 50), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 60), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 70), paint);\r\n                    canvas.DrawText(\u0022Cool Text\u0022, new SkiaSharp.SKPoint(10, 80), paint);\r\n\r\n                    using (SkiaSharp.SKFileWStream fs = new SkiaSharp.SKFileWStream(@\u0022C:\\Temp\\out.png\u0022))\r\n                    {\r\n                        SkiaSharp.SKPixmap.Encode(fs, bmp, SkiaSharp.SKEncodedImageFormat.Png, 100);\r\n                    }\r\n                }\r\n\r\n                GC.Collect();\r\n            }\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  Tested and reproduced on the latest stable 1.68 and latest RC 1.68.1-rc.153\r\n- IDE:   Visual Studio\r\n- Platform Target Frameworks: .NET Core 2.2\r\n\r\n**Screenshots**\r\nMemory usage when create SKTypeface from family name\r\n![family](https://user-images.githubusercontent.com/31235892/68189074-4bf3ab80-ffb3-11e9-8805-a9b5628dda25.png)\r\nMemory usage when create SkTypeface from file name\r\n![filename](https://user-images.githubusercontent.com/31235892/68189088-50b85f80-ffb3-11e9-8fe5-f4f1563bfd25.png)\r\nMemory usage when create SkTypeface from memory stream\r\n![memorystream](https://user-images.githubusercontent.com/31235892/68189091-53b35000-ffb3-11e9-8630-07ecf641aa4a.png)\r\n\r\n",
  "author": {
    "login": "AlexNosk",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2019-11-05T08:04:49",
  "updatedAt": "2022-08-19T09:02:10",
  "closedAt": "2019-12-22T04:52:59",
  "commentCount": 3,
  "reactionCount": 0
}