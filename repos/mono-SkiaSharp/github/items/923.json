{
  "number": 923,
  "type": "issue",
  "state": "open",
  "title": "[BUG] Resize method rotating image during resize for one particular image",
  "body": "**Description**\r\nI am resizing image with SKBitmap.Resize method for one particular image , its resizing and rotating to 180 degree as well.\r\n\r\nresizing to ( height , width)\r\n200 x 200 \r\n50 x 50 \r\n1000 x 1000 \r\n\r\n**Code**\r\n\r\n\u0060\u0060\u0060csharp\r\npublic Stream GetResizedImage(Stream image, ImageMaxSize size, string imageFormat)\r\n{\r\n\timage.Position = 0L;\r\n\r\n\tusing (var inputStream = new SKManagedStream(image))\r\n\tusing (var original = SKBitmap.Decode(inputStream))\r\n\t{\r\n\t\tif (original.ColorType == SKColorType.Gray8 || original.ColorType == SKColorType.Unknown)\r\n\t\t{\r\n\t\t\toriginal.CopyTo(original, SKImageInfo.PlatformColorType);\r\n\t\t}\r\n                \r\n               \r\n\t\tvar (width, height) = ResizeKeepAspect(original.Width, original.Height, size.MaxWidth, size.MaxHeight);\r\n\t\tusing (var resized = original.Resize(new SKImageInfo(width, height, original.ColorType, original.AlphaType,original.ColorSpace),SKFilterQuality.High))\r\n\t\t{\r\n\t\t\tif (resized == null)\r\n\t\t\t{\r\n\t\t\t\t_logger.LogWarning(\u0022Failed resizing image to width {0} and height {1}; color type: {2}\u0022, width, height, original.ColorType);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tusing (var newImage = SKImage.FromBitmap(resized))\r\n\t\t\t{\r\n\t\t\t\treturn newImage.Encode(GetImageFormat(imageFormat), 85).AsStream();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nImage should be resized only \r\n\r\n**Actual Behavior**\r\n\r\nImages resized \u0026 rotated to 180 degree as well\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  1.68.0\r\n- Last known good version:  \u003C!-- the version of SkiaSharp that still working --\u003E\r\n- IDE:  Visual studio 2017\r\n- Platform Target Frameworks: .net core \r\n  - Android: \u003C!-- the version of the Android SDK you are compiling against, e.g. 7.1 --\u003E \r\n  - iOS:  \u003C!-- the version of the iOS SDK you are compiling against, e.g. 11.1 --\u003E\r\n  - Linux:  \u003C!-- The version and distro of linux that you are building for, e.g. Ubuntu 16.04 --\u003E\r\n  - macOS:  \u003C!-- The version of macOS you are building for, e.g. 10.10 --\u003E\r\n  - Tizen:  \u003C!-- the version of the Tizen SDK you are compiling against, e.g. 4.0 --\u003E \r\n  - tvOS:  \u003C!-- the version of the tvOS SDK you are compiling against, e.g. 11.1 --\u003E\r\n  - UWP:  \u003C!-- the version of the UWP SDK you are compiling against, e.g. 16299 --\u003E \r\n  - watchOS:  \u003C!-- the version of the watchOS SDK you are compiling against, e.g. 11.1 --\u003E\r\n  - Windows Classic:  \u003C!-- the version of Windows you are building for, e.g. Windows 7 --\u003E\r\n- Target Devices:   \u003C!-- the devices that you noticed this on, e.g. iPhone X --\u003E\r\n  - \r\n  - \r\n\r\n**Screenshots**\r\n\r\n\u003C!-- if the issue is a visual issu\r\n![issueImage](https://user-images.githubusercontent.com/53568424/62296046-6af81400-b47f-11e9-948b-b649a2f28071.jpg)\r\ne, please include screenshots showing the problem if possible --\u003E\r\n\r\n**Reproduction Link**\r\n\r\n\u003C!-- please upload or provide a link to a reproduction case --\u003E\r\n",
  "author": {
    "login": "abubkdar",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2019-08-01T13:13:30",
  "updatedAt": "2023-02-26T13:08:23",
  "commentCount": 3,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:46:53.861541Z",
    "reactions": [],
    "comments": [
      {
        "id": 517289355,
        "author": "abubkdar",
        "body": "Further If I save as same image as .PNG , Now I can resize this PNG without issue",
        "createdAt": "2019-08-01T13:31:51",
        "reactions": []
      },
      {
        "id": 1008256766,
        "author": "handcraftedsource",
        "body": "I can reproduce this with all images with portrait orientation. Images with Landscape orientation remain correctly aligned.\r\n\r\nMy code looks like this:\r\n\r\n\u0060\u0060\u0060c#\r\npublic static async Task\u003Cstring?\u003E GetResizedPngImageAsBase64String(this System.IO.Stream inputStream, long streamSize, int maxHeight, int maxWidth)\r\n{\r\n    var inputBuffer = new byte[streamSize];\r\n    await inputStream.ReadAsync(inputBuffer);\r\n    using var original = SKBitmap.Decode(inputBuffer);\r\n\r\n    var scaleHeight = maxHeight / (float) original.Height;\r\n    var scaleWidth = maxWidth / (float) original.Width;\r\n    var scale = Math.Min(scaleHeight, scaleWidth);\r\n\r\n    var width = (int)(original.Width * scale);\r\n    var height = (int)(original.Height * scale);\r\n    \r\n    using var resized = original.Resize(new SKImageInfo(width, height), SKFilterQuality.High);\r\n    if (resized == null)\r\n    {\r\n        return null;\r\n    }\r\n\r\n    using var image = SKImage.FromBitmap(resized);\r\n    var buffer = image.Encode(SKEncodedImageFormat.Png, 100).ToArray();\r\n    var result = Convert.ToBase64String(buffer);\r\n    return result;\r\n}\r\n\r\n\u0060\u0060\u0060\r\n\r\nUsed Package Version: 2.80.3\r\nFramework: net6.0",
        "createdAt": "2022-01-09T08:57:05",
        "reactions": []
      },
      {
        "id": 1445357905,
        "author": "wolfgangschneider",
        "body": "HI\r\nI run into the same issue. Is this Bug still open ? Is there a workaround?",
        "createdAt": "2023-02-26T13:08:23",
        "reactions": []
      }
    ]
  }
}