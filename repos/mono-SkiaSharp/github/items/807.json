{
  "number": 807,
  "type": "pr",
  "state": "closed",
  "title": "Add Reset method to SKPaint and add constructor to SKMatrix",
  "body": "It\u0027s quite a bit faster to reuse \u0060SKPaint\u0060 objects (due to the all pinvoke, extra bookkeeping for the references, etc.). But without having an reset method (https://skia.org/user/api/SkPaint_Reference#SkPaint_reset) it is hard to actually reuse objects, as it will be quite slow to reset properties one by one.\r\n\r\nNative changes in: https://github.com/mono/skia/pull/59\r\n\r\nAdditionally I added a constructor to \u0060SKMatrix\u0060 as it leads to better codegen, especially when inlining (like Avalonia conversion methods).\r\n\r\nBenchmark code: https://gist.github.com/MarchingCube/3bcfbc8894a93b92cb2997b650a05508\r\nBenchmark results for \u0060SKPaint\u0060 reuse:\r\n\r\n\u0060\u0060\u0060 ini\r\n\r\nBenchmarkDotNet=v0.11.4, OS=Windows 10.0.17763.316 (1809/October2018Update/Redstone5)\r\nAMD Ryzen 7 2700X, 1 CPU, 16 logical and 8 physical cores\r\n.NET Core SDK=3.0.100-preview-009812\r\n  [Host]     : .NET Core 2.0.9 (CoreCLR 4.6.26614.01, CoreFX 4.6.26614.01), 64bit RyuJIT\r\n  DefaultJob : .NET Core 2.0.9 (CoreCLR 4.6.26614.01, CoreFX 4.6.26614.01), 64bit RyuJIT\r\n\r\n\u0060\u0060\u0060\r\n|        Method |     Mean |      Error |     StdDev | Ratio |\r\n|-------------- |---------:|-----------:|-----------:|------:|\r\n| AllocatePaint | 697.9 us | 15.9502 us | 13.3191 us |  1.00 |\r\n|    ResetPaint | 211.7 us |  0.5672 us |  0.5028 us |  0.30 |\r\n\r\nResults for \u0060SKMatrix\u0060 change:\r\n\r\n|                       Method |      Mean |     Error |    StdDev | Ratio |\r\n|----------------------------- |----------:|----------:|----------:|------:|\r\n|            MatrixConstructor |  7.926 ns | 0.0267 ns | 0.0250 ns |  0.79 |\r\n| MatrixPropertyInitialization | 10.050 ns | 0.1238 ns | 0.1158 ns |  1.00 |\n\n\u003E VS bug [#817073](https://devdiv.visualstudio.com/DevDiv/_workitems/edit/817073)",
  "author": {
    "login": "MarchingCube",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/enhancement",
      "color": "84b6eb"
    },
    {
      "name": "area/SkiaSharp",
      "color": "0052cc"
    },
    {
      "name": "area/libSkiaSharp.native",
      "color": "0052cc"
    }
  ],
  "assignees": [
    {
      "login": "mattleibow",
      "type": "User"
    }
  ],
  "milestone": "v1.68.1",
  "createdAt": "2019-03-09T20:09:21",
  "updatedAt": "2019-11-21T20:35:53",
  "closedAt": "2019-03-13T02:57:31",
  "commentCount": 9,
  "reactionCount": 2,
  "draft": false,
  "mergeable": false,
  "merged": true,
  "mergedAt": "2019-03-13T02:57:31",
  "mergeableState": "dirty",
  "baseBranch": "master",
  "headBranch": "skpaint-and-skmatrix",
  "additions": 24,
  "deletions": 1,
  "changedFiles": 4,
  "commits": 2,
  "reviews": [
    {
      "author": "mattleibow",
      "state": "APPROVED",
      "submittedAt": "2019-03-10T14:09:17"
    }
  ],
  "engagement": {
    "syncedAt": "2026-02-06T14:32:15.6102905Z",
    "reactions": [
      {
        "user": "daltonks",
        "content": "\u002B1",
        "createdAt": "2026-02-06T14:32:15.6102975Z"
      },
      {
        "user": "entdark",
        "content": "\u002B1",
        "createdAt": "2026-02-06T14:32:15.6102981Z"
      }
    ],
    "comments": [
      {
        "id": 471217642,
        "author": "mikekinsman",
        "body": "OPS Build status updates of commit _[5b9e08d](https://github.com/MarchingCube/SkiaSharp/pull/807/commits/5b9e08d824382c7d1b5df650873865399f4ebf68)_: \n\n:clock10: **Preparing**: average preparing time is _1 min(s) 58 sec(s)_",
        "createdAt": "2019-03-09T20:09:26",
        "reactions": []
      },
      {
        "id": 471217654,
        "author": "msftclas",
        "body": "[![CLA assistant check](https://cla.opensource.microsoft.com/pull/badge/signed)](https://cla.opensource.microsoft.com/mono/SkiaSharp?pullRequest=807) \u003Cbr/\u003EAll CLA requirements met.",
        "createdAt": "2019-03-09T20:09:32",
        "reactions": []
      },
      {
        "id": 471217831,
        "author": "mikekinsman",
        "body": "OPS Build status updates of commit _[5b9e08d](https://github.com/MarchingCube/SkiaSharp/pull/807/commits/5b9e08d824382c7d1b5df650873865399f4ebf68)_: \n\n:clock10: **Incremental building**: average incremental building time is _19 sec(s)_",
        "createdAt": "2019-03-09T20:11:24",
        "reactions": []
      },
      {
        "id": 471217876,
        "author": "mikekinsman",
        "body": "OPS Build status updates of commit _[5b9e08d](https://github.com/MarchingCube/SkiaSharp/pull/807/commits/5b9e08d824382c7d1b5df650873865399f4ebf68)_: \n\n### :white_check_mark: Validation status: passed\r\n\r\n\r\nFile | Status | Preview URL | Details\r\n---- | ------ | ----------- | -------\r\n[.gitmodules](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/.gitmodules) | :white_check_mark:Succeeded | |\r\n[binding/Binding/SKMatrix.cs](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/binding/Binding/SKMatrix.cs) | :white_check_mark:Succeeded | |\r\n[binding/Binding/SKPaint.cs](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/binding/Binding/SKPaint.cs) | :white_check_mark:Succeeded | |\r\n[binding/Binding/SkiaApi.cs](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/binding/Binding/SkiaApi.cs) | :white_check_mark:Succeeded | |\r\n[externals/skia](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/externals/skia) | :white_check_mark:Succeeded | |\r\n\r\nFor more details, please refer to the [build report](https://opbuildstorageprod.blob.core.windows.net/report/2019%5C3%5C9%5C81ca5486-8c50-0a94-05c4-486e23e99ecf%5CPullRequest%5C201903092009243364-807%5Cworkflow_report.html?sv=2015-02-21\u0026sr=b\u0026sig=%2Bfq6ybrDQcis3x1Qwh58yRMD7yl%2BE5BNvHayl8Dgq2w%3D\u0026st=2019-03-09T20%3A06%3A54Z\u0026se=2019-04-09T20%3A11%3A54Z\u0026sp=r).\r\n\r\n**Note:** If you changed an existing file name or deleted a file, broken links in other files to the deleted or renamed file are listed only in the full build report.\r\n",
        "createdAt": "2019-03-09T20:11:54",
        "reactions": []
      },
      {
        "id": 471306550,
        "author": "mattleibow",
        "body": "I merged the native PR, so you should be able to switch the submodule back to the mono org.",
        "createdAt": "2019-03-10T13:33:26",
        "reactions": []
      },
      {
        "id": 471306725,
        "author": "mattleibow",
        "body": "Thanks for this PR, and the benchmarks. It is a major saving - especially if there are several properties used.",
        "createdAt": "2019-03-10T13:35:51",
        "reactions": []
      },
      {
        "id": 471307255,
        "author": "mikekinsman",
        "body": "OPS Build status updates of commit _[b51ac90](https://github.com/MarchingCube/SkiaSharp/pull/807/commits/b51ac903f8237c9e3e404fcb7495f908819a2ef8)_: \n\n:clock10: **Preparing**: average preparing time is _1 min(s) 58 sec(s)_",
        "createdAt": "2019-03-10T13:42:01",
        "reactions": []
      },
      {
        "id": 471307420,
        "author": "mikekinsman",
        "body": "OPS Build status updates of commit _[b51ac90](https://github.com/MarchingCube/SkiaSharp/pull/807/commits/b51ac903f8237c9e3e404fcb7495f908819a2ef8)_: \n\n:clock10: **Incremental building**: average incremental building time is _19 sec(s)_",
        "createdAt": "2019-03-10T13:43:59",
        "reactions": []
      },
      {
        "id": 471307451,
        "author": "mikekinsman",
        "body": "OPS Build status updates of commit _[b51ac90](https://github.com/MarchingCube/SkiaSharp/pull/807/commits/b51ac903f8237c9e3e404fcb7495f908819a2ef8)_: \n\n### :white_check_mark: Validation status: passed\r\n\r\n\r\nFile | Status | Preview URL | Details\r\n---- | ------ | ----------- | -------\r\n[binding/Binding/SKMatrix.cs](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/binding/Binding/SKMatrix.cs) | :white_check_mark:Succeeded | |\r\n[binding/Binding/SKPaint.cs](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/binding/Binding/SKPaint.cs) | :white_check_mark:Succeeded | |\r\n[binding/Binding/SkiaApi.cs](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/binding/Binding/SkiaApi.cs) | :white_check_mark:Succeeded | |\r\n[externals/skia](https://github.com/MarchingCube/SkiaSharp/blob/skpaint-and-skmatrix/externals/skia) | :white_check_mark:Succeeded | |\r\n\r\nFor more details, please refer to the [build report](https://opbuildstorageprod.blob.core.windows.net/report/2019%5C3%5C10%5C81ca5486-8c50-0a94-05c4-486e23e99ecf%5CPullRequest%5C201903101341588548-807%5Cworkflow_report.html?sv=2015-02-21\u0026sr=b\u0026sig=%2Bhmv2E4pOelu2Rr4Uzu42mKgzhfzGOn1z%2F%2BrOa4JyOQ%3D\u0026st=2019-03-10T13%3A39%3A17Z\u0026se=2019-04-10T13%3A44%3A17Z\u0026sp=r).\r\n\r\n**Note:** If you changed an existing file name or deleted a file, broken links in other files to the deleted or renamed file are listed only in the full build report.\r\n",
        "createdAt": "2019-03-10T13:44:18",
        "reactions": []
      }
    ]
  }
}