{
  "number": 532,
  "type": "issue",
  "state": "closed",
  "title": "SkiaBitmap.Encode always returns false for certain file types",
  "body": "### Description\r\n\r\nIf I a either creating a new image or editing and existing file the SkBitmap.Encode method returns false.\r\nThe file that is created cannot be opened and is invalid or corrupt.\r\n\r\n### Code\r\n\r\n            SKImageInfo imageInfo = new SKImageInfo(1000, 800);\r\n            using (SKBitmap bitmap = new SKBitmap(imageInfo))\r\n            {\r\n                SKCanvas canvas = new SKCanvas(bitmap);\r\n                canvas.Clear(SKColors.White);\r\n\r\n                using (SKWStream stream = new SKFileWStream(\u0022[File Path]\u0022))\r\n                {\r\n                    bool results = bitmap.Encode(stream, SKEncodedImageFormat.Gif, 80);\r\n                    // results are always false for GIF, ICO, WBMP\r\n                }\r\n            }\r\n\r\n### Expected Behavior\r\n\r\nThe SkBitmap.Encode should return true and the file created\\edited can be opened and viewed without issue.\r\n\r\n### Actual Behavior\r\n\r\nSkBitmap.Encode returns false and the file is corrupt\\invalid.\r\n\r\n### Basic Information\r\n\r\n- Version with issue:  1.60.1\r\n- Last known good version:  N\\A\r\n- IDE: VS2017\r\n- Platform Target Frameworks: .NETstandard 2.0\r\n\r\n- Target Devices: N\\A (Library for use on several platforms)\r\n\r\n",
  "author": {
    "login": "ghost",
    "type": "User"
  },
  "labels": [
    {
      "name": "status/duplicate",
      "color": "B8EC4A"
    }
  ],
  "assignees": [],
  "createdAt": "2018-05-27T00:38:25",
  "updatedAt": "2022-08-19T15:02:27",
  "closedAt": "2018-05-27T02:14:22",
  "commentCount": 3,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T14:02:58.4157356Z",
    "reactions": [],
    "comments": [
      {
        "id": 392300233,
        "author": "mattleibow",
        "body": "This is a known limitation: https://github.com/mono/SkiaSharp/issues/320#issuecomment-310805723\r\n\r\n\u003E ... by default, skia compiles with it\u0027s own codecs:\r\n\u003E https://github.com/mono/skia/blob/xamarin-mobile-bindings/src/images/SkImageEncoder.cpp\r\n\u003E Basically JPG, PNG, WEBP.\r\n\u003E \u2026 so I asked: https://groups.google.com/forum/#!topic/skia-discuss/a_HNOFtuyWg\r\n\u003E They said:\r\n\u003E \u003E Android only needed JPG, PNG, and WEBP.  So that\u0027s what we provided them.\r\n\u003E \u003E Until recently, we have had no other clients for our image encoders or decoders.\r\n\u003E \u003E A client can always write their own with SkPixelSerializer.  \r\n\u003E \u003E \u2026\r\n\u003E \u003E \u2026 these days even Windows supports PNGs.",
        "createdAt": "2018-05-27T02:13:49",
        "reactions": []
      },
      {
        "id": 392300248,
        "author": "mattleibow",
        "body": "Duplicate of #320 ",
        "createdAt": "2018-05-27T02:14:21",
        "reactions": []
      },
      {
        "id": 392300370,
        "author": "ghost",
        "body": "ok thanks for the quick response. I will try the SkPixelSerializer. ",
        "createdAt": "2018-05-27T02:17:48",
        "reactions": []
      }
    ]
  }
}