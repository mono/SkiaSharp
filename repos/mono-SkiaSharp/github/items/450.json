{
  "number": 450,
  "type": "issue",
  "state": "closed",
  "title": "Crash getting canvas from SKSurface",
  "body": "Trying to get a surface like this:\r\n\r\n\u0060\u0060\u0060cs\r\nConsole.WriteLine(\u0022Starting Skia Demo\u0022);\r\n                var imgInfo = new SKImageInfo(_fb.ScreenWidth, _fb.ScreenHeight, SKColorType.Rgb565, SKAlphaType.Unpremul);\r\n                _dbBuffer = new byte[_fb.FBSize];\r\n                _dbBufferHandle = GCHandle.Alloc(_dbBuffer, GCHandleType.Pinned);\r\n                _dbBufferPtr = _dbBufferHandle.AddrOfPinnedObject();\r\n                _surface = SKSurface.Create(imgInfo, _dbBufferPtr, imgInfo.RowBytes);\r\n                Console.WriteLine(\u0022Surface: \u0022 \u002B _surface == null);\r\n                _canvas = _surface.Canvas;\r\n                Console.WriteLine(\u0022Canvas: \u0022 \u002B _canvas == null);\r\n\u0060\u0060\u0060\r\n\r\nCrash the application with the following:\r\n\r\n\u0060\u0060\u0060\r\nStacktrace:\r\n\r\n  at \u003Cunknown\u003E \u003C0xffffffff\u003E\r\n  at (wrapper managed-to-native) SkiaSharp.SkiaApi.sk_surface_get_canvas (intptr) \u003C0x00037\u003E\r\n  at SkiaSharp.SKSurface.get_Canvas () [0x00006] in \u003Ccf546bad13294f0f88da02ef9d3e7062\u003E:0\r\n  at HelloPOS.Program.Main () [0x00077] in \u003C4ec246e0fbfd44d9b46039bb4a1d762a\u003E:0\r\n  at (wrapper runtime-invoke) object.runtime_invoke_void (object,intptr,intptr,intptr) [0x0004c] in \u003C2e7c1c96edae44d496118948ca617c11\u003E:0\r\n/proc/self/maps:\r\n00010000-00011000 r-xp 00000000 00:0f 91428      /data/opt/Debug/test\r\n00021000-00022000 rw-p 00001000 00:0f 91428      /data/opt/Debug/test\r\n0183c000-01943000 rw-p 00000000 00:00 0          [heap]\r\n40004000-40006000 r-xp 00000000 00:0f 91020      /data/opt/mono/lib/libdl-2.22.so\r\n40006000-40015000 ---p 00002000 00:0f 91020      /data/opt/mono/lib/libdl-2.22.so\r\n40015000-40016000 r--p 00001000 00:0f 91020      /data/opt/mono/lib/libdl-2.22.so\r\n40016000-40017000 rw-p 00002000 00:0f 91020      /data/opt/mono/lib/libdl-2.22.so\r\n40017000-40019000 rw-p 00000000 00:00 0\r\n4002c000-4003d000 r-xp 00000000 00:0f 91041      /data/opt/mono/lib/libnsl-2.22.so\r\n4003d000-4004c000 ---p 00011000 00:0f 91041      /data/opt/mono/lib/libnsl-2.22.so\r\n4004c000-4004d000 r--p 00010000 00:0f 91041      /data/opt/mono/lib/libnsl-2.22.so\r\n4004d000-4004e000 rw-p 00011000 00:0f 91041      /data/opt/mono/lib/libnsl-2.22.so\r\n4004e000-40051000 rw-p 00000000 00:00 0\r\n40052000-40055000 rw-p 00000000 00:00 0\r\n4005c000-40079000 r-xp 00000000 00:0f 91032      /data/opt/mono/lib/libgcc_s.so.1\r\n40079000-40088000 ---p 0001d000 00:0f 91032      /data/opt/mono/lib/libgcc_s.so.1\r\n40088000-40089000 rw-p 0001c000 00:0f 91032      /data/opt/mono/lib/libgcc_s.so.1\r\n40089000-4008b000 rw-p 00000000 00:00 0\r\n4008c000-4008d000 rw-p 00000000 00:00 0\r\n4008d000-4009d000 rwxp 00000000 00:00 0\r\n4009d000-4009e000 rw-p 00000000 00:00 0\r\n4009f000-400a0000 r--p 00000000 00:00 0\r\n400a8000-400ab000 r--p 00000000 00:0f 91422      /data/opt/Debug/app.exe\r\n400b8000-400c8000 rwxp 00000000 00:00 0\r\n400c8000-400e8000 r-xp 00000000 00:0f 91013      /data/opt/mono/lib/ld-2.22.so\r\n400e8000-400ea000 rw-p 00000000 00:00 0\r\n400f7000-400f8000 r--p 0001f000 00:0f 91013      /data/opt/mono/lib/ld-2.22.so\r\n400f8000-400f9000 rw-p 00020000 00:0f 91013      /data/opt/mono/lib/ld-2.22.so\r\n400fc000-40403000 r-xp 00000000 00:0f 91039      /data/opt/mono/lib/libmonosgen-2.0.so.1.0.0\r\n40403000-40412000 ---p 00307000 00:0f 91039      /data/opt/mono/lib/libmonosgen-2.0.so.1.0.0\r\n40412000-40416000 rw-p 00306000 00:0f 91039      /data/opt/mono/lib/libmonosgen-2.0.so.1.0.0\r\n40416000-40442000 rw-p 00000000 00:00 0\r\n40442000-40443000 ---p 00000000 00:00 0\r\n40443000-40444000 rw-p 00000000 00:00 0\r\n40444000-4052d000 r-xp 00000000 00:0f 91065      /data/opt/mono/lib/libstdc\u002B\u002B.so.6.0.21\r\n4052d000-4053c000 ---p 000e9000 00:0f 91065      /data/opt/mono/lib/libstdc\u002B\u002B.so.6.0.21\r\n4053c000-40541000 r--p 000e8000 00:0f 91065      /data/opt/mono/lib/libstdc\u002B\u002B.so.6.0.21\r\n40541000-40544000 rw-p 000ed000 00:0f 91065      /data/opt/mono/lib/libstdc\u002B\u002B.so.6.0.21\r\n40544000-40547000 rw-p 00000000 00:00 0\r\n40548000-405e0000 r-xp 00000000 00:0f 91035      /data/opt/mono/lib/libm-2.22.so\r\n405e0000-405f0000 ---p 00098000 00:0f 91035      /data/opt/mono/lib/libm-2.22.so\r\n405f0000-405f1000 r--p 00098000 00:0f 91035      /data/opt/mono/lib/libm-2.22.so\r\n405f1000-405f2000 rw-p 00099000 00:0f 91035      /data/opt/mono/lib/libm-2.22.so\r\n405f2000-405f3000 rw-p 00000000 00:00 0\r\n405f4000-4071b000 r-xp 00000000 00:0f 91018      /data/opt/mono/lib/libc-2.22.so\r\n4071b000-4072a000 ---p 00127000 00:0f 91018      /data/opt/mono/lib/libc-2.22.so\r\n4072a000-4072c000 r--p 00126000 00:0f 91018      /data/opt/mono/lib/libc-2.22.so\r\n4072c000-4072d000 rw-p 00128000 00:0f 91018      /data/opt/mono/lib/libc-2.22.so\r\n4072d000-40730000 rw-p 00000000 00:00 0\r\n40730000-40736000 r-xp 00000000 00:0f 91059      /data/opt/mono/lib/librt-2.22.so\r\n40736000-40745000 ---p 00006000 00:0f 91059      /data/opt/mono/lib/librt-2.22.so\r\n40745000-40746000 r--p 00005000 00:0f 91059      /data/opt/mono/lib/librt-2.22.so\r\n40746000-40747000 rw-p 00006000 00:0f 91059      /data/opt/mono/lib/librt-2.22.so\r\n40748000-4075e000 r-xp 00000000 00:0f 91057      /data/opt/mono/lib/libpthread-2.22.so\r\n4075e000-4076d000 ---p 00016000 00:0f 91057      /data/opt/mono/lib/libpthread-2.22.so\r\n4076d000-4076e000 r--p 00015000 00:0f 91057      /data/opt/mono/lib/libpthread-2.22.so\r\n4076e000-4076f000 rw-p 00016000 00:0f 91057      /data/opt/mono/lib/libpthread-2.22.so\r\n4076f000-40771000 rw-p 00000000 00:00 0\r\n40774000-4077a000 r-xp 00000000 00:0f 91043      /data/opt/mono/lib/libnss_compat-2.22.so\r\n4077a000-40789000 ---p 00006000 00:0f 91043      /data/opt/mono/lib/libnss_compat-2.22.so\r\n40789000-4078a000 r--p 00005000 00:0f 91043      /data/opt/mono/lib/libnss_compat-2.22.so\r\n4078a000-4078b000 rw-p 00006000 00:0f 91043      /data/opt/mono/lib/libnss_compat-2.22.so\r\n4078c000-40795000 r-xp 00000000 00:0f 91053      /data/opt/mono/lib/libnss_nis-2.22.so\r\n40795000-407a4000 ---p 00009000 00:0f 91053      /data/opt/mono/lib/libnss_nis-2.22.so\r\n407a4000-407a5000 r--p 00008000 00:0f 91053      /data/opt/mono/lib/libnss_nis-2.22.so\r\n407a5000-407a6000 rw-p 00009000 00:0f 91053      /data/opt/mono/lib/libnss_nis-2.22.so\r\n407a8000-407b1000 r-xp 00000000 00:0f 91049      /data/opt/mono/lib/libnss_files-2.22.so\r\n407b1000-407c0000 ---p 00009000 00:0f 91049      /data/opt/mono/lib/libnss_files-2.22.so\r\n407c0000-407c1000 r--p 00008000 00:0f 91049      /data/opt/mono/lib/libnss_files-2.22.so\r\n407c1000-407c2000 rw-p 00009000 00:0f 91049      /data/opt/mono/lib/libnss_files-2.22.so\r\n407c2000-407c8000 rw-p 00000000 00:00 0\r\n407c8000-407d8000 rwxp 00000000 00:00 0\r\n407d8000-407fe000 rw-s 42000000 00:0b 973        /dev/graphics/fb0\r\n40800000-40c00000 rw-p 00000000 00:00 0\r\n40c00000-40c01000 ---p 00000000 00:00 0\r\n40c01000-40e80000 rw-p 00000000 00:00 0\r\n40e80000-40eb4000 r--p 00000000 00:0f 91425      /data/opt/Debug/SkiaSharp.dll\r\n40eb4000-40ecb000 r-xp 00000000 00:0f 91068      /data/opt/mono/lib/libz.so.1.2.11\r\n40ecb000-40eda000 ---p 00017000 00:0f 91068      /data/opt/mono/lib/libz.so.1.2.11\r\n40eda000-40edb000 rw-p 00016000 00:0f 91068      /data/opt/mono/lib/libz.so.1.2.11\r\n40edb000-416db000 rw-p 00000000 00:00 0\r\n416dc000-41a93000 r--p 00000000 00:0f 91247      /data/opt/mono/lib/mono/4.5/mscorlib.dll\r\n41a93000-41a94000 ---p 00000000 00:00 0\r\n41a94000-41b93000 rw-p 00000000 00:00 0\r\n41b94000-41bc4000 r-xp 00000000 00:0f 91027      /data/opt/mono/lib/libfontconfig.so.1.7.0\r\n41bc4000-41bc5000 rw-p 00030000 00:0f 91027      /data/opt/mono/lib/libfontconfig.so.1.7.0\r\n41bc8000-41be7000 r-xp 00000000 00:0f 91024      /data/opt/mono/lib/libexpat.so.1.6.0\r\n41be7000-41bf6000 ---p 0001f000 00:0f 91024      /data/opt/mono/lib/libexpat.so.1.6.0\r\n41bf6000-41bf8000 rw-p 0001e000 00:0f 91024      /data/opt/mono/lib/libexpat.so.1.6.0\r\n41c00000-41c21000 rw-p 00000000 00:00 0\r\n41c21000-41d00000 ---p 00000000 00:00 0\r\n41d00000-42059000 r-xp 00000000 00:0f 91062      /data/opt/mono/lib/libSkiaSharp.so.60.0.0\r\n42059000-42068000 ---p 00359000 00:0f 91062      /data/opt/mono/lib/libSkiaSharp.so.60.0.0\r\n42068000-42078000 rw-p 00358000 00:0f 91062      /data/opt/mono/lib/libSkiaSharp.so.60.0.0\r\n42078000-4207d000 rw-p 00000000 00:00 0\r\n42080000-420fd000 r-xp 00000000 00:0f 91030      /data/opt/mono/lib/libfreetype.so.6.16.0\r\n420fd000-4210c000 ---p 0007d000 00:0f 91030      /data/opt/mono/lib/libfreetype.so.6.16.0\r\n4210c000-42110000 rw-p 0007c000 00:0f 91030      /data/opt/mono/lib/libfreetype.so.6.16.0\r\n42110000-42120000 rwxp 00000000 00:00 0\r\n42200000-42300000 rw-p 00000000 00:00 0\r\n42300000-423f8000 r--p 00000000 00:0f 91378      /data/opt/mono/lib/mono/gac/System.Core/4.0.0.0__b77a5c561934e089/System.Core.dll\r\nbecd6000-becf7000 rw-p 00000000 00:00 0          [stack]\r\nffff0000-ffff1000 r-xp 00000000 00:00 0          [vectors]\r\n\r\nNative stacktrace:\r\n\r\n\r\nDebug info from gdb:\r\n\r\nmono_gdb_render_native_backtraces not supported on this platform, unable to find gdb or lldb\r\n\r\n=================================================================\r\nGot a SIGILL while executing native code. This usually indicates\r\na fatal error in the mono runtime or one of the native libraries\r\nused by your application.\r\n=================================================================\r\n\r\nAborted\r\n\u0060\u0060\u0060\r\n\r\nAny ideas on what that may be? Thanks",
  "author": {
    "login": "galvesribeiro",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2018-02-13T17:03:00",
  "updatedAt": "2022-08-19T18:01:32",
  "closedAt": "2018-02-16T13:28:07",
  "commentCount": 10,
  "reactionCount": 0
}