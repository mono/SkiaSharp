{
  "number": 2328,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] SKImage.Encode quits the app without any exception or error",
  "body": "**Description**\r\n\u003C!-- a general description goes here --\u003E\r\nI was trying to use SkiaSharp with some very simple code (draw a rectangle) and after investigation, it looks like somehow SkiaSharp exit the application when trying to call \u0060SKImage.Encode()\u0060 without throwing any exception or giving any error message\r\n\r\n**Code**\r\n\r\n\u003C!-- a snippet of code that demonstrates the issue --\u003E\r\n\u0060\u0060\u0060csharp\r\nusing SkiaSharp;\r\n\r\nnamespace Kedare.NotifPrinter;\r\n\r\npublic static class ImageService\r\n{\r\n    private const int Width = 200;\r\n    private const int Height = 120;\r\n    \r\n    static SKImage CreateBox()\r\n    {\r\n        var imageInfo = new SKImageInfo(Width, Height);\r\n        using var surface = SKSurface.Create(imageInfo);\r\n        var canvas = surface.Canvas;\r\n        using var paint = new SKPaint();\r\n        \r\n        canvas.Clear(SKColors.White);\r\n        \r\n        paint.Color = SKColors.Black;\r\n        paint.IsAntialias = true;\r\n        paint.StrokeWidth = 3;\r\n        paint.Style = SKPaintStyle.Stroke;\r\n\r\n        var rectangle = new SKRoundRect(new SKRect(1, 1, Width-1, Height-1), 5);\r\n                \r\n        canvas.DrawRoundRect(rectangle, paint);\r\n\r\n        using var image = surface.Snapshot();\r\n        return image;\r\n    }\r\n\r\n    public static void SaveImage()\r\n    {\r\n        Console.WriteLine(\u0022Saving image\u0022);\r\n        using var stream = File.OpenWrite(\u0022image.gif\u0022);\r\n        Console.WriteLine(stream.Name);\r\n        using var box = CreateBox();\r\n        Console.WriteLine(\u0022CreateBox done\u0022);\r\n        var encoded = box.Encode(SKEncodedImageFormat.Gif, quality: 95);\r\n        Console.WriteLine(\u0022Encode done\u0022);\r\n        encoded.SaveTo(stream);\r\n        Console.WriteLine(\u0022SaveTo done\u0022);\r\n        stream.Flush();\r\n        stream.Close(); \r\n        Console.WriteLine(\u0022Done\u0022);\r\n    }\r\n}\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nI expect all the \u0060Console.WriteLine\u0060 to be executed and the present\r\n\u003C!-- a general description of what was the expected behavior or result --\u003E\r\n\r\n**Actual Behavior**\r\nNo file is created and the console output is the following\r\n\u0060\u0060\u0060\r\n\u276F dotnet run\r\nBuilding...\r\nSaving image\r\n/Users/mpoussin/code/repositories/kedare/Kedare.NotifPrinter/image.gif\r\nCreateBox done\r\n\u0060\u0060\u0060\r\n\r\n\u003C!-- a general description of what really happened --\u003E\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  \u003C!-- the version of SkiaSharp that has the issue --\u003E 2.88.3\r\n- Last known good version:  \u003C!-- the version of SkiaSharp that still working --\u003E None\r\n- IDE:  \u003C!-- Visual Studio / Visual Studio for Mac / MonoDevelop / Visual Studio Code --\u003E Rider\r\n- Platform Target Frameworks: \u003C!-- all that apply, remove the platforms that aren\u0027t broken or haven\u0027t had any testing --\u003E\r\n  - macOS:  \u003C!-- The version of macOS you are building for, e.g. 10.10 --\u003E 13.0\r\n\r\n  \r\n\u003Cdetails\u003E\r\n  \u003Csummary\u003EDetailed IDE/OS information (click to expand)\u003C/summary\u003E\r\n  \r\n\u0060\u0060\u0060\r\n\r\ndotnet --version\r\n7.0.100\r\n\r\n\u0060\u0060\u0060\r\n\u003C/details\u003E\r\n\r\n\r\n**Screenshots**\r\n\r\n\u003C!-- if the issue is a visual issue, please include screenshots showing the problem if possible --\u003E\r\n\r\n**Reproduction Link**\r\n\r\n\u003C!-- please upload or provide a link to a reproduction case --\u003E",
  "author": {
    "login": "kedare",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-12-02T11:42:08",
  "updatedAt": "2023-01-01T15:00:48",
  "closedAt": "2022-12-02T12:22:01",
  "commentCount": 2,
  "reactionCount": 0
}