{
  "number": 2298,
  "type": "issue",
  "state": "open",
  "title": "[QUESTION] can\u0027t get FontManager.MatchCharacter to work",
  "body": "Hi develop a Xamarin app and using SkiaSharp. Try to DrawText but not able to get Glyphs (emoji to work)\r\nIn Xamarin I have text filed where user add title where the text can be combination of text and emoji like this.\r\n \r\n![Screenshot 2022-10-28 at 08 31 35](https://user-images.githubusercontent.com/9278908/198522038-437954f2-34e8-4986-aa47-d86bcd7a2c35.png)\r\n\r\n\u0022P\u0022 and \u0022Smilley with Heart eays\u0022 I have a customers private font in Xamarin and the text is showed correct in Xamarin    \r\n \r\n![image](https://user-images.githubusercontent.com/9278908/198522795-8415f425-cc8d-4fa5-964e-5771222cf7e4.png)\r\n\r\nby font fallback I think. The emoji is Apple emoji font.\r\n\r\nI try to parse the string to find out if it contains emoji but FontManager.MatchCharcter crash.\r\nI\u0027t works for the first char \u0022P\u0022 but when I get to the if (result == null) part it crash.  \r\n\r\nvar charArray = value.ToCharArray();\r\n      while (\u002B\u002Bindex \u003C charArray.Length)\r\n      {\r\n          //Get the glyphs.\r\n          var result = fontManager.MatchCharacter(paint.Typeface.FamilyName, charArray[index]);\r\n          if (result == null)\r\n          {\r\n              var emojiTypeface = fontManager.MatchCharacter(charArray[index]);\r\n        }\r\n   } \r\n\r\nI see that the Array gets 3 chars but I think it\u0027s should be 2.  I thinks I can\u0027t be the first with this issue but can\u0027t find any solution.\r\n\r\n//Regards Joacim\r\n \r\n\r\n ",
  "author": {
    "login": "JoacimWall",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-10-28T07:03:38",
  "updatedAt": "2022-10-31T09:55:14",
  "commentCount": 3,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:48:20.8233238Z",
    "reactions": [],
    "comments": [
      {
        "id": 1294726784,
        "author": "Gillibald",
        "body": "Some characters come in surrogate pairs and therefore are stored via two char values",
        "createdAt": "2022-10-28T08:59:09",
        "reactions": []
      },
      {
        "id": 1296720453,
        "author": "JoacimWall",
        "body": "Hi \r\nThanks you solved the first issue and I now can get the correct font. \r\nBut there is always a but. The SkiaSharp is not printing the complex emojis correct. \r\nThis is  the correct look.\r\n![image](https://user-images.githubusercontent.com/9278908/198957256-2738a0a2-2464-4917-a75a-ec81f3d2002c.png)\r\nusing Canvas.DrawText result in this:\r\n![image](https://user-images.githubusercontent.com/9278908/198957810-fa4ae4b2-b8a1-40cf-83da-91d8d6342710.png)\r\n\r\nusing HarfBuzz and DrawShapedText result in this:\r\n![image](https://user-images.githubusercontent.com/9278908/198957181-9800acb8-5242-4686-aff2-7a82b95f8729.png)\r\n\r\nI can\u0027t find any information on how to print this complex emoji\u0027s, Should this be supported by Skiasharp. \r\n\r\n//Thanks Joacim  \r\n    ",
        "createdAt": "2022-10-31T07:52:06",
        "reactions": []
      },
      {
        "id": 1296852160,
        "author": "Gillibald",
        "body": "Skia isn\u0027t doing any shaping. Use SkiaSharp.Harfbuzz",
        "createdAt": "2022-10-31T09:55:14",
        "reactions": []
      }
    ]
  }
}