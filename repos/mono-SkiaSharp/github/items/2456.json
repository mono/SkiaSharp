{
  "number": 2456,
  "type": "issue",
  "state": "open",
  "title": "[BUG] Access Violation Error on SKBitmap.Copy()",
  "body": "**Description**\r\n\r\nAfter creating an SKBitmap in a multithread process, I am receiving an Access Violation error.\r\n\r\n**Code**\r\n\r\nOpen the solution location in https://github.com/gktval/SkiaSharpError/tree/main/SkiaSharpAccessViolation\r\n\r\nThere are 3 projects in the solution:\r\n\r\n    SkiaSharpAccessViolation.csproj (This is a .Net Maui Project). It should be configured to run Windows platform\r\n    ProjNET (This is an open source project that is included as a dependency)\r\n    ProjNet.Sqlite (This is an open source project that uses sqlite)\r\n\r\nSkiaSharpAccessViolation.csproj relies on two dependencies - CommunityToolkit.Maui and SkiaSharp.Views.Maui.Controls\r\n\r\n**Steps to reproduce**\r\n\r\n    Start SkiaSharpAccessViolation project with Windows. Click the \u0022Click me\u0022 button.\r\n    A dialog will display. Click 4326 WGS-84 projection, then click OK.\r\n    An image should display on the screen.\r\n\r\nRepeat steps 1-3 one more time. When you click OK on the Coordinate System popup, an AccessViolation error will be thrown.\r\n\r\n**Notes**\r\n\r\nIn my original project (not this one), the error is thrown the first time the code is ran through. I am not quite sure why this one must be called twice. I have had the problem occur with both Windows and Android.\r\n\r\nI have tried using a simple DisplayAlert instead of the Popup, but I could not reproduce the error. Maybe do to further multithread calls in sqlite...?\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  2.88.3\r\n- Last known good version:  unknown\r\n- IDE:   Visual Studio\r\n- Platform Target Frameworks: \u003C!-- all that apply, remove the platforms that aren\u0027t broken or haven\u0027t had any testing --\u003E\r\n  - Android: 32 \r\n  - iOS:  Not sure, but I have not run into it on iOS yet\r\n  - Windows: Windows 11 \r\n- Target Devices:   Samsung and Windows\r\n \r\n**Reproduction Link**\r\n\r\nhttps://github.com/gktval/SkiaSharpError\r\n\r\n",
  "author": {
    "login": "gktval",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2023-05-09T20:27:26",
  "updatedAt": "2023-05-10T13:18:27",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:46:21.8642305Z",
    "reactions": [],
    "comments": [
      {
        "id": 1542192125,
        "author": "gktval",
        "body": "Update, trying to figure out what is causing this some more. I am able to reproduce the AccessViolationException without the ProjNet assemblies. (i.e., using \u0060\u0060\u0060await DisplayAlert(\u0022Something\u0022, \u0022Ask Something\u0022, \u0022Yes\u0022);\u0060\u0060\u0060).\r\n\r\nI also notice that I can more easily reproduce the error if I create larger bitmaps (such as 1200x1000 as compared to 256x256). \r\nOccasionally I can get the access exception on the first \u0022Click me\u0022. in the project. Here is an image of the exception and the memory usage in Diagnostics:\r\n\r\n![image](https://github.com/mono/SkiaSharp/assets/7605046/38c58860-5ac1-4ba8-ad36-716c8eb6863a)\r\n\r\nIf i make the method synchronous by taking out the await, then I cannot reproduce the error\r\n",
        "createdAt": "2023-05-10T13:13:38",
        "reactions": []
      }
    ]
  }
}