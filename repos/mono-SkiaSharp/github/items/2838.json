{
  "number": 2838,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] SKGLView on .NET MAUI is missing a handler (the return)",
  "body": "### Description\r\n\r\nThere is no more overload of UseSkiaSharp(true), and the handler for SKGLView is not registered anymore.\r\n\r\nThis is a regression, or is there a breaking change I missed ?\r\n\r\nskiasharp maui 2.88.8   \r\nmy maui ios\u002Bandroid app is net8\r\n\r\nI verified the source code on github, and I do see the handler being registered.\r\n\r\nBut when I decompile UseSkiaSharp with rider on get to the ios source code, there is no such registration.\r\n\r\nBad release ?\r\n\r\nShould be that code instead :(\r\n\r\nhttps://github.com/mono/SkiaSharp/blob/main/source/SkiaSharp.Views.Maui/SkiaSharp.Views.Maui.Controls/AppHostBuilderExtensions.cs\r\n\r\n\r\n### Code\r\n\r\nDecompiled 2.88.8, not same code as in https://github.com/mono/SkiaSharp/blob/main/source/SkiaSharp.Views.Maui/SkiaSharp.Views.Maui.Controls/AppHostBuilderExtensions.cs\r\n\r\n\r\n\u0060\u0060\u0060cs\r\n// Decompiled with JetBrains decompiler\r\n// Type: SkiaSharp.Views.Maui.Controls.Hosting.AppHostBuilderExtensions\r\n// Assembly: SkiaSharp.Views.Maui.Controls, Version=2.88.0.0, Culture=neutral, PublicKeyToken=null\r\n// MVID: 746A20A3-036F-4E0B-9FD2-26297B262D4E\r\n// Assembly location: C:\\Users\\benja_lfpsq1j\\.nuget\\packages\\skiasharp.views.maui.controls\\2.88.8\\lib\\net6.0-ios13.6\\SkiaSharp.Views.Maui.Controls.dll\r\n// XML documentation location: C:\\Users\\benja_lfpsq1j\\.nuget\\packages\\skiasharp.views.maui.controls\\2.88.8\\lib\\net6.0-ios13.6\\SkiaSharp.Views.Maui.Controls.xml\r\n\r\nusing Microsoft.Maui.Hosting;\r\nusing SkiaSharp.Views.Maui.Handlers;\r\nusing System;\r\n\r\n#nullable enable\r\nnamespace SkiaSharp.Views.Maui.Controls.Hosting\r\n{\r\n  public static class AppHostBuilderExtensions\r\n  {\r\n    public static \r\n    #nullable disable\r\n    MauiAppBuilder UseSkiaSharp(this MauiAppBuilder builder)\r\n    {\r\n      return builder.ConfigureMauiHandlers((Action\u003CIMauiHandlersCollection\u003E) (handlers =\u003E handlers.AddHandler\u003CSKCanvasView, SKCanvasViewHandler\u003E())).ConfigureImageSources((Action\u003CIImageSourceServiceCollection\u003E) (sources =\u003E\r\n      {\r\n        sources.AddService\u003CISKImageImageSource, SKImageSourceService\u003E();\r\n        sources.AddService\u003CISKBitmapImageSource, SKImageSourceService\u003E();\r\n        sources.AddService\u003CISKPixmapImageSource, SKImageSourceService\u003E();\r\n        sources.AddService\u003CISKPictureImageSource, SKImageSourceService\u003E();\r\n      }));\r\n    }\r\n  }\r\n}\r\n\u0060\u0060\u0060\r\n\r\n### Expected Behavior\r\n\r\n_No response_\r\n\r\n### Actual Behavior\r\n\r\n_No response_\r\n\r\n### Version of SkiaSharp\r\n\r\nOther (Please indicate in the description)\r\n\r\n### Last Known Good Version of SkiaSharp\r\n\r\nOther (Please indicate in the description)\r\n\r\n### IDE / Editor\r\n\r\nOther (Please indicate in the description)\r\n\r\n### Platform / Operating System\r\n\r\nWindows\r\n\r\n### Platform / Operating System Version\r\n\r\n- iOS \u002B Android\r\n\r\n### Devices\r\n\r\n_No response_\r\n\r\n### Relevant Screenshots\r\n\r\n_No response_\r\n\r\n### Relevant Log Output\r\n\r\n_No response_\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "softlion",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    },
    {
      "name": "status/needs-info",
      "color": "B8EC4A"
    }
  ],
  "assignees": [],
  "createdAt": "2024-04-18T09:35:16",
  "updatedAt": "2024-06-04T13:16:15",
  "closedAt": "2024-06-04T13:15:47",
  "commentCount": 8,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:36:42.2776141Z",
    "reactions": [],
    "comments": [
      {
        "id": 2063466370,
        "author": "softlion",
        "body": "it looks like it\u0027s back in the version 3.0.0-preview3.1 \r\n\r\nDid I dream that it was there before ? I don\u0027t think so.  \r\nMy add did work on iOS before I upgraded.\r\n\r\nIt used to be there with the \u0060UseSkiSharp(true)\u0060 overload.\r\n\r\nbtw 3.0.0-preview3.1 is crashing with that message:\r\n\r\n\u0060\u0060\u0060\r\nThe version of the native libSkiaSharp library (88.1) is incompatible with this version of SkiaSharp. Supported versions of the native libSkiaSharp library are in the range [115.0, 116.0).\r\n\r\nat SkiaSharp.SkiaSharpVersion.CheckNativeLibraryCompatible(Version minSupported, Version current, Boolean throwIfIncompatible)\r\n   at SkiaSharp.SkiaSharpVersion.CheckNativeLibraryCompatible(Boolean throwIfIncompatible)\r\n   at SkiaSharp.SKObject..cctor()\r\n\r\nInnerException was TypeInitializationException: The type initializer for \u0027SkiaSharp.SKObject\u0027 threw an exception.\r\n\t   at SkiaSharp.SKData..ctor(IntPtr x, Boolean owns)\r\n   at SkiaSharp.SKData.SKDataStatic..ctor(IntPtr x)\r\n   at SkiaSharp.SKData..cctor()\r\n\u0060\u0060\u0060\r\n\r\n",
        "createdAt": "2024-04-18T09:46:23",
        "reactions": []
      },
      {
        "id": 2064910011,
        "author": "janne-hmp",
        "body": ".NET runtime in .NET 9.0 Preview 3 is broken since they removed some globalization code. For the time being, adding  \u0060\u003CInvariantGlobalization\u003Etrue\u003C/InvariantGlobalization\u003E\u0060 to your project file should help.",
        "createdAt": "2024-04-18T18:44:42",
        "reactions": []
      },
      {
        "id": 2064990810,
        "author": "softlion",
        "body": "\u003E .NET runtime in .NET 9.0 Preview 3 is broken since they removed some globalization code. For the time being, adding \u0060\u003CInvariantGlobalization\u003Etrue\u003C/InvariantGlobalization\u003E\u0060 to your project file should help.\r\n\r\nI\u0027m using the .NET 8 stable release, not .NET 9 previews. Does that still apply ?",
        "createdAt": "2024-04-18T19:08:34",
        "reactions": []
      },
      {
        "id": 2065071320,
        "author": "janne-hmp",
        "body": "Then it may be something different. On that note, not sure if SkiaSharp 3.0 Preview 3.1 is fully compatible with .NET 8. It seems like it is being developed for .NET 9.",
        "createdAt": "2024-04-18T19:31:40",
        "reactions": []
      },
      {
        "id": 2065797202,
        "author": "softlion",
        "body": "\u003E Then it may be something different. On that note, not sure if SkiaSharp 3.0 Preview 3.1 is fully compatible with .NET 8. It seems like it is being developed for .NET 9.\r\n\r\nWell when you develop something specifically for .net9, your tfm won\u0027t be .net7. Not sure you are right on that one.",
        "createdAt": "2024-04-19T05:37:56",
        "reactions": []
      },
      {
        "id": 2070581993,
        "author": "mattleibow",
        "body": "I think the issue about the missing API is that you need to use the compatibility nuget for 2.x: https://github.com/mono/SkiaSharp/blob/release/2.x/source/SkiaSharp.Views.Maui/SkiaSharp.Views.Maui.Controls.Compatibility/AppHostBuilderExtensions.cs#L22\r\n\r\nFor 3.x, this API is no longer needed since the GL view is now part of the handlers: https://github.com/mono/SkiaSharp/blob/main/source/SkiaSharp.Views.Maui/SkiaSharp.Views.Maui.Controls/AppHostBuilderExtensions.cs#L16",
        "createdAt": "2024-04-22T18:35:42",
        "reactions": []
      },
      {
        "id": 2147442290,
        "author": "dotnet-policy-service[bot]",
        "body": "Hi @softlion. We have added the \u0060status/needs-info\u0060 label to this issue, which indicates that we have an open question for you before we can take further action. This issue will be closed automatically in 7 days if we do not hear back from you by then - please feel free to re-open it if you come back to this issue after that time.\n\u003C!-- Policy app identification https://img.shields.io/static/v1?label=PullRequestIssueManagement. --\u003E",
        "createdAt": "2024-06-04T12:43:09",
        "reactions": []
      },
      {
        "id": 2147511218,
        "author": "softlion",
        "body": "Still using 3.0.0-preview.3.1, with net8 updates the last crash is finally fixed.",
        "createdAt": "2024-06-04T13:15:47",
        "reactions": []
      }
    ]
  }
}