{
  "number": 78,
  "type": "issue",
  "state": "closed",
  "title": "\u0060SKPaint.MeasureText\u0060 returns incorrect value",
  "body": "It looks like the \u0060MeasureText\u0060 method is computing the length of strings incorrectly. Here is an example of how the incorrect bounds are computed for text. I\u0027m using the following snippet:\n\n\u0060\u0060\u0060\npaint.Color = SKColors.Black;\npaint.IsAntialias = true;\npaint.TextEncoding = SKTextEncoding.Utf16;\npaint.TextSize = 45;\nSKRect bounds = new SKRect();\npaint.MeasureText(text, ref bounds);\n\u0060\u0060\u0060\n\nAnd the \u0060bounds\u0060 rect is rendered like this, for several strings of differing lengths:\n![text-width-bug](https://cloud.githubusercontent.com/assets/934815/15088086/6989e762-13bd-11e6-8cd5-74c819a4da31.png)\n\nWhen I pad the string with spaces like so:\n\n\u0060\u0060\u0060\npaint.Color = SKColors.Black;\npaint.IsAntialias = true;\npaint.TextEncoding = SKTextEncoding.Utf16;\npaint.TextSize = 45;\nSKRect bounds = new SKRect();\nstring padded = text;\nfor (int i = 0; i \u003C text.Length; i\u002B\u002B) padded \u002B= \u0022 \u0022;\npaint.MeasureText(padded, ref bounds);\n\u0060\u0060\u0060\n\nThe bounds are computed correctly:\n\n![text-width-bug-padded](https://cloud.githubusercontent.com/assets/934815/15088139/da142452-13bd-11e6-9d74-05062ad499eb.png)\n",
  "author": {
    "login": "tdenniston",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2016-05-06T23:08:51",
  "updatedAt": "2022-08-20T06:01:25",
  "closedAt": "2016-05-12T14:58:05",
  "commentCount": 2,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:52:13.8324743Z",
    "reactions": [],
    "comments": [
      {
        "id": 218787033,
        "author": "mattleibow",
        "body": "@tdenniston Thanks for reporting this. Although it was fixed a little while ago, I re-fixed it.\n\nBasically, the error was that we were assuming UTF-8 (which was totally wrong since we could have UTF-16 and UTF-32 in the paint object). Then it was fixed to force UTF-16, although this \u0022worked\u0022 we changed the paint\u0027s encoding to UTF-16 for a few milliseconds... and \u0022forcing\u0022 is not always good. This now uses the encoding of the paint.\n\nTo draw UTF-32 text, the paint object must be ready to do so, thus you must set the \u0060TextEncoding\u0060 property to \u0060SKTextEncoding.Utf32\u0060. In fact, this is what that property is for:\n\n\u003E Describes how to interpret the text parameters that are passed to paint methods like \u0060MeasureText()\u0060 and \u0060GetTextWidths()\u0060.\n",
        "createdAt": "2016-05-12T15:08:15",
        "reactions": []
      },
      {
        "id": 219031251,
        "author": "tdenniston",
        "body": "@mattleibow Thanks for fixing it so quickly!\n",
        "createdAt": "2016-05-13T12:38:15",
        "reactions": []
      }
    ]
  }
}