{
  "number": 1188,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] macOS native crashes in gr_backendrendertarget_get_gl_framebufferinfo",
  "body": "**Description**\r\ni using SkiaSharp in a Xamarin.Forms app on macOS, after following the discussion in #1144 i have updated to the latest preview .45 which unfortunately doesn\u0027t solve the issue with native crashes for me (\u0060gr_backendrendertarget_get_gl_framebufferinfo\u0060). I have a different issue open which is related to \u0060SKImage\u0060 #1164 but i\u0027m not sure if this is the same - so here is a new open issue \uD83E\uDD13\r\n\r\n I\u0027m using an \u0060SKGLView\u0060 to draw several shapes and images which lead to a freeze and the following native crash.\r\n\r\n**Code**\r\n\r\nin my case it might be related with \u0060GRContext.GetResourceCacheUsage\u0060 \uD83E\uDD37\u200D\u2642\uFE0F\r\n\r\n\u0060\u0060\u0060\r\n=================================================================\r\n\tNative Crash Reporting\r\n=================================================================\r\nGot a SIGSEGV while executing native code. This usually indicates\r\na fatal error in the mono runtime or one of the native libraries \r\nused by your application.\r\n=================================================================\r\n\r\n=================================================================\r\n\tNative stacktrace:\r\n=================================================================\r\n\t0x107350d28 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_dump_native_crash_info\r\n\t0x1073446e5 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_handle_native_crash\r\n\t0x107661303 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : altstack_handle_and_restore.cold.1\r\n\t0x1072c1dac - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : altstack_handle_and_restore\r\n\t0x107d34465 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x142ab5e43 - Unknown\r\n\t0x142ab5c3b - Unknown\r\n\t0x142ab4803 - Unknown\r\n\t0x14294fec3 - Unknown\r\n\t0x142949c63 - Unknown\r\n\t0x142946c14 - Unknown\r\n\t0x142946ae8 - Unknown\r\n\t0x142944bed - Unknown\r\n\t0x142943d6b - Unknown\r\n\t0x142943f7e - Unknown\r\n\t0x10735b1ee - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_jit_runtime_invoke\r\n\t0x10748d318 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_runtime_invoke_checked\r\n\t0x107491c9e - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_runtime_invoke\r\n\t0x1072133d2 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : xamarin_invoke_trampoline\r\n\t0x10721499b - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : xamarin_arch_trampoline\r\n\t0x107215bc6 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : xamarin_x86_64_common_trampoline\r\n\t0x7fff33acfe29 - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : -[NSWindow(NSGestureRecognizer_Routing) _sendEventToGestureRecognizers:requireAcceptsFirstMouse:]\r\n\t0x7fff33ad7ac2 - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : -[NSWindow(NSEventRouting) _handleMouseDownEvent:isDelayedEvent:]\r\n\t0x7fff33a41c5c - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : -[NSWindow(NSEventRouting) _reallySendEvent:isDelayedEvent:]\r\n\t0x7fff33a41005 - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : -[NSWindow(NSEventRouting) sendEvent:]\r\n\t0x7fff33a3f37c - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : -[NSApplication(NSEvent) sendEvent:]\r\n\t0x7fff3388b0cf - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : -[NSApplication run]\r\n\t0x7fff3385d465 - /System/Library/Frameworks/AppKit.framework/Versions/C/AppKit : NSApplicationMain\r\n\t0x1113e8aec - Unknown\r\n\t0x1112bc2a3 - Unknown\r\n\t0x10879d8fb - Unknown\r\n\t0x10879da91 - Unknown\r\n\t0x10735b1ee - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_jit_runtime_invoke\r\n\t0x10748d318 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_runtime_invoke_checked\r\n\t0x1074947c5 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_runtime_exec_main_checked\r\n\t0x1072b7e9c - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_jit_exec\r\n\t0x1072bafd4 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : mono_main\r\n\t0x107216578 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : xamarin_main\r\n\t0x1072173e4 - /Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MacOS/Project : main\r\n\t0x7fff6dd7a7fd - /usr/lib/system/libdyld.dylib : start\r\n\r\n=================================================================\r\n\tTelemetry Dumper:\r\n=================================================================\r\nPkilling 0x70000a25d000 from 0x108a2edc0\r\nPkilling 0x70000e14f000 from 0x108a2edc0\r\nPkilling 0x70000a866000 from 0x108a2edc0\r\nPkilling 0x70000b587000 from 0x108a2edc0\r\nPkilling 0x70000e758000 from 0x108a2edc0\r\nPkilling 0x70000ae6f000 from 0x108a2edc0\r\nPkilling 0x70000bb90000 from 0x108a2edc0\r\nPkilling 0x70000ed61000 from 0x108a2edc0\r\nPkilling 0x70000c199000 from 0x108a2edc0\r\nPkilling 0x70000c7a2000 from 0x108a2edc0\r\nPkilling 0x70000d740000 from 0x108a2edc0\r\nPkilling 0x70000e352000 from 0x108a2edc0\r\nPkilling 0x70000aa69000 from 0x108a2edc0\r\nPkilling 0x70000b78a000 from 0x108a2edc0\r\nPkilling 0x70000e95b000 from 0x108a2edc0\r\nPkilling 0x70000b072000 from 0x108a2edc0\r\nPkilling 0x70000bd93000 from 0x108a2edc0\r\nPkilling 0x70000c39c000 from 0x108a2edc0\r\nPkilling 0x700009d51000 from 0x108a2edc0\r\nPkilling 0x70000c9a5000 from 0x108a2edc0\r\nPkilling 0x70000d943000 from 0x108a2edc0\r\nPkilling 0x70000df4c000 from 0x108a2edc0\r\nPkilling 0x70000a663000 from 0x108a2edc0\r\nPkilling 0x70000e555000 from 0x108a2edc0\r\nPkilling 0x70000ac6c000 from 0x108a2edc0\r\nPkilling 0x70000b98d000 from 0x108a2edc0\r\nPkilling 0x70000eb5e000 from 0x108a2edc0\r\nPkilling 0x70000b275000 from 0x108a2edc0\r\nPkilling 0x70000bf96000 from 0x108a2edc0\r\nPkilling 0x700009f54000 from 0x108a2edc0\r\nPkilling 0x70000cba8000 from 0x108a2edc0\r\nPkilling 0x70000d1b1000 from 0x108a2edc0\r\nCould not exec mono-hang-watchdog, expected on path \u0027/Users/Documents/Dev/Project/Project.MyProject.MacOS/bin/Debug/Project.app/Contents/MonoBundle/../bin/mono-hang-watchdog\u0027 (errno 2)\r\nEntering thread summarizer pause from 0x108a2edc0\r\nFinished thread summarizer pause from 0x108a2edc0.\r\n\r\nWaiting for dumping threads to resume\r\n\r\n=================================================================\r\n\tExternal Debugger Dump:\r\n=================================================================\r\nsocket_transport_send Cannot transition thread 0x108a2edc0 from STATE_BLOCKING with DO_BLOCKING\r\n\u0060\u0060\u0060\r\n**Expected Behavior**\r\n\r\nSKGLView should render without any problems\u002B\r\n\r\n**Actual Behavior**\r\n\r\nrandom freezes and stuck app - only force close or \u0060killall lldb\u0060 helps in my case\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  1.68.2-preview.45\r\n- IDE:  Visual Studio for Mac 8.5 (build 3183)\r\n- Platform Target Frameworks: \u003C!-- all that apply, remove the platforms that aren\u0027t broken or haven\u0027t had any testing --\u003E\r\n  - macOS: 10.15.3 (19D76)\r\n\r\n- Target Devices:   \u003C!-- the devices that you noticed this on, e.g. iPhone X --\u003E\r\n  - MacBook Pro (13-inch, 2018, Four Thunderbolt 3 Ports) | 16 GB 2133 MHz LPDDR3 | 2,3 GHz Quad-Core Intel Core i5 | Intel Iris Plus Graphics 655 1536 MB\r\n\r\n**Reproduction Link**\r\n\r\n",
  "author": {
    "login": "nor0x",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "milestone": "v1.68.2",
  "createdAt": "2020-03-25T10:02:35",
  "updatedAt": "2022-08-19T06:02:15",
  "closedAt": "2020-04-20T06:52:07",
  "commentCount": 15,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T20:50:42.6750888Z",
    "reactions": [],
    "comments": [
      {
        "id": 603892620,
        "author": "mattleibow",
        "createdAt": "2020-03-25T15:05:00",
        "reactions": []
      },
      {
        "id": 603924041,
        "author": "nor0x",
        "createdAt": "2020-03-25T15:58:35",
        "reactions": []
      },
      {
        "id": 604063932,
        "author": "mattleibow",
        "createdAt": "2020-03-25T20:18:08",
        "reactions": []
      },
      {
        "id": 604319465,
        "author": "nor0x",
        "createdAt": "2020-03-26T09:22:46",
        "reactions": []
      },
      {
        "id": 604369054,
        "author": "mattleibow",
        "createdAt": "2020-03-26T11:10:17",
        "reactions": [
          {
            "user": "nor0x",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:50:40.697093Z"
          }
        ]
      },
      {
        "id": 605720449,
        "author": "mattleibow",
        "createdAt": "2020-03-29T23:45:18",
        "reactions": [
          {
            "user": "nor0x",
            "content": "hooray",
            "createdAt": "2026-02-04T20:50:40.9013892Z"
          }
        ]
      },
      {
        "id": 605929277,
        "author": "nor0x",
        "createdAt": "2020-03-30T10:53:12",
        "reactions": []
      },
      {
        "id": 607452535,
        "author": "mattleibow",
        "createdAt": "2020-04-01T19:42:13",
        "reactions": [
          {
            "user": "nor0x",
            "content": "hooray",
            "createdAt": "2026-02-04T20:50:41.2578882Z"
          }
        ]
      },
      {
        "id": 608433516,
        "author": "mattleibow",
        "createdAt": "2020-04-03T13:28:28",
        "reactions": []
      },
      {
        "id": 608584251,
        "author": "nor0x",
        "createdAt": "2020-04-03T18:06:41",
        "reactions": []
      },
      {
        "id": 608607657,
        "author": "mattleibow",
        "createdAt": "2020-04-03T19:01:57",
        "reactions": []
      },
      {
        "id": 609010672,
        "author": "nor0x",
        "createdAt": "2020-04-04T10:50:17",
        "reactions": []
      },
      {
        "id": 609069396,
        "author": "mattleibow",
        "createdAt": "2020-04-04T18:21:44",
        "reactions": []
      },
      {
        "id": 609654530,
        "author": "nor0x",
        "createdAt": "2020-04-06T08:35:27",
        "reactions": []
      },
      {
        "id": 616347609,
        "author": "nor0x",
        "createdAt": "2020-04-20T06:52:07",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "hooray",
            "createdAt": "2026-02-04T20:50:42.6247778Z"
          }
        ]
      }
    ]
  }
}