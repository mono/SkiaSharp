{
  "number": 1137,
  "type": "issue",
  "state": "closed",
  "title": "Access Violation  sometimes when trying to draw rectangles",
  "body": "**Description**\r\nWhen using skiasharp to draw rectangles, it gives access violation error.\r\nThis happens when I do from wpf and I use the SkElement and the first time it triggers the PaintSurface Event.\r\n\r\n**Code**\r\n\r\non wpf is this\r\n\r\n        private void PaintSurface(object? sender, SKPaintSurfaceEventArgs e)\r\n        {\r\n            Execute.OnUIThread(() =\u003E\r\n            {\r\n                e.Surface.Canvas.Clear();\r\n                _thisSquare.DrawSquare(e.Surface.Canvas, e.Info.Width, e.Info.Height);\r\n\r\n            });\r\n        }\r\n\r\non cross platform is this\r\n\r\n        public void DrawSquare(SKCanvas thisCanvas, float width, float height)\r\n        {\r\n\r\n            var bounds = SKRect.Create(0, 0, width, height);\r\n            _redPenBrush!.StrokeWidth = bounds.Width / 20;\r\n            _slateGrayPenBrush!.StrokeWidth = bounds.Width / 30;\r\n            _blackPenBrush!.StrokeWidth = bounds.Width / 20;\r\n            _darkGrayPenBrush!.StrokeWidth = bounds.Width / 30;\r\n            MiscHelpers.DefaultFont = \u0022Verdana\u0022;\r\n            var thisPercs = MiscHelpers.EnumLinearGradientPercent.Angle45;\r\n            if (IsFlipped == true)\r\n            {\r\n                if (IsMine == true || Flagged == true)\r\n                {\r\n                    var firstColor = new SKColor(255, 255, 255, 100);\r\n                    var secondColor = new SKColor(0, 0, 0, 100);\r\n                    var secondBrush = MiscHelpers.GetLinearGradientPaint(firstColor, secondColor, bounds, thisPercs);\r\n                    thisCanvas.DrawOval(bounds.Left \u002B (bounds.Width / 2), bounds.Top \u002B (bounds.Width / 2), bounds.Width / 4, bounds.Height / 4, _redSolidBrush);\r\n                    // well see how the second part comes along (could be iffy)(?)\r\n                    thisCanvas.DrawOval(bounds.Left \u002B (bounds.Width / 2), bounds.Top \u002B (bounds.Width / 2), bounds.Width / 4, bounds.Height / 4, secondBrush);\r\n                }\r\n                else if (NeighborMines \u003E 0)\r\n                {\r\n                    var textPaint = MiscHelpers.GetTextPaint(SKColors.Aqua, (bounds.Height * 3) / 4);\r\n                    thisCanvas.DrawCustomText(NeighborMines.ToString(), TextExtensions.EnumLayoutOptions.Center, TextExtensions.EnumLayoutOptions.Center, textPaint, bounds, out _); // i think\r\n                }\r\n                if (Flagged == true)\r\n                {\r\n                    thisCanvas.DrawLine(bounds.Location.X, bounds.Location.Y, bounds.Location.X \u002B bounds.Width, bounds.Location.Y \u002B bounds.Height, _blackPenBrush);\r\n                    thisCanvas.DrawLine(bounds.Location.X \u002B bounds.Width, bounds.Location.Y, bounds.Location.X, bounds.Location.Y \u002B bounds.Height, _blackPenBrush);\r\n                }\r\n            }\r\n            else\r\n            {\r\n                SKRect otherRect;\r\n                otherRect = SKRect.Create(bounds.Location.X \u002B (bounds.Width / 6), bounds.Location.Y \u002B (bounds.Height / 6), (bounds.Width * 2) / 3, (bounds.Height * 2) / 3);\r\n                SKColor firstColor;\r\n                SKColor secondColor;\r\n                SKPaint currentPaint;\r\n                if (Pressed == true)\r\n                {\r\n                    currentPaint = _darkGrayPenBrush;\r\n                    firstColor = new SKColor(0, 0, 0, 150);\r\n                    secondColor = new SKColor(255, 255, 255, 150);\r\n                }\r\n                else\r\n                {\r\n                    currentPaint = _slateGrayPenBrush;\r\n                    firstColor = new SKColor(255, 255, 255, 150);\r\n                    secondColor = new SKColor(0, 0, 0, 150);\r\n                }\r\n                var tempPaint = MiscHelpers.GetLinearGradientPaint(firstColor, secondColor, bounds, thisPercs);\r\n                thisCanvas.DrawRect(bounds, tempPaint);\r\n                thisCanvas.DrawRect(otherRect, currentPaint);\r\n                if (Flagged == true)\r\n                {\r\n                    SKPath ThisPath = new SKPath();\r\n                    ThisPath.MoveTo(bounds.Location.X \u002B (bounds.Width / 2), bounds.Location.Y \u002B (bounds.Height / 4));\r\n                    ThisPath.LineTo(bounds.Location.X \u002B ((bounds.Width * 3) / 4), bounds.Location.Y \u002B ((bounds.Height * 3) / 8));\r\n                    ThisPath.LineTo(bounds.Location.X \u002B (bounds.Width / 2), bounds.Location.Y \u002B (bounds.Height / 2));\r\n                    thisCanvas.DrawPath(ThisPath, _redSolidBrush);\r\n                    thisCanvas.DrawLine(bounds.Location.X \u002B (bounds.Width / 2), bounds.Location.Y \u002B ((bounds.Height * 3) / 4), bounds.Location.X \u002B (bounds.Width / 2), bounds.Location.Y \u002B (bounds.Height / 4), _redPenBrush);\r\n                }\r\n            }\r\n            thisCanvas.DrawRect(bounds, _slateGrayPenBrush);\r\n        }\r\n\r\nthe 2 lines causing the problem is this\r\n\r\n    thisCanvas.DrawRect(bounds, tempPaint);\r\n    thisCanvas.DrawRect(otherRect, currentPaint);\r\n\r\n\r\n\r\n**Expected Behavior**\r\nExpected behavior is to actually draw\r\n\r\n**Actual Behavior**\r\nAccess violation on one of the 2 lines of code\r\n\r\n    thisCanvas.DrawRect(bounds, tempPaint);\r\n    thisCanvas.DrawRect(otherRect, currentPaint);\r\n\r\n\r\n**Basic Information**\r\n\r\nversion is 1.68.1.1\r\nwith wpf.\r\nhowever, the part that raise the error and won\u0027t let me handle it is the cross platform skiasharp.\r\n\r\n",
  "author": {
    "login": "musictopia2",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "milestone": "v1.68.2",
  "createdAt": "2020-02-10T21:36:31",
  "updatedAt": "2022-08-19T06:02:46",
  "closedAt": "2020-04-09T01:52:30",
  "commentCount": 28,
  "reactionCount": 1,
  "engagement": {
    "syncedAt": "2026-02-04T20:49:47.3729934Z",
    "reactions": [
      {
        "user": "alexandrvslv",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:49:47.3730008Z"
      }
    ],
    "comments": [
      {
        "id": 584374896,
        "author": "mattleibow",
        "createdAt": "2020-02-10T21:50:42",
        "reactions": []
      },
      {
        "id": 584377457,
        "author": "musictopia2",
        "createdAt": "2020-02-10T21:57:12",
        "reactions": []
      },
      {
        "id": 584445606,
        "author": "mattleibow",
        "createdAt": "2020-02-11T01:48:21",
        "reactions": []
      },
      {
        "id": 584456235,
        "author": "musictopia2",
        "createdAt": "2020-02-11T02:38:20",
        "reactions": []
      },
      {
        "id": 584457497,
        "author": "musictopia2",
        "createdAt": "2020-02-11T02:46:03",
        "reactions": []
      },
      {
        "id": 584458009,
        "author": "musictopia2",
        "createdAt": "2020-02-11T02:48:59",
        "reactions": []
      },
      {
        "id": 584579053,
        "author": "mattleibow",
        "createdAt": "2020-02-11T10:55:34",
        "reactions": []
      },
      {
        "id": 584631869,
        "author": "musictopia2",
        "createdAt": "2020-02-11T13:23:28",
        "reactions": []
      },
      {
        "id": 584632249,
        "author": "musictopia2",
        "createdAt": "2020-02-11T13:24:18",
        "reactions": []
      },
      {
        "id": 585071989,
        "author": "mattleibow",
        "createdAt": "2020-02-12T07:37:14",
        "reactions": []
      },
      {
        "id": 585252103,
        "author": "musictopia2",
        "createdAt": "2020-02-12T15:11:45",
        "reactions": []
      },
      {
        "id": 585269020,
        "author": "musictopia2",
        "createdAt": "2020-02-12T15:45:54",
        "reactions": []
      },
      {
        "id": 592238917,
        "author": "mattleibow",
        "createdAt": "2020-02-28T00:00:10",
        "reactions": []
      },
      {
        "id": 592761516,
        "author": "musictopia2",
        "createdAt": "2020-02-28T22:37:49",
        "reactions": []
      },
      {
        "id": 599097461,
        "author": "alexandrvslv",
        "createdAt": "2020-03-14T16:54:36",
        "reactions": []
      },
      {
        "id": 601337602,
        "author": "musictopia2",
        "createdAt": "2020-03-19T18:17:08",
        "reactions": []
      },
      {
        "id": 601364961,
        "author": "mattleibow",
        "createdAt": "2020-03-19T19:10:54",
        "reactions": []
      },
      {
        "id": 601602028,
        "author": "mattleibow",
        "createdAt": "2020-03-20T09:17:58",
        "reactions": []
      },
      {
        "id": 601734749,
        "author": "musictopia2",
        "createdAt": "2020-03-20T14:40:02",
        "reactions": []
      },
      {
        "id": 601753904,
        "author": "mattleibow",
        "createdAt": "2020-03-20T15:18:35",
        "reactions": []
      },
      {
        "id": 601780918,
        "author": "musictopia2",
        "createdAt": "2020-03-20T16:09:09",
        "reactions": []
      },
      {
        "id": 601826214,
        "author": "mattleibow",
        "createdAt": "2020-03-20T17:35:31",
        "reactions": []
      },
      {
        "id": 601832174,
        "author": "musictopia2",
        "createdAt": "2020-03-20T17:48:15",
        "reactions": []
      },
      {
        "id": 601840084,
        "author": "mattleibow",
        "createdAt": "2020-03-20T18:06:38",
        "reactions": []
      },
      {
        "id": 601852147,
        "author": "musictopia2",
        "createdAt": "2020-03-20T18:34:21",
        "reactions": []
      },
      {
        "id": 611283210,
        "author": "mattleibow",
        "createdAt": "2020-04-09T01:52:30",
        "reactions": []
      },
      {
        "id": 617324002,
        "author": "axel578",
        "createdAt": "2020-04-21T18:04:58",
        "reactions": []
      },
      {
        "id": 617494144,
        "author": "mattleibow",
        "createdAt": "2020-04-22T01:30:52",
        "reactions": []
      }
    ]
  }
}