{
  "number": 1108,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] Can not show UI elements on top of XF WPF SKGLView",
  "body": "**Description**\r\n\r\nWhen a class is derived from SKGLView UI elements on top of that element are not shown in XF WPF\r\n\r\n**Code**\r\n\r\nThe custom SKGLView is created like this:\r\n\r\n\u0060\u0060\u0060csharp\r\nusing SkiaSharp;\r\nusing SkiaSharp.Views.Forms;\r\n\r\nnamespace Mapsui.UI.Forms\r\n{\r\n    public class MyCustomView : SKGLView\r\n    {\r\n        public MyCustomView()\r\n        {\r\n            PaintSurface \u002B= MyCustomView_PaintSurface;\r\n        }\r\n\r\n        private void MyCustomView_PaintSurface(object sender, SKPaintGLSurfaceEventArgs e)\r\n        {\r\n            e.Surface.Canvas.Clear(new SKColor(255, 128, 128));\r\n        }\r\n    }\r\n}\r\n\u0060\u0060\u0060\r\n\r\nPut it in a page and put a button on top like this:\r\n\u0060\u0060\u0060xaml\r\n\u003C?xml version=\u00221.0\u0022 encoding=\u0022utf-8\u0022 ?\u003E\r\n\u003CContentPage xmlns=\u0022http://xamarin.com/schemas/2014/forms\u0022\r\n             xmlns:x=\u0022http://schemas.microsoft.com/winfx/2009/xaml\u0022\r\n\t\t\t xmlns:mapsui=\u0022clr-namespace:Mapsui.UI.Forms;assembly=Mapsui.UI.Forms\u0022\r\n             x:Class=\u0022Mapsui.Samples.Forms.MainPageLarge\u0022\u003E\r\n    \u003CContentPage.Content\u003E\r\n            \u003CGrid\r\n                VerticalOptions=\u0022FillAndExpand\u0022\r\n                HorizontalOptions=\u0022FillAndExpand\u0022\u003E\r\n            \u003Cmapsui:MyCustomView x:Name=\u0022mapView\u0022\r\n    \t\t    VerticalOptions=\u0022FillAndExpand\u0022\r\n                HorizontalOptions=\u0022FillAndExpand\u0022\r\n\t\t        BackgroundColor=\u0022Gray\u0022 \r\n\t\t        Margin=\u00220\u0022 /\u003E\r\n                \u003CButton \r\n                    WidthRequest=\u0022160\u0022 \r\n                    HeightRequest=\u0022160\u0022 \r\n                    HorizontalOptions=\u0022Center\u0022 \r\n                    VerticalOptions=\u0022Center\u0022 \r\n                    Text=\u0022Hello\u0022\u003E\u003C/Button\u003E\r\n            \u003C/Grid\u003E\r\n    \u003C/ContentPage.Content\u003E\r\n\u003C/ContentPage\u003E\r\n\u0060\u0060\u0060\r\n\r\n\r\n**Expected Behavior**\r\n\r\nThe button is visible as in XF UWP:\r\n![image](https://user-images.githubusercontent.com/963462/72649654-8a77f000-397e-11ea-965f-346de09502a5.png)\r\n\r\n**Actual Behavior**\r\n\r\nThe button is not visible in XF WPF\r\n\r\n![image](https://user-images.githubusercontent.com/963462/72649714-b004f980-397e-11ea-8cb4-35eb5fcef78a.png)\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  1.68.2-preview.17\r\n- Last known good version:  wpf did not work at all in the previous version we used.\r\n- IDE: VS 2019 professional\r\n- Platform Target Frameworks: XF WPF\r\n- Target Devices: Windows desktop\r\n\r\n**Related reports**\r\nMapsui got a bug reported [here](https://github.com/Mapsui/Mapsui/issues/775). Alerts are also not shown on top of the map.",
  "author": {
    "login": "pauldendulk",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "milestone": "v2.88.x Planning",
  "createdAt": "2020-01-17T22:16:55",
  "updatedAt": "2024-05-31T16:19:53",
  "closedAt": "2024-05-31T16:19:53",
  "commentCount": 9,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T12:53:57.4934806Z",
    "reactions": [],
    "comments": [
      {
        "id": 576050269,
        "author": "pauldendulk",
        "body": "Here is a minimal reproducible example.\r\nhttps://github.com/pauldendulk/ButtonDoesNotShow",
        "createdAt": "2020-01-19T21:38:42",
        "reactions": []
      },
      {
        "id": 590747229,
        "author": "pauldendulk",
        "body": "@mattleibow Any update on this? We have a sample for WPF Forms. Users actually try to build apps based on this sample but have to hold their development when they find this issue. If this is not supported please let us know then we can remove the sample. ",
        "createdAt": "2020-02-25T08:34:44",
        "reactions": []
      },
      {
        "id": 614629117,
        "author": "charlenni",
        "body": "Create another sample for this problem: [SkiaTest](https://github.com/charlenni/SkiaTest). There you could see the problem too. See label in the top left corner and button in the top right corner.",
        "createdAt": "2020-04-16T12:43:52",
        "reactions": []
      },
      {
        "id": 614730682,
        "author": "mattleibow",
        "body": "Hi folks. I looked into this and it is because of an actual limitation of the windowing interoperability between WPF and the Win32 GLControl.\r\n\r\nhttps://docs.microsoft.com/dotnet/framework/wpf/advanced/wpf-and-win32-interoperation#notable-differences-in-output-behavior\r\n\r\n\u003E - HwndHost will appear on top of other WPF elements in the same top-level window. However, a ToolTip or ContextMenu generated menu is a separate top-level window, and so will behave correctly with HwndHost.\r\n\u003E - HwndHost does not respect the clipping region of its parent UIElement. This is potentially an issue if you attempt to put an HwndHost class inside a scrolling region or Canvas.\r\n\r\nThis is directly related to #745 which is about providing an alternate means for GPU for WPF. Now that we have .NET Core WPF, this issue is moving up the list.",
        "createdAt": "2020-04-16T15:40:16",
        "reactions": []
      },
      {
        "id": 615079668,
        "author": "pauldendulk",
        "body": "@mattleibow Thanks for the update. If I understand correctly this will be fixed in a future version. What kind of fix should we look for in the release notes? You mention .NET Core WPF. The thread you point to talks about \u0027GPU-accelerated off-screen context\u0027, ANGLE, vcpkg,  DX view in WPF. I am confused. Does it helpt to jump to .NET Core?\r\n\r\nThe reason I ask is I want to be very clear to our users about what to expect. We now offer the WPF forms sample. Users see this and invest in it and then end up disappointed. Perhaps we can point them to a future release, or remove the sample altogether. Should we tell them to wait for .NET core WPF?\r\n\r\nNote, this is not a high priority thing for us. I am not urging you on. We just want to be clear to our users and not offer something that they should not invest in. \r\n\r\n",
        "createdAt": "2020-04-17T07:01:46",
        "reactions": []
      },
      {
        "id": 615332790,
        "author": "mattleibow",
        "body": "@pauldendulk The aim is to fix this in a future version. What will be happening is that we will switch from hosting OpenGL to direct DirectX usage. Right now, we use OpenGL in a hosted Win32 control which is fairly limited. If we switch to DirectX, we can draw directly on the surfaces.\r\n\r\nThe reason I mention .NET Core is that WPF appeared to be a lower priority before, but now that WPF has made a strong comeback, WPF support is now a higher priority. We have to fix this issue so that new users can be productive. The other info about ANGLE/vcpkg/etc are just the way we will get this support in. We may need to build some libraries or use some tool. Nothing is fixed in stone just yet on that.\r\n\r\nWe are currently still investigating the best way to support GPU and WPF.",
        "createdAt": "2020-04-17T16:10:36",
        "reactions": [
          {
            "user": "pauldendulk",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:53:56.8286188Z"
          }
        ]
      },
      {
        "id": 615783160,
        "author": "pauldendulk",
        "body": "@mattleibow Ah, thanks, that clears things up for me. We also got our first WPF .NET Core request yesterday. Good to know skiasharp also has a high priority for that. We will start to support this as well.",
        "createdAt": "2020-04-18T08:49:40",
        "reactions": []
      },
      {
        "id": 1311989689,
        "author": "mattleibow",
        "body": "If we can get this, then all the problems go away... I think: https://github.com/mono/SkiaSharp/issues/745",
        "createdAt": "2022-11-11T17:47:25",
        "reactions": []
      },
      {
        "id": 2142593639,
        "author": "mattleibow",
        "body": "I am going to close this issue as 2.x is not getting new features and Xamarin.Forms is out of support.\r\n\r\nHowever, for plain WPF we now have a new \u0060SKGLElement\u0060: https://github.com/mono/SkiaSharp/pull/2317",
        "createdAt": "2024-05-31T16:19:53",
        "reactions": [
          {
            "user": "pauldendulk",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:53:57.4430464Z"
          }
        ]
      }
    ]
  }
}