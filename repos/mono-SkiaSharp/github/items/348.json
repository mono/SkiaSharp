{
  "number": 348,
  "type": "issue",
  "state": "closed",
  "title": "SkiaSharp build on linux error",
  "body": "Hi dear,\r\n  When I running \u0060bootstrapper.sh -t anything \u0060  going to MSBuild, I got follow errors. Anyone to help me? \r\n  Thanks!\r\n\u0060\u0060\u0060\r\nNuGet Version: 4.1.0.2450\r\nMSBuild auto-detection: using msbuild version \u002714.0\u0027 from \u0027/usr/lib/mono/xbuild/14.0/bin\u0027. Use option -MSBuildVersion to force nuget to use a specific version of MSBuild.\r\nMSBuild P2P timeout [ms]: 120000\r\n/usr/bin/xbuild /t:GenerateRestoreGraphFile /nologo /nr:false /p:RestoreUseCustomAfterTargets=true /p:BuildProjectReferences=false /v:q  /p:NuGetRestoreTargets=\u0022/tmp/NuGet-Scratch/zy0ly52m.o34.targets\u0022 /p:RestoreTaskAssemblyFile=\u0022/tmp/SkiaSharp/SkiaSharp/tools/nuget.exe\u0022 /p:RestoreGraphOutputPath=\u0022/tmp/NuGet-Scratch/5pxg7v36.0rd.result\u0022 /p:ExcludeRestorePackageImports=true  /p:RestoreRecursive=False  /p:RestoreProjectFilterMode=exclusionlist /p:RestoreContinueOnError=WarnAndContinue  /p:RestoreGraphProjectInput=\\\u0022/tmp/SkiaSharp/SkiaSharp/binding/Binding/Binding.shproj\\;/tmp/SkiaSharp/SkiaSharp/binding/SkiaSharp.NetStandard/SkiaSharp.NetStandard.csproj\\;/tmp/SkiaSharp/SkiaSharp/binding/Binding.Shared/Binding.Shared.shproj\\;/tmp/SkiaSharp/SkiaSharp/binding/HarfBuzzSharp.Shared/HarfBuzzSharp.Shared.shproj\\;/tmp/SkiaSharp/SkiaSharp/binding/HarfBuzzSharp.NetStandard/HarfBuzzSharp.NetStandard.csproj\\;/tmp/SkiaSharp/SkiaSharp/source/SkiaSharp.HarfBuzz/SkiaSharp.HarfBuzz.Shared/SkiaSharp.HarfBuzz.Shared.shproj\\;/tmp/SkiaSharp/SkiaSharp/source/SkiaSharp.HarfBuzz/SkiaSharp.HarfBuzz.NetStandard/SkiaSharp.HarfBuzz.NetStandard.csproj\\;/tmp/SkiaSharp/SkiaSharp/source/SkiaSharp.Views.Forms/SkiaSharp.Views.Forms.NetStandard/SkiaSharp.Views.Forms.NetStandard.csproj\\;\\\u0022 \u0022/tmp/NuGet-Scratch/zy0ly52m.o34.targets\u0022\r\nNuGet.CommandLine.CommandLineException\r\n  at NuGet.CommandLine.MsBuildUtility\u002B\u003CGetProjectReferencesAsync\u003Ed__5.MoveNext () [0x004d6] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CGetDependencyGraphSpecAsync\u003Ed__43.MoveNext () [0x000f3] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CDetermineInputsFromMSBuildAsync\u003Ed__38.MoveNext () [0x000c6] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\nSystem.AggregateException: One or more errors occurred. ---\u003E NuGet.CommandLine.CommandLineException\r\n  at NuGet.CommandLine.MsBuildUtility\u002B\u003CGetProjectReferencesAsync\u003Ed__5.MoveNext () [0x004d6] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CGetDependencyGraphSpecAsync\u003Ed__43.MoveNext () [0x000f3] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CDetermineInputsFromMSBuildAsync\u003Ed__38.MoveNext () [0x001b7] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CDetermineRestoreInputsAsync\u003Ed__37.MoveNext () [0x0012a] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CExecuteCommandAsync\u003Ed__30.MoveNext () [0x00136] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n   --- End of inner exception stack trace ---\r\n  at System.Threading.Tasks.Task.ThrowIfExceptional (System.Boolean includeTaskCanceledExceptions) [0x00011] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Threading.Tasks.Task.Wait (System.Int32 millisecondsTimeout, System.Threading.CancellationToken cancellationToken) [0x00043] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Threading.Tasks.Task.Wait () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.Command.Execute () [0x000bd] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n  at NuGet.CommandLine.Program.MainCore (System.String workingDirectory, System.String[] args) [0x001f3] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n---\u003E (Inner Exception #0) NuGet.CommandLine.CommandLineException\r\n  at NuGet.CommandLine.MsBuildUtility\u002B\u003CGetProjectReferencesAsync\u003Ed__5.MoveNext () [0x004d6] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CGetDependencyGraphSpecAsync\u003Ed__43.MoveNext () [0x000f3] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CDetermineInputsFromMSBuildAsync\u003Ed__38.MoveNext () [0x001b7] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CDetermineRestoreInputsAsync\u003Ed__37.MoveNext () [0x0012a] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \r\n--- End of stack trace from previous location where exception was thrown ---\r\n  at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw () [0x0000c] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess (System.Threading.Tasks.Task task) [0x0003e] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Threading.Tasks.Task task) [0x00028] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd (System.Threading.Tasks.Task task) [0x00008] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at System.Runtime.CompilerServices.TaskAwaiter\u00601[TResult].GetResult () [0x00000] in \u003Ca07d6bf484a54da2861691df910339b1\u003E:0 \r\n  at NuGet.CommandLine.RestoreCommand\u002B\u003CExecuteCommandAsync\u003Ed__30.MoveNext () [0x00136] in \u003Cd0f788a4af354971807e5d8ca6fc682e\u003E:0 \u003C---\r\n\r\nAn error occurred when executing task \u0027libs\u0027.\r\nError: NuGet: Process returned an error (exit code 1).\r\n\r\n\u0060\u0060\u0060",
  "author": {
    "login": "zhangevanone",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2017-08-01T14:46:50",
  "updatedAt": "2022-08-19T21:01:13",
  "closedAt": "2017-12-19T12:58:20",
  "commentCount": 7,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:59:11.8761012Z",
    "reactions": [],
    "comments": [
      {
        "id": 319501252,
        "author": "mattleibow",
        "body": "The new build requirement is MSBuild 15.\r\n\r\nIf you are running a relatively new version of Linux, our native library may work for you:\r\n\r\n - (Release Notes) https://github.com/mono/SkiaSharp/releases/tag/v1.59.1\r\n - (CI Build) https://jenkins.mono-project.com/view/Components/job/Components-SkiaSharp-Linux/51\r\n\r\nIn addition, you can also try out @kekekeks \u0027s builds on NuGet:\r\n - https://preview.nuget.org/packages/Avalonia.Skia.Linux.Natives/",
        "createdAt": "2017-08-01T21:23:53",
        "reactions": []
      },
      {
        "id": 319543927,
        "author": "zhangevanone",
        "body": "My running environment: Ubuntu 16.04.1 For X64, Mono\u0027s version 5.0.1.1 and SkiaSharp is v1.59.1, how can I using MSBuild 15 going todo. Thanks!",
        "createdAt": "2017-08-02T01:40:36",
        "reactions": []
      },
      {
        "id": 319587871,
        "author": "kekekeks",
        "body": "@mattleibow Could you please switch your build agent to use Ubuntu 14.04? Also, please link libstdc\u002B\u002B statically. That should cover most of the distros.",
        "createdAt": "2017-08-02T07:10:47",
        "reactions": []
      },
      {
        "id": 332882651,
        "author": "mattleibow",
        "body": "@kekekeks The build agent should be 14.04 already. And will linking libstdc\u002B\u002B statically cause any issue with dynamic bits? I may be confused, but some people (on the internet) say that if I link statically then we can\u0027t use dlopen (which is used for the GL bits). Or, is this just for libgcc?",
        "createdAt": "2017-09-28T15:59:02",
        "reactions": []
      },
      {
        "id": 332977430,
        "author": "kekekeks",
        "body": "You need to build \u0060libstdc\u002B\u002B\u0060 with \u0060-fvisibility=hidden\u0060, so it won\u0027t cause conflicts.",
        "createdAt": "2017-09-28T22:07:26",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:59:11.3595059Z"
          }
        ]
      },
      {
        "id": 332977498,
        "author": "kekekeks",
        "body": "See more information about the issues there: https://github.com/phusion/holy-build-box/blob/master/LINKING-CXX.md",
        "createdAt": "2017-09-28T22:07:47",
        "reactions": []
      },
      {
        "id": 332978807,
        "author": "kekekeks",
        "body": "See libstdc\u002B\u002B compilation flags here: https://github.com/phusion/holy-build-box/blob/master/image/build.sh#L357",
        "createdAt": "2017-09-28T22:14:45",
        "reactions": []
      }
    ]
  }
}