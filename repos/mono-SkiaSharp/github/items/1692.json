{
  "number": 1692,
  "type": "issue",
  "state": "closed",
  "title": "[QUESTION] is there a new release/prerelease scheduled anytime soon?",
  "body": "~~Does this commit a764126aee59008621b73efae483112a52457a16 shipped in the latest prelease nuget on nuget.org ?~~\r\n\r\n~~I ask because when i compile against latest main repository i cannot reproduce a crash that i have and i pretty sure (but still not 100%sure) that  the check \u0060nativeView.Handle != IntPtr.Zero\u0060 before calling \u0060Display()\u0060 from this commit, is the fix i want, but the crash still happens with latest 2.80.3-prerelease40 nuget~~\r\n\r\nNVM i found the release commit here https://github.com/mono/SkiaSharp/releases\r\n\u0060$ git log v2.80.3-preview.40^..a764126 \u0060\r\nMy response is that this commit is not released yet\r\n\r\nSo my new question is:  \r\nWhen a new prerelease will be released ? (because I need that fix the crash is happening consistently)",
  "author": {
    "login": "tmijieux",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2021-04-15T13:29:07",
  "updatedAt": "2022-08-19T00:02:48",
  "closedAt": "2021-11-11T21:26:10",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T14:17:03.9099947Z",
    "reactions": [],
    "comments": [
      {
        "id": 821152167,
        "author": "tmijieux",
        "body": "To understand why the crash is really happening, i compiled my app directly against source code of Mapsui(the lib that is using the SKGLView in my bug) and Skiasharp, and updated mapsui call to InvalidateSurface to be called immediately (rather than in RunOnUIThread, the equivalent to BeginInvokeOnMainThread of xamarin.forms)  and added a stacktrace just before calling \u0060nativeView.Display\u0060 in \u0060SKGLViewRenderer.cs\u0060 (in SkiaSharp.Views.Forms.iOS)\r\n\r\n\u003Cdetails\u003E\u003Csummary\u003ECode\u003C/summary\u003E\r\n\r\n\u0060\u0060\u0060csharp\r\nif (oneShot)\r\n{\r\n\tvar nativeView = Control;\r\n\tvar stack = Environment.StackTrace;\r\n\tnativeView?.BeginInvokeOnMainThread(() =\u003E\r\n\t{\r\n\t\tif (nativeView.Handle == IntPtr.Zero)\r\n\t\t{\r\n\t\t\tSystem.Diagnostics.Debug.WriteLine($\u0022called after dispose = {stack}\u0022);\r\n\t\t\tSystem.Diagnostics.Debug.WriteLine(\u0022\u0022);\r\n\t\t}\r\n\t\tif (nativeView.Handle != IntPtr.Zero)\r\n\t\t\tnativeView.Display();\r\n\t});\r\n\treturn;\r\n}\r\n\u0060\u0060\u0060\r\n\u003C/details\u003E\r\n\u003Cdetails\u003E\u003Csummary\u003EStackTrace\u003C/summary\u003E\r\n\r\n\u0060\u0060\u0060\r\n called after dispose =   at System.Environment.get_StackTrace () [0x00000] in /Library/Frameworks/Xamarin.iOS.framework/Versions/Current/src/Xamarin.iOS/mcs/class/corlib/System/Environment.cs:316\r\n  at SkiaSharp.Views.Forms.SKGLViewRenderer.SetupRenderLoop (System.Boolean oneShot) [0x00045] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\SkiaSharp\\source\\SkiaSharp.Views.Forms\\SkiaSharp.Views.Forms.iOS\\SKGLViewRenderer.cs:64\r\n  at SkiaSharp.Views.Forms.SKGLViewRendererBase\u00602[TFormsView,TNativeView].OnSurfaceInvalidated (System.Object sender, System.EventArgs eventArgs) [0x00000] in \u003Cc406dcd4261f4b26a5b872a091273684\u003E:0\r\n  at SkiaSharp.Views.Forms.SKGLView.InvalidateSurface () [0x00001] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\SkiaSharp\\source\\SkiaSharp.Views.Forms\\SkiaSharp.Views.Forms.Shared\\SKGLView.cs:66\r\n  at Mapsui.UI.Forms.MapControl.RefreshGraphics () [0x00029] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\Mapsui\\Mapsui.UI.Forms\\MapControl.cs:274\r\n  at Mapsui.UI.Forms.MapControl.Refresh (Mapsui.ChangeType changeType) [0x00009] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\Mapsui\\Mapsui.UI.Shared\\MapControl.cs:188\r\n  at Mapsui.UI.Forms.MapControl.SetViewportSize () [0x0004a] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\Mapsui\\Mapsui.UI.Shared\\MapControl.cs:435\r\n  at Mapsui.UI.Forms.MapControl.OnSizeChanged (System.Object sender, System.EventArgs e) [0x0000d] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\Mapsui\\Mapsui.UI.Forms\\MapControl.cs:104\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x00035] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1105\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00214] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:157\r\n  at Xamarin.Forms.Grid.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x00181] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\GridCalc.cs:43\r\n  at Xamarin.Forms.Layout.UpdateChildrenLayout () [0x00173] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:239\r\n  at Xamarin.Forms.Layout.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:203\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x0002c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1104\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00214] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:157\r\n  at Xamarin.Forms.TemplatedView.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x00022] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\TemplatedView.cs:29\r\n  at Xamarin.Forms.Layout.UpdateChildrenLayout () [0x00173] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:239\r\n  at Xamarin.Forms.Layout.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:203\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x0002c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1104\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00214] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:157\r\n  at Xamarin.Forms.Grid.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x00181] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\GridCalc.cs:43\r\n  at Xamarin.Forms.Layout.UpdateChildrenLayout () [0x00173] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:239\r\n  at Xamarin.Forms.Layout.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:203\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x0002c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1104\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00214] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:157\r\n  at Xamarin.Forms.Grid.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x00181] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\GridCalc.cs:43\r\n  at Xamarin.Forms.Layout.UpdateChildrenLayout () [0x00173] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:239\r\n  at Xamarin.Forms.Layout.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:203\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x0002c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1104\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00214] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:157\r\n  at Xamarin.Forms.AbsoluteLayout.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x0004c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\AbsoluteLayout.cs:66\r\n  at Xamarin.Forms.Layout.UpdateChildrenLayout () [0x00173] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:239\r\n  at Xamarin.Forms.Layout.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:203\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x0002c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1104\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00214] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:157\r\n  at Xamarin.Forms.Page.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x00136] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:296\r\n  at Xamarin.Forms.Page.UpdateChildrenLayout () [0x000e6] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:375\r\n  at Xamarin.Forms.Page.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:355\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.VisualElement.SetSize (System.Double width, System.Double height) [0x0002c] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:1104\r\n  at Xamarin.Forms.VisualElement.set_Bounds (Xamarin.Forms.Rectangle value) [0x00069] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:411\r\n  at Xamarin.Forms.VisualElement.Layout (Xamarin.Forms.Rectangle bounds) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:781\r\n  at Xamarin.Forms.Layout.LayoutChildIntoBoundingRegion (Xamarin.Forms.VisualElement child, Xamarin.Forms.Rectangle region) [0x00072] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Layout.cs:126\r\n  at Xamarin.Forms.Page.LayoutChildren (System.Double x, System.Double y, System.Double width, System.Double height) [0x00136] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:296\r\n  at Xamarin.Forms.Page.UpdateChildrenLayout () [0x000e6] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:375\r\n  at Xamarin.Forms.Page.OnSizeAllocated (System.Double width, System.Double height) [0x00011] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:355\r\n  at Xamarin.Forms.VisualElement.SizeAllocated (System.Double width, System.Double height) [0x00000] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\VisualElement.cs:872\r\n  at Xamarin.Forms.Page.ForceLayout () [0x00001] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:263\r\n  at Xamarin.Forms.Page.set_ContainerArea (Xamarin.Forms.Rectangle value) [0x00021] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Core\\Page.cs:142\r\n  at Xamarin.Forms.Platform.iOS.NavigationRenderer.ViewDidLayoutSubviews () [0x00127] in C:\\Users\\Thomas\\source\\repos\\Xamarin.Forms\\Xamarin.Forms.Platform.iOS\\Renderers\\NavigationRenderer.cs:184\r\n  at UIKit.UIApplication.UIApplicationMain (System.Int32 , System.String[] , System.IntPtr , System.IntPtr ) [0x00000] in \u003Cad1be307855442e4b2cb88e33f94f908\u003E:0\r\n  at UIKit.UIApplication.Main (System.String[] args, System.IntPtr principal, System.IntPtr delegate) [0x00005] in /Users/builder/azdo/_work/1/s/xamarin-macios/src/UIKit/UIApplication.cs:86\r\n  at UIKit.UIApplication.Main (System.String[] args, System.String principalClassName, System.String delegateClassName) [0x0000e] in /Users/builder/azdo/_work/1/s/xamarin-macios/src/UIKit/UIApplication.cs:65\r\n  at OpsReady.iOS.Application.Main (System.String[] args) [0x00001] in C:\\Users\\Thomas\\source\\repos\\opsready\\app\\OpsReady.iOS\\source\\Main.cs:12\r\n\u0060\u0060\u0060\r\n\r\n\u003C/details\u003E\r\n\r\nBasically what my code is doing is creating a new layout, (with a new SKGLView) when the screen rotates (because my app supports landscape mode for tablets) and I think during the same MainThread event/render loop, first the SKGLView is Invalidated because Xamarin.Forms asked views to relayout themselves, so the code \u0060nativeView?.BeginInvokeOnMainThread\u0060 is called and callback is scheduled for next render loop, and just then (still in that same, first, event/render loop) my callback that modify the layout is called and which removes my SKGLView from the view hierarchy is called, so at the next render loop the nativeView.Display() is called (because of the \u0060nativeView.Handle != IntPtr.Zero\u0060 check not yet released)\r\n\r\ni added more debug print to be sure of this:\r\n\r\n\u003Cdetails\u003E\u003Csummary\u003ECode\u003C/summary\u003E\r\n\r\n\u0060\u0060\u0060csharp\r\nif (oneShot)\r\n{\r\n\tvar nativeView = Control;\r\n\tvar stack = Environment.StackTrace;\r\n\tvar i = GlobalStaticCounter\u002B\u002B;\r\n\tstack = $\u0022 i = {i} \u0022 \u002B stack;\r\n\tSystem.Diagnostics.Debug.WriteLine($\u0022i = {i}\u0022);\r\n\tnativeView?.BeginInvokeOnMainThread(() =\u003E\r\n\t{\r\n\t\tif (nativeView.Handle == IntPtr.Zero)\r\n\t\t{\r\n\t\t\tSystem.Diagnostics.Debug.WriteLine($\u0022called after dispose = {stack}\u0022);\r\n\t\t\tSystem.Diagnostics.Debug.WriteLine(\u0022\u0022);\r\n\t\t}\r\n\t\tif (nativeView.Handle != IntPtr.Zero)\r\n\t\t\tnativeView.Display();\r\n\t});\r\n\treturn;\r\n}\r\n\u0060\u0060\u0060\r\n\r\noutput: \r\n\u0060\u0060\u0060\r\n[0:] i=12 \r\n[0:] [14:43:11 DBG] Update from orientation !!\r\n[0:] i=13 \r\n[0:] previous SKGLView removed !!!\r\n[0:] i=14 \r\n[0:] called after dispose = i=12   at System.Environment.get_StackTrace () [0x00000] in /Library/Frameworks/Xamarin.iOS.framework/Versions/Current/src/Xamarin.iOS/mcs/class/corlib/System/Environment.cs:316 \r\n  at ....\r\n\u0060\u0060\u0060\r\n\r\n\u003C/details\u003E\r\n\r\n\r\nMy biggest concern was that there could be some kind of callback/memory leak but it does not seems to be the case, it is just unlucky ordering of callbacks and a764126aee59008621b73efae483112a52457a16 is the perfect fix\r\n",
        "createdAt": "2021-04-16T12:51:58",
        "reactions": []
      }
    ]
  }
}