{
  "number": 3136,
  "type": "issue",
  "state": "open",
  "title": "[BUG] .NET MAUI app crash when new SKCanvasView() is called on Windows IoT",
  "body": "### Description\n\nIn our .NET MAUI 8.0 application, we create a new instance of SKCanvasView and app immediately crashes on Windows 10/11 IoT edition.\r\n\r\nIt all work well on standard Windows 10/11 Home/Pro, iOS and Android.\r\n\r\nNow, I am on the latest 3.116.1 and I was not able to track down which version was working well. But it was failing on 2.88.9 as well when I tried.\r\n\r\nI was able to grab a crash dump file and analyze with WinDbg. Here is what I found:\r\n\r\n\u0060\u0060\u0060\r\n0:000\u003E !dse\r\nStowed Exception Array @ 0x000002176e9a8820\r\n\r\nStowed Exception #1 @ 0x000002176dd9e228\r\n\t0x80131534 (FACILITY_URT - .NET CLR): Uncaught exception during type initialization.\r\n\r\n\tStack : 0x2176e9a8670\r\n\t\t7ffc60448674 combase!RoOriginateLanguageException\u002B0x54\r\n\t\t7ffb8b9c3b7c\r\n\r\n\u003E\u003E\u003E Associated CLR Exception \u003C\u003C\u003C\r\n\r\nException object: 000001d6ced9dc18\r\nException type:   System.TypeInitializationException\r\nMessage:          The type initializer for \u0027SkiaSharp.Views.WinUI.Native.BufferExtensions\u0027 threw an exception.\r\nInnerException:   System.Runtime.InteropServices.COMException, Use !PrintException 000001D6CED9C2B0 to see more.\r\nStackTrace (generated):\r\n    SP               IP               Function\r\n    000000277897DB30 00007FFC47705D39 SkiaSharp_Views_WinUI_Native_Projection!SkiaSharp.Views.WinUI.Native.BufferExtensions.get__objRef_global__SkiaSharp_Views_WinUI_Native_IBufferExtensionsStatics()\u002B0x9\r\n    000000277897DB60 00007FFC47705D6D SkiaSharp_Views_WinUI_Native_Projection!SkiaSharp.Views.WinUI.Native.BufferExtensions.GetByteBuffer(Windows.Storage.Streams.IBuffer)\u002B0xd\r\n    000000277897DB90 00007FFC2CF561FD SkiaSharp_Views_Windows!SkiaSharp.Views.Windows.SKXamlCanvas.CreateBitmap()\u002B0x1fd\r\n    000000277897DC90 00007FFC2CF55C13 SkiaSharp_Views_Windows!SkiaSharp.Views.Windows.SKXamlCanvas.DoInvalidate()\u002B0x93\r\n    000000277897DDA0 00007FFBFB324C93 Microsoft_InteractiveExperiences_Projection!ABI.Microsoft.UI.Dispatching.DispatcherQueueHandler.Do_Abi_Invoke(IntPtr)\u002B0x43\r\n\r\nStackTraceString: \u003Cnone\u003E\r\nHResult: 80131534\r\n\r\n0:000\u003E !PrintException /d 000001D6CED9C2B0\r\nException object: 000001d6ced9c2b0\r\nException type:   System.Runtime.InteropServices.COMException\r\nMessage:          Class not registered (0x80040154 (REGDB_E_CLASSNOTREG))\r\nInnerException:   \u003Cnone\u003E\r\nStackTrace (generated):\r\n    SP               IP               Function\r\n    000000277897CCA0 00007FFB8AEAF55A System_Private_CoreLib!System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32)\u002B0x1a\r\n    000000277897CCD0 00007FFC477049C1 SkiaSharp_Views_WinUI_Native_Projection!WinRT.BaseActivationFactory..ctor(System.String, System.String)\u002B0xe1\r\n    000000277897CD40 00007FFC47705DBA SkiaSharp_Views_WinUI_Native_Projection!SkiaSharp.Views.WinUI.Native.BufferExtensions..cctor()\u002B0x2a\r\n\r\nStackTraceString: \u003Cnone\u003E\r\nHResult: 80040154\r\n\r\n\u0060\u0060\u0060\n\n### Code\n\n\u0060var canvasView = new SKCanvasView();\u0060\n\n### Expected Behavior\n\nApp should not crash\n\n### Actual Behavior\n\nApp crashes\n\n### Version of SkiaSharp\n\n3.116.0 (Current)\n\n### Last Known Good Version of SkiaSharp\n\nOther (Please indicate in the description)\n\n### IDE / Editor\n\nVisual Studio (Windows)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\nWindows IoT Enterprise\n\n### Devices\n\n_No response_\n\n### Relevant Screenshots\n\n_No response_\n\n### Relevant Log Output\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "ivosnoza",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2025-01-07T16:08:25",
  "updatedAt": "2025-09-10T15:34:29",
  "commentCount": 9,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T13:24:13.5756448Z",
    "reactions": [],
    "comments": [
      {
        "id": 2575675098,
        "author": "similar-issues-ai[bot]",
        "body": "We\u0027ve found some similar issues:\n\n\n- #2648 , similarity score: 85%\n- #3113 , similarity score: 82%\n  \n\nIf any of the above are duplicates, please consider closing this issue out and adding additional context in the original issue.\n\n\u003E Note: You can give me feedback by \uD83D\uDC4D or \uD83D\uDC4E this comment.",
        "createdAt": "2025-01-07T16:08:34",
        "reactions": [
          {
            "user": "dingyworm",
            "content": "-1",
            "createdAt": "2026-02-06T13:24:11.9531458Z"
          }
        ]
      },
      {
        "id": 2661827091,
        "author": "airtaxi",
        "body": "I found out that the system with old Ryzen / Radeon GPUs has the same problem with this regardless of the Windows edition.\n\nFull dump: https://nas.kagamine-rin.com/public/8ff1003e1d09",
        "createdAt": "2025-02-17T02:39:25",
        "reactions": []
      },
      {
        "id": 3192570216,
        "author": "mattleibow",
        "body": "I created this test app that I think should either repro the issue, or the crash is somewhere else: https://github.com/mattleibow/ComCrashTestApp\n\nIf you can, please test and let me know.\n\nIt is an unpckaged app, so you can just run the exe, or if you don\u0027t trust me, open in VS and run.",
        "createdAt": "2025-08-15T19:53:44",
        "reactions": []
      },
      {
        "id": 3233604715,
        "author": "ivosnoza",
        "body": "Hi @mattleibow,\nthank you for your response.\n\nWindows 11 Pro\n- Click on Test button and red box appears\n\nWindows 11 IoT Enterprise\n- Click on Test button and app crashes\n\nI can\u0027t say for sure it is caused by Windows IoT or some other hardware as mentioned by @airtaxi. Do you want me to send you some system info? Thanks",
        "createdAt": "2025-08-28T13:54:46",
        "reactions": []
      },
      {
        "id": 3240165773,
        "author": "mattleibow",
        "body": "I think that I was building the interop and not statically linking the runtime. Try installing the msvc runtime. That fixed it for my tests.\n\nI am hoping to fix this soon. Just fixing some signing issues in the pipelines. ",
        "createdAt": "2025-08-31T13:59:59",
        "reactions": []
      },
      {
        "id": 3274590606,
        "author": "Inrego",
        "body": "@mattleibow any updates on this? I\u0027ve been pulling my hair for the past few months trying to figure out this, completely rewriting third party components that caused crashes, only to recently find out it\u0027s likely related to this.",
        "createdAt": "2025-09-10T11:46:39",
        "reactions": []
      },
      {
        "id": 3274623004,
        "author": "Inrego",
        "body": "For those affected, it seems to be fixed by manually installing VC as @mattleibow suggested above. Here\u0027s a command: \u0060winget install Microsoft.VCRedist.2015\u002B.x64\u0060",
        "createdAt": "2025-09-10T11:56:10",
        "reactions": []
      },
      {
        "id": 3275493265,
        "author": "danies8",
        "body": "This workaround is not good.\nCant not run this fix on each comouter.\nWhen the final fixed will be. \nIt is urgent.\n",
        "createdAt": "2025-09-10T15:33:03",
        "reactions": []
      },
      {
        "id": 3275499149,
        "author": "danies8",
        "body": "In addition,\nWhen the fixed are ready how i got these new dlls.\n\n\u003Cimg width=\u0022868\u0022 height=\u0022273\u0022 alt=\u0022Image\u0022 src=\u0022https://github.com/user-attachments/assets/3c96941f-37fe-4d3e-8f84-1db89b1cbeea\u0022 /\u003E",
        "createdAt": "2025-09-10T15:34:29",
        "reactions": []
      }
    ]
  }
}