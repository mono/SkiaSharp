{
  "number": 2900,
  "type": "issue",
  "state": "closed",
  "title": "[WINDOWS] In .NET MAUI 9.0 Preview 5, SKGLView (SwapChainPanel) crashes with unhandled exception after a while",
  "body": "### Description\n\nAfter having been on for a while, in .NET MAUI 9.0 Preview 5 on Windows, SKGLView / SwapChainPanel crashes with an exception: System.TypeInitializationException: The type initializer for \u0027WinRT.ActivationFactory\u00601\u0027 threw an exception. ---\u003E System.Runtime.InteropServices.COMException (0x80040154): Class not registered (0x80040154 (REGDB_E_CLASSNOTREG))\r\n\r\nSKCanvasView works just fine.\n\n### Code\n\nhttps://github.com/hyvanmielenpelit/GnollHack\n\n### Expected Behavior\n\nSKGLView does not crash on Windows.\n\n### Actual Behavior\n\nSKGLView consistently crashes on Windows after using the app for a while.\n\n### Version of SkiaSharp\n\n3.x (Alpha)\n\n### Last Known Good Version of SkiaSharp\n\nOther (Please indicate in the description)\n\n### IDE / Editor\n\nVisual Studio (Windows)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\nWindows 11\n\n### Devices\n\nMSI Laptop\n\n### Relevant Screenshots\n\n_No response_\n\n### Relevant Log Output\n\n\u0060\u0060\u0060shell\nName:      Application\r\nSource:        .NET Runtime\r\nDate:          13.6.2024 23.03.41\r\nEvent ID:      1026\r\nTask Category: None\r\nLevel:         Error\r\nKeywords:      Classic\r\nUser:          N/A\r\nComputer:      ProArt\r\nDescription:\r\nApplication: GnollHackM.exe\r\nCoreCLR Version: 9.0.24.30607\r\n.NET Version: 9.0.0-preview.5.24306.7\r\nDescription: The process was terminated due to an unhandled exception.\r\nException Info: System.TypeInitializationException: The type initializer for \u0027WinRT.ActivationFactory\u00601\u0027 threw an exception.\r\n ---\u003E System.Runtime.InteropServices.COMException (0x80040154): Class not registered (0x80040154 (REGDB_E_CLASSNOTREG))\r\n   at System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32 errorCode)\r\n   at WinRT.BaseActivationFactory..ctor(String typeNamespace, String typeFullName)\r\n   at WinRT.ActivationFactory\u00601..ctor()\r\n   at WinRT.ActivationFactory\u00601..cctor()\r\n\r\n   --- End of inner exception stack trace ---\r\n   at WinRT.ActivationFactory\u00601.ActivateInstance[I]()\r\n   at Microsoft.Windows.ApplicationModel.WindowsAppRuntime.DeploymentInitializeOptions..ctor()\r\n   at Microsoft.Windows.ApplicationModel.WindowsAppRuntime.DeploymentManagerCS.AutoInitialize.get_Options() in C:\\Users\\TommiGustafsson\\.nuget\\packages\\microsoft.windowsappsdk\\1.5.240311000\\include\\DeploymentManagerAutoInitializer.cs:line 44\r\n   at Microsoft.Windows.ApplicationModel.WindowsAppRuntime.DeploymentManagerCS.AutoInitialize.AccessWindowsAppSDK() in C:\\Users\\TommiGustafsson\\.nuget\\packages\\microsoft.windowsappsdk\\1.5.240311000\\include\\DeploymentManagerAutoInitializer.cs:line 30\r\n   at .cctor()\r\n\r\nEvent Xml:\r\n\u003CEvent xmlns=\u0022http://schemas.microsoft.com/win/2004/08/events/event\u0022\u003E\r\n  \u003CSystem\u003E\r\n    \u003CProvider Name=\u0022.NET Runtime\u0022 /\u003E\r\n    \u003CEventID Qualifiers=\u00220\u0022\u003E1026\u003C/EventID\u003E\r\n    \u003CVersion\u003E0\u003C/Version\u003E\r\n    \u003CLevel\u003E2\u003C/Level\u003E\r\n    \u003CTask\u003E0\u003C/Task\u003E\r\n    \u003COpcode\u003E0\u003C/Opcode\u003E\r\n    \u003CKeywords\u003E0x80000000000000\u003C/Keywords\u003E\r\n    \u003CTimeCreated SystemTime=\u00222024-06-13T20:03:41.0292988Z\u0022 /\u003E\r\n    \u003CEventRecordID\u003E62152\u003C/EventRecordID\u003E\r\n    \u003CCorrelation /\u003E\r\n    \u003CExecution ProcessID=\u002233396\u0022 ThreadID=\u00220\u0022 /\u003E\r\n    \u003CChannel\u003EApplication\u003C/Channel\u003E\r\n    \u003CComputer\u003EProArt\u003C/Computer\u003E\r\n    \u003CSecurity /\u003E\r\n  \u003C/System\u003E\r\n  \u003CEventData\u003E\r\n    \u003CData\u003EApplication: GnollHackM.exe\r\nCoreCLR Version: 9.0.24.30607\r\n.NET Version: 9.0.0-preview.5.24306.7\r\nDescription: The process was terminated due to an unhandled exception.\r\nException Info: System.TypeInitializationException: The type initializer for \u0027WinRT.ActivationFactory\u00601\u0027 threw an exception.\r\n ---\u0026gt; System.Runtime.InteropServices.COMException (0x80040154): Class not registered (0x80040154 (REGDB_E_CLASSNOTREG))\r\n   at System.Runtime.InteropServices.Marshal.ThrowExceptionForHR(Int32 errorCode)\r\n   at WinRT.BaseActivationFactory..ctor(String typeNamespace, String typeFullName)\r\n   at WinRT.ActivationFactory\u00601..ctor()\r\n   at WinRT.ActivationFactory\u00601..cctor()\r\n\r\n   --- End of inner exception stack trace ---\r\n   at WinRT.ActivationFactory\u00601.ActivateInstance[I]()\r\n   at Microsoft.Windows.ApplicationModel.WindowsAppRuntime.DeploymentInitializeOptions..ctor()\r\n   at Microsoft.Windows.ApplicationModel.WindowsAppRuntime.DeploymentManagerCS.AutoInitialize.get_Options() in C:\\Users\\TommiGustafsson\\.nuget\\packages\\microsoft.windowsappsdk\\1.5.240311000\\include\\DeploymentManagerAutoInitializer.cs:line 44\r\n   at Microsoft.Windows.ApplicationModel.WindowsAppRuntime.DeploymentManagerCS.AutoInitialize.AccessWindowsAppSDK() in C:\\Users\\TommiGustafsson\\.nuget\\packages\\microsoft.windowsappsdk\\1.5.240311000\\include\\DeploymentManagerAutoInitializer.cs:line 30\r\n   at .cctor()\r\n\u003C/Data\u003E\r\n  \u003C/EventData\u003E\r\n\u003C/Event\u003E\n\u0060\u0060\u0060\n\n\n### Code of Conduct\n\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "janne-hmp",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2024-06-13T21:34:00",
  "updatedAt": "2024-06-21T14:16:48",
  "closedAt": "2024-06-21T14:03:31",
  "commentCount": 7,
  "reactionCount": 0
}