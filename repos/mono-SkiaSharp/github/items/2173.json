{
  "number": 2173,
  "type": "issue",
  "state": "closed",
  "title": "Skottie cannot draw animations that have embedded images",
  "body": "**Description**\r\n\r\nIf the Lottie json file contains embedded resources, such as an image as a data URI \u0060data:image/png;base64\u0060, then it just skips over it.\r\n\r\nThe reason for this is that Skottie uses a concept of a \u0060ResourceProvider\u0060 to decode images/fonts/audio. By default, it does not set up and providers. There are a few providers implemented, so we just have to expose those.\r\n\r\n[dotnet_bot.zip](https://github.com/mono/SkiaSharp/files/9123532/dotnet_bot.zip)\r\n",
  "author": {
    "login": "mattleibow",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-07-15T19:37:22",
  "updatedAt": "2024-07-12T20:40:45",
  "closedAt": "2024-02-18T15:33:25",
  "commentCount": 24,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T12:52:47.707611Z",
    "reactions": [],
    "comments": [
      {
        "id": 1265377433,
        "author": "ibebbs",
        "body": "Hey @mattleibow, any idea if/when support for embedded images might be implemented?\r\n\r\nLast I saw @jeromelaban had suggested he might have a further changeset pending for support of [ResourceProvider](https://github.com/google/skia/blob/1f193df9b393d50da39570dab77a0bb5d28ec8ef/modules/skresources/include/SkResources.h) / [AnimationBuilder](https://github.com/google/skia/blob/1f193df9b393d50da39570dab77a0bb5d28ec8ef/modules/skottie/src/SkottiePriv.h#L52) but there doesn\u0027t seem to have been any movement here.\r\n\r\nI\u0027ve taken a quick look at what it might take to implement this functionality but it seems even getting the toolchain setup to complete this work would take a while so kinda hoping someone else is halfway there already...",
        "createdAt": "2022-10-03T12:36:07",
        "reactions": []
      },
      {
        "id": 1265488771,
        "author": "jeromelaban",
        "body": "We haven\u0027t gone through the work of adding the APIs for that yet.",
        "createdAt": "2022-10-03T14:00:55",
        "reactions": []
      },
      {
        "id": 1265606166,
        "author": "ibebbs",
        "body": "Thanks for the reply @jeromelaban. Apologies I thought I saw you say there was another commit incoming but can\u0027t for the life of me find it now.\r\n\r\nIf I look to implement this, is there anything I should be particularly aware of? Currently I\u0027m mostly concerned about getting the toolchain to build the c\u002B\u002B library set up.",
        "createdAt": "2022-10-03T15:05:19",
        "reactions": []
      },
      {
        "id": 1265643215,
        "author": "jeromelaban",
        "body": "That\u0027s correct, I mentioned there would be an additional commit in the future to support these APIs, but that\u0027s pretty much it :)\r\n\r\nFor the C\u002B\u002B part, I\u0027m generally working in WSL or in a docker container in GitPod/CodeSpaces. It\u0027s generally pretty easy to work with there, but I know others are working directly from Windows.",
        "createdAt": "2022-10-03T15:28:51",
        "reactions": []
      },
      {
        "id": 1661967854,
        "author": "MarMarIV",
        "body": "Any progress on this feature?",
        "createdAt": "2023-08-02T10:34:59",
        "reactions": []
      },
      {
        "id": 1663759079,
        "author": "jerry2007",
        "body": "@mattleibow  Will you implememnt this feature?",
        "createdAt": "2023-08-03T10:46:15",
        "reactions": []
      },
      {
        "id": 1689268913,
        "author": "MarMarIV",
        "body": "@mattleibow Any progress? Or something?",
        "createdAt": "2023-08-23T04:37:45",
        "reactions": [
          {
            "user": "jerry2007",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:52:44.1823113Z"
          }
        ]
      },
      {
        "id": 1689618744,
        "author": "jerry2007",
        "body": "@mattleibow please, we really need for our app...",
        "createdAt": "2023-08-23T09:32:34",
        "reactions": []
      },
      {
        "id": 1730182929,
        "author": "mattleibow",
        "body": "Just adding some more info in case someone wants to start the work on this.\r\n\r\nThis is probably the API we need: https://github.com/google/skia/blob/chrome/m115/modules/skottie/include/Skottie.h#L121\r\n\r\nFor URI resources we will need this: https://github.com/google/skia/blob/chrome/m115/modules/skresources/include/SkResources.h#L250\r\nFor file folder images: https://github.com/google/skia/blob/chrome/m115/modules/skresources/include/SkResources.h#L201\r\n\r\nNot sure we will need any complicated implementations. All the code is in the module and we just need to expose.\r\n\r\nI see this is a new module and as I am not yet sure exactly how interconnected or if I can split this, the skresources module will also be a new nuget like we did with scenegraph and skottie.",
        "createdAt": "2023-09-21T19:33:41",
        "reactions": [
          {
            "user": "MarkIngramUK",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:52:44.5531481Z"
          },
          {
            "user": "RasmusOster",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:52:44.5531486Z"
          }
        ]
      },
      {
        "id": 1842880673,
        "author": "RasmusOster",
        "body": "Is this still being worked on? ",
        "createdAt": "2023-12-06T13:29:57",
        "reactions": []
      },
      {
        "id": 1843224815,
        "author": "MarkIngramUK",
        "body": "There are 2 open pull requests, I\u0027m not sure what is being waited on - are they just waiting for review?\r\nhttps://github.com/mono/skia/pull/114\r\nhttps://github.com/mono/SkiaSharp/pull/2630",
        "createdAt": "2023-12-06T16:17:10",
        "reactions": []
      },
      {
        "id": 1892542150,
        "author": "Jasbirbhinder",
        "body": "@mattleibow, i recently noticed skia package got a update. did JSON embedded image issue fixed in it?",
        "createdAt": "2024-01-15T17:16:11",
        "reactions": []
      },
      {
        "id": 1995934622,
        "author": "Jasbirbhinder",
        "body": "@mattleibow : thank you for the update. could you please let us know how to make it work for Skia to load embedded image. Im very new to Skia. Highly Appricated for all your help!!",
        "createdAt": "2024-03-13T21:55:44",
        "reactions": []
      },
      {
        "id": 2040614591,
        "author": "DonaldConsoleII",
        "body": "@mattleibow Is this bug fixed in any of the builds? If not, would you happen to have an ETA? Any update would be greatly appreciated!",
        "createdAt": "2024-04-05T20:55:59",
        "reactions": []
      },
      {
        "id": 2040910041,
        "author": "anton-yashin",
        "body": "\u003E @mattleibow Is this bug fixed in any of the builds? If not, would you happen to have an ETA? Any update would be greatly appreciated!\r\n\r\nhttps://github.com/mono/SkiaSharp/releases/tag/v3.0.0-preview.2.1 seems fine.",
        "createdAt": "2024-04-06T03:00:44",
        "reactions": []
      },
      {
        "id": 2051520828,
        "author": "Glomby",
        "body": "I\u2019ve been running into this issue this week too while converting an App from Xamarin to MAUI.\r\nI download all the newest previews for SkiaSharp, the Extended.UI.MAUI etc. but my .jsons with embedded images don\u2019t show anything. It seems like a fix is not live yet or is something else needed to make it work?",
        "createdAt": "2024-04-12T10:46:33",
        "reactions": []
      },
      {
        "id": 2051535724,
        "author": "MarMarIV",
        "body": "@mattleibow Thanks for this! \uD83D\uDC4D It works\r\n\r\n@Glomby My tip: Check MergedDictionaries in your app. SkiaSharp.Extended.UI.MAUI append style resources in that. I have same problem. In our application we clear merged dictionaties \u0027at startup\u0027 and that was a issue, missing resources",
        "createdAt": "2024-04-12T10:56:19",
        "reactions": []
      },
      {
        "id": 2053296553,
        "author": "Jasbirbhinder",
        "body": "@MarMarIV , could you please share screenshots to understand more about MergedDictionaires. i search in all folders and in project for MergedDictionaries but not found anything. thank you",
        "createdAt": "2024-04-13T03:56:11",
        "reactions": []
      },
      {
        "id": 2053544601,
        "author": "mattleibow",
        "body": "@Glomby just want to check, is anything rendering? Are the embedded images missing or is there just a blank space and nothing is drawn at all.\n\nThe embedded images fix is for SkiaSharp v3 and the lottie view is for v2. I forgot to think of this... Sorry.\n\nI might need to backport this for now since v3 is not yet ready to go stable.\n\nFor an interim, I will try make this work and you can just manually update skia to v3 and it will just light up. ",
        "createdAt": "2024-04-13T06:56:50",
        "reactions": []
      },
      {
        "id": 2053615834,
        "author": "ibebbs",
        "body": "@mattleibow - hadn\u0027t seen that the embedded images support was only in v3. If you do have time to back port it to v2 that would be super appreciated!",
        "createdAt": "2024-04-13T11:12:27",
        "reactions": []
      },
      {
        "id": 2053716785,
        "author": "Glomby",
        "body": "@mattleibow I was testing with a json that only has an image sequence so everything is blank but I just checked with a different one and only the images are missing in this one. The rest is displaying as expected. \r\n\r\nGetting this working would be super helpfull. Im porting a Xamarin App over to maui and we have lots of lotties with lots of images in them.",
        "createdAt": "2024-04-13T17:58:45",
        "reactions": []
      },
      {
        "id": 2141085476,
        "author": "Jasbirbhinder",
        "body": "@mattleibow , attached are screenshots and JSON file in this comment that i am using in my Maui project. embedded image still not loading!!\r\n\r\nthis is Maui code.\r\n    xmlns:skia=\u0022clr-namespace:SkiaSharp.Extended.UI.Controls;assembly=SkiaSharp.Extended.UI\u0022\r\n\r\n\u003Cskia:SKLottieView\r\n    BackgroundColor=\u0022Red\u0022\r\n    HeightRequest=\u0022100\u0022\r\n    RepeatCount=\u0022-1\u0022\r\n    Source=\u0022https://lottie.host/e6ca851f-5408-44f3-8874-637caebbf0d5/SlgPlLNWlZ.json\u0022\r\n    WidthRequest=\u0022100\u0022 /\u003E\r\n\r\n...These are the nuget installed.\r\n![1](https://github.com/mono/SkiaSharp/assets/5005201/5a282319-8aaa-4e56-ac50-b36fe639ccf4)\r\n\r\n...these is how it looks like in Maui app. missing image.\r\n![2](https://github.com/mono/SkiaSharp/assets/5005201/4cef9ddf-ba7c-46e7-ad89-807c367871a7)\r\n\r\n..this is the json with embedded image. it should load like this.\r\n![3](https://github.com/mono/SkiaSharp/assets/5005201/af04541f-a0b7-4c6b-9aa1-5f57fc9bbfd6)\r\n\r\n..this is the JSON file\r\n[blizzard.json](https://github.com/user-attachments/files/15507297/blizzard.json)\r\n",
        "createdAt": "2024-05-31T01:31:26",
        "reactions": [
          {
            "user": "Alexeiguch",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:52:47.2994426Z"
          },
          {
            "user": "HuyDangOL",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:52:47.2994431Z"
          }
        ]
      },
      {
        "id": 2150818668,
        "author": "Alexeiguch",
        "body": "@Jasbirbhinder same happens to me. All but the images are shown in the lottie animation.",
        "createdAt": "2024-06-05T19:37:34",
        "reactions": []
      },
      {
        "id": 2226323604,
        "author": "naimheshmati",
        "body": "I have same issue , is there any update for this bug ? the json file shows on web , but it\u0027s not working on MAUI project\r\n[fillup animation.json](https://github.com/user-attachments/files/16199131/fillup.animation.json)\r\n",
        "createdAt": "2024-07-12T20:40:43",
        "reactions": []
      }
    ]
  }
}