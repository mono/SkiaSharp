{
  "number": 422,
  "type": "issue",
  "state": "closed",
  "title": "XPS file doesn\u0027t release",
  "body": "I\u0027m trying to create an XPS file with this code:\r\n\r\n\u0060\u0060\u0060\r\nusing (var document = SKDocument.CreateXps(path \u002B \u0022test.xps\u0022))\r\n{\r\n     using (var c = document.BeginPage(800, 1000))\r\n     {\r\n          item.Draw(c);\r\n          document.EndPage();\r\n     }\r\n\r\n     document.Close();\r\n}\r\n\u0060\u0060\u0060\r\n\r\nBut test.xps file can\u0027t be open until the application is closed. The same code with CreatePdf method instead of CreateXps works.",
  "author": {
    "login": "jotab123",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    },
    {
      "name": "area/SkiaSharp",
      "color": "0052cc"
    }
  ],
  "assignees": [],
  "milestone": "1.60.0",
  "createdAt": "2018-01-03T16:07:50",
  "updatedAt": "2022-08-19T18:01:50",
  "closedAt": "2018-02-01T22:24:25",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T14:00:54.9575047Z",
    "reactions": [],
    "comments": [
      {
        "id": 362423941,
        "author": "mattleibow",
        "body": "Thanks for reporting this.\r\n\r\nI have fixed this. A workaround would be to pass a stream instead of a path:\r\n\r\n\u0060\u0060\u0060csharp\r\nusing (var stream = new SKManagedWStream (File.OpenWrite (path \u002B \u0022test.xps\u0022), true))\r\nusing (var document = CreateXps (stream))\r\n{\r\n    // ...\r\n}\r\n\u0060\u0060\u0060\r\n\r\n_NOTE: the \u0060true\u0060 parameter tells the \u0060SKManagedWStream\u0060 to close the managed \u0060Stream\u0060 so you don\u0027t have to close both._",
        "createdAt": "2018-02-01T22:30:13",
        "reactions": []
      }
    ]
  }
}