{
  "number": 2824,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] Annoying warning on .NET Framework 4.8 project with SkiaSharp 2.88.6 or 2.88.7",
  "body": "### Description\n\nCreated a WPF project targeting .NET Framework 4.8 with no additional code, only nuget references to SkiaSharp 2.88.6 and also when upgrading this to 2.88.7\r\n\r\nAt first this builds without any errors but if you then save the project and reopen it later the following warning starts appearing in the Error List:\r\n\r\nSeverity\tCode\tDescription\tProject\tFile\tLine\tSuppression State\tDetails\r\nWarning\t\tThe referenced component \u0027C:\\Users\\[*****]\\packages\\SkiaSharp.NativeAssets.macOS.2.88.7\\build\\net462\\..\\..\\runtimes\\osx\\native\\libSkiaSharp.dylib\u0027 could not be found.\tFoo\t\t\t\t\r\n\r\nCan something be done about this, please?\r\n\r\n\r\nAdditional information: Version 2.88.7 of SkiaSharp is presented as \u0022Latest stable\u0022 in nuget. Also, we don\u0027t even use SkiaSharp ourselves; this is included in our project after installing a 3rd party nuget package which depends on SkiaSharp 2.88.6 ... However, even after removing the 3rd party software and leaving only SkiaSharp and its dependencies, the warning persists.\n\n### Code\n\nThe best way to share code for larger projects is a link to a GitHub repository: https://github.com/user/repo/tree/bug-123\r\n\r\nBut, you can also share a short block of code here:\r\n\u0060\u0060\u0060cs\r\n// some C# code here\r\n\u0060\u0060\u0060\r\nYou can also share some XAML:\r\n\u0060\u0060\u0060xaml\r\n\u003C!-- xaml code here --\u003E\r\n\u0060\u0060\u0060\r\n\n\n### Expected Behavior\n\nProject should simply build without any warnings.\n\n### Actual Behavior\n\nWarning is shown.\n\n### Version of SkiaSharp\n\n2.88.3 (Current)\n\n### Last Known Good Version of SkiaSharp\n\n2.88.2 (Previous)\n\n### IDE / Editor\n\nVisual Studio (Windows)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\nWindows\n\n### Devices\n\nLaptop\n\n### Relevant Screenshots\n\n![image](https://github.com/mono/SkiaSharp/assets/223879/035d6f78-fa0a-448e-b0c7-f9e11e5f615d)\r\n\n\n### Relevant Log Output\n\n_No response_\n\n### Code of Conduct\n\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "rozeboosje",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2024-04-08T08:35:44",
  "updatedAt": "2025-03-07T03:37:17",
  "closedAt": "2024-05-13T12:03:07",
  "commentCount": 18,
  "reactionCount": 2,
  "engagement": {
    "syncedAt": "2026-02-06T12:46:28.8620227Z",
    "reactions": [
      {
        "user": "angelofb",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:46:28.8620278Z"
      },
      {
        "user": "carl-di-ortus",
        "content": "\u002B1",
        "createdAt": "2026-02-06T12:46:28.8620281Z"
      }
    ],
    "comments": [
      {
        "id": 2051680695,
        "author": "lbras",
        "body": "I get this as well. It has been around for a while #2223. Using VS2019 16.11.35.",
        "createdAt": "2024-04-12T12:36:44",
        "reactions": []
      },
      {
        "id": 2056480392,
        "author": "rozeboosje",
        "body": "It\u0027s, at the very least, annoying. But it also leaves me wondering what I need to distribute in order to ensure that the software works without issues.\r\n\r\nPlease address this.",
        "createdAt": "2024-04-15T10:24:24",
        "reactions": []
      },
      {
        "id": 2059291023,
        "author": "rozeboosje",
        "body": "Any chance of a response from the Team? Even merely an acknowledgement that the issue has been noted and understood?",
        "createdAt": "2024-04-16T14:53:31",
        "reactions": []
      },
      {
        "id": 2063745346,
        "author": "rozeboosje",
        "body": "Issue still persists in the nuget packages for skiasharp 2.88.8",
        "createdAt": "2024-04-18T12:25:17",
        "reactions": []
      },
      {
        "id": 2074343431,
        "author": "mattleibow",
        "body": "This is the code that is importing the native reference:\r\n\r\nhttps://github.com/mono/SkiaSharp/blob/release/2.x/binding/SkiaSharp/nuget/build/net462/SkiaSharp.targets#L11-L16\r\n\r\nIt has a condition that is not ever true on Windows, VS for Windows or WPF. Yet somehow the IDE is seeing it.\r\n\r\nIt does seem to only happen in the classic projects, so a workaround may be to upgrade to the SDK-style projects.",
        "createdAt": "2024-04-24T08:10:41",
        "reactions": []
      },
      {
        "id": 2074357367,
        "author": "rozeboosje",
        "body": "Sorry can you explain what you mean by \u0022classic\u0022 and \u0022SDK-style\u0022 projects?\r\n\r\nWe are using a product called Aspose.Words in a Solution with 84 projects in it. That product has now been changed to include references to SkiaSharp and that\u0027s how the nuget packages for SkiaSharp ended up pulled into our Solution. I am not sure that we can justify the amount of work involved in the workaround...",
        "createdAt": "2024-04-24T08:17:33",
        "reactions": []
      },
      {
        "id": 2074360131,
        "author": "mattleibow",
        "body": "This appears to be a IDE warning, and not a compile warning. So the IDE is doing this all on its own and we have no way to control it. It should not be happening as there is a condition around it that is false. Looking at a binlog, this warning does not exist - and it does not have a code either so we cannot ignore or even do anything.\r\n\r\n",
        "createdAt": "2024-04-24T08:18:36",
        "reactions": []
      },
      {
        "id": 2074368469,
        "author": "mattleibow",
        "body": "SDK style projects are the new way to write csproj: https://learn.microsoft.com/en-us/dotnet/core/project-sdk/overview\r\n\r\nFor example, a File | New project will look like this:\r\n\r\n\u0060\u0060\u0060xml\r\n\u003CProject Sdk=\u0022Microsoft.NET.Sdk\u0022\u003E\r\n\r\n\t\u003CPropertyGroup\u003E\r\n\t\t\u003COutputType\u003EWinExe\u003C/OutputType\u003E\r\n\t\t\u003CTargetFramework\u003Enet48\u003C/TargetFramework\u003E\r\n\t\t\u003CUseWPF\u003Etrue\u003C/UseWPF\u003E\r\n\t\u003C/PropertyGroup\u003E\r\n\r\n\u003C/Project\u003E\r\n\u0060\u0060\u0060\r\n\r\nAll the clutter has been removed.",
        "createdAt": "2024-04-24T08:20:23",
        "reactions": []
      },
      {
        "id": 2074380335,
        "author": "mattleibow",
        "body": "You can also easily update from the old projects to the new project with the .net upgrade assistant: https://dotnet.microsoft.com/en-us/platform/upgrade-assistant\r\n\r\nThis will not actually upgrade anything with your app, just the csproj format.\r\n\r\nRunning a test now to confirm...",
        "createdAt": "2024-04-24T08:26:14",
        "reactions": []
      },
      {
        "id": 2074383681,
        "author": "rozeboosje",
        "body": "Okay but this is a years old solution and we\u0027re stuck in .NET Framework 4.8 world so a move to .NET Core is not going to happen any time soon.\r\n\r\nI had a look at the code you posted, though ... and I think I can see what the problem is.\r\n\r\n\u0026lt;ShouldIncludeNativeSkiaSharp Condition=\u0022 \u0027$(ShouldIncludeNativeSkiaSharp)\u0027 == \u0027\u0027 \u0022\u0026gt;True\u0026lt;/ShouldIncludeNativeSkiaSharp\u0026gt;\r\n\r\nSo there is a condition under which the value is set to True, but there is no condition under which the value is set to False, so as far as I can tell from the code snippet, the value could be anything: \u0027\u0027, \u0027george\u0027, \u0027something\u0027 or even null. \r\n\r\nSimilarly, the  _AppIsFullMac value is set on the basis of various values != to some values, and again, I bet those values are not the \u0022opposites\u0022 you\u0027re expecting them to be.\r\n",
        "createdAt": "2024-04-24T08:27:56",
        "reactions": []
      },
      {
        "id": 2074393349,
        "author": "mattleibow",
        "body": "The condition is working as the second part \u0060\u0060\u0027$(_AppIsFullMac)\u0027 == \u0027True\u0027 is false. When running a build, there is no warning and there is also all the cases where the checks are running and there are no native references:\r\n\r\n![image](https://github.com/mono/SkiaSharp/assets/1096616/850294b7-72f9-4069-9226-d0438d023e12)\r\n\r\nAlso, switching to SDK-style projects does not mean switching to .net core, you can just convert the xml to the modern format, and keep the same net46/net47/net48 that you already have - and you can mix it up as well.\r\n\r\nBut again, this is not a build issue - just the IDE/solution explorer bug.",
        "createdAt": "2024-04-24T08:32:42",
        "reactions": []
      },
      {
        "id": 2074399199,
        "author": "rozeboosje",
        "body": "Okay but it pollutes our \u0022Error list\u0022 with spurious warnings. We are not in the habit of ignoring warnings as we\u0027ve been bitten a few times before when an ignored warning led to an actual problem. With all these warnings cluttering the Error List we\u0027re risking missing one that DOES require our attention. If it\u0027s an IDE bug, where can I report that and ask the makers of Visual Studio to address it?",
        "createdAt": "2024-04-24T08:35:31",
        "reactions": []
      },
      {
        "id": 2074401327,
        "author": "mattleibow",
        "body": "I even wrapped the whole \u0060\u003CNativeReference\u003E\u0060 item in a \u0060\u003CItemGroup Condition=\u0022 \u0027cat\u0027 == \u0027dog\u0027 \u0022\u003E\u0060 and the IDE still sees it.\r\n\r\nYou can use the VS feedback in the help menu or the \r\n![image](https://github.com/mono/SkiaSharp/assets/1096616/81ed0b55-f3db-4532-9e5d-c3f80bef1e67)\r\n\r\n\r\nI will try replicate this in a simple project for you to add a code snippet.",
        "createdAt": "2024-04-24T08:36:32",
        "reactions": []
      },
      {
        "id": 2074409319,
        "author": "mattleibow",
        "body": "Managed to reproduce this with the simplest thing:\r\n\r\n\u0060\u0060\u0060xml\r\n\u003CItemGroup Condition=\u0022 \u0027dog\u0027 == \u0027cat\u0027 \u0022\u003E\r\n  \u003CNativeReference Include=\u0022BadFile.dylib\u0022 /\u003E\r\n\u003C/ItemGroup\u003E\r\n\u0060\u0060\u0060\r\n\r\nAdd that near the end of your csproj and the warning will appear. The condition directly excludes this, yet it is still there in the IDE.",
        "createdAt": "2024-04-24T08:40:33",
        "reactions": []
      },
      {
        "id": 2074416140,
        "author": "mattleibow",
        "body": "I think I found a hack to fix it:\r\n\r\n\u0060\u0060\u0060xml\r\n\u003CItemGroup Condition=\u0022 \u0027dog\u0027 == \u0027cat\u0027 \u0022\u003E\r\n  \u003CNativeReference Include=\u0022BadFile.dylib\u0022 /\u003E\r\n\u003C/ItemGroup\u003E\r\n\u003CItemGroup Condition=\u0022 \u0027dog\u0027 != \u0027cat\u0027 \u0022\u003E\r\n  \u003CNativeReference Remove=\u0022BadFile.dylib\u0022 /\u003E\r\n\u003C/ItemGroup\u003E\r\n\u0060\u0060\u0060\r\n\r\nThis is all sorts of wrong, but the IDE seems happier.",
        "createdAt": "2024-04-24T08:44:03",
        "reactions": [
          {
            "user": "rozeboosje",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:46:28.1855857Z"
          },
          {
            "user": "lbras",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:46:28.1855863Z"
          }
        ]
      },
      {
        "id": 2074427983,
        "author": "mattleibow",
        "body": "Let\u0027s see.",
        "createdAt": "2024-04-24T08:49:53",
        "reactions": []
      },
      {
        "id": 2074515040,
        "author": "rozeboosje",
        "body": "Thank you so much for putting effort into this",
        "createdAt": "2024-04-24T09:31:11",
        "reactions": []
      },
      {
        "id": 2705453443,
        "author": "vssaini",
        "body": "@rozeboosje @mattleibow \n\nI\u0027m using VS 2022 and have an ASP.NET 4.8-based MVC project. I\u0027m trying to get rid of similar warnings using the approach mentioned in https://github.com/mono/SkiaSharp/issues/2824#issuecomment-2074416140.\n\n\u0060\u0060\u0060\n\u003C?xml version=\u00221.0\u0022 encoding=\u0022utf-8\u0022?\u003E\n\u003CProject ToolsVersion=\u002215.0\u0022 DefaultTargets=\u0022Build\u0022 xmlns=\u0022http://schemas.microsoft.com/developer/msbuild/2003\u0022\u003E\n  \u003C!--Other elements removed for brevity --\u003E\n  \u003CItemGroup\u003E\n    \u003C!-- Remove the unwanted native references unconditionally --\u003E\n    \u003CNativeReference Remove=\u0022libHarfBuzzSharp.dylib\u0022 /\u003E\n    \u003CNativeReference Remove=\u0022libSkiaSharp.dylib\u0022 /\u003E\n  \u003C/ItemGroup\u003E\n\u003C/Project\u003E\n\u0060\u0060\u0060\n\nBut I still see the warnings as\n\n\u003E The referenced component \u0027C:\\Users\\Vic\\.nuget\\packages\\harfbuzzsharp.nativeassets.macos\\7.3.0\\buildTransitive\\net462\\..\\..\\runtimes\\osx\\native\\libHarfBuzzSharp.dylib\u0027 could not be found.\n\n\u003E The referenced component \u0027C:\\Users\\Vic\\.nuget\\packages\\skiasharp.nativeassets.macos\\2.88.8\\buildTransitive\\net462\\..\\..\\runtimes\\osx\\native\\libSkiaSharp.dylib\u0027 could not be found.\n\n@rozeboosje, can you please help me get rid of these warnings?",
        "createdAt": "2025-03-07T03:37:16",
        "reactions": []
      }
    ]
  }
}