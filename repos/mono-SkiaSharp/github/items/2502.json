{
  "number": 2502,
  "type": "issue",
  "state": "open",
  "title": "[BUG] SkiaSharp not working when running local Azure Function (.NET 6.0) in macOS",
  "body": "**Description**\r\n\r\nWe are using SkiaSharp in Azure Function. When running local Azure Function (.NET 6.0) in Windows OS, SkiaSharp works fine without any issue. But when we are running local Azure Function (.NET 6.0) in macOS, we are facing libSkiaSharp assembly not found issue.\r\n\r\n**Code**\r\n\r\n\u0060\u0060\u0060\r\nusing System;\r\nusing System.IO;\r\nusing System.Threading.Tasks;\r\nusing Microsoft.AspNetCore.Mvc;\r\nusing Microsoft.Azure.WebJobs;\r\nusing Microsoft.Azure.WebJobs.Extensions.Http;\r\nusing Microsoft.AspNetCore.Http;\r\nusing Microsoft.Extensions.Logging;\r\nusing Newtonsoft.Json;\r\nusing SkiaSharp;\r\n\r\nnamespace AzureFunction\r\n{\r\n    public static class AzureFunction\r\n    {\r\n        [FunctionName(\u0022AzureFunction\u0022)]\r\n        public static async Task\u003CIActionResult\u003E Run(\r\n            [HttpTrigger(AuthorizationLevel.Anonymous, \u0022get\u0022, \u0022post\u0022, Route = null)] HttpRequest req,\r\n            ILogger log)\r\n        {\r\n            log.LogInformation(\u0022C# HTTP trigger function processed a request.\u0022);\r\n\r\n            string name = req.Query[\u0022name\u0022];\r\n\r\n            string requestBody = await new StreamReader(req.Body).ReadToEndAsync();\r\n            dynamic data = JsonConvert.DeserializeObject(requestBody);\r\n            name = name ?? data?.name;\r\n\r\n\r\n            //Get the text to draw.\r\n            string drawText = \u0022Hello\u0022;\r\n            //Create sKImageInfo object\r\n            SKImageInfo sKImageInfo = new SKImageInfo(612, 792);\r\n            SKSurface sKSurface = SKSurface.Create(sKImageInfo);\r\n            SKCanvas canvas = sKSurface.Canvas;\r\n            //Create font.\u00A0\r\n            SKTypeface sKTypeface = SKTypeface.FromFamilyName(\u0022Calibri Light\u0022, SKFontStyle.Bold);\r\n            SKPaint paint = new SKPaint();\r\n            paint.TextSize = 11f;\r\n            paint.Typeface = sKTypeface;\r\n            canvas.DrawText(drawText, 0, 0, paint);\r\n\r\n\r\n            string responseMessage = string.IsNullOrEmpty(name)\r\n                ? \u0022This HTTP triggered function executed successfully. Pass a name in the query string or in the request body for a personalized response.\u0022\r\n                : $\u0022Hello, {name}. This HTTP triggered function executed successfully.\u0022;\r\n\r\n            return new OkObjectResult(responseMessage);\r\n        }\r\n    }\r\n}\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nSkiaSharp should work properly when running local Azure Function (.NET 6.0) in macOS.\r\n\r\n**Actual Behavior**\r\n\r\nThe following error is faced.\r\n\r\n[2023-06-21T19:36:57.170Z] System.Private.CoreLib: Exception while executing function: AzureFunction. SkiaSharp: The type initializer for \u0027SkiaSharp.SKImageInfo\u0027 threw an exception. SkiaSharp: Unable to load shared library \u0027libSkiaSharp\u0027 or one of its dependencies. In order to help diagnose loading problems, consider setting the DYLD_PRINT_LIBRARIES environment variable: dlopen(liblibSkiaSharp, 0x0001): tried: \u0027liblibSkiaSharp\u0027 (no such file), \u0027/System/Volumes/Preboot/Cryptexes/OSliblibSkiaSharp\u0027 (no such file), \u0027/usr/lib/liblibSkiaSharp\u0027 (no such file, not in dyld cache), \u0027liblibSkiaSharp\u0027 (no such file), \u0027/usr/local/lib/liblibSkiaSharp\u0027 (no such file), \u0027/usr/lib/liblibSkiaSharp\u0027 (no such file, not in dyld cache).\r\n\r\n**Basic Information**\r\n\r\n- Version with issue: **2.88.4-preview.76**\r\n- IDE: **Visual Studio 2022 for Mac Preview (17.6)**\r\n- Platform: **Azure Function**\r\n- Target Frameworks: **.NET 6.0**\r\n- Initial Template: **Http trigger**\r\n- macOS Ventura Version: **13.2**\r\n- Mac mini (Apple M1 chip)\r\n\r\n**Reproduction Link**\r\n\r\nAttached Azure Function sample, \r\n[AzureFunction.zip](https://github.com/mono/SkiaSharp/files/11824555/AzureFunction.zip)\r\n\r\n**Reference link for how to create and run Azure Function in macOS**\r\n\r\nhttps://learn.microsoft.com/en-us/visualstudio/mac/azure-functions?view=vsmac-2022",
  "author": {
    "login": "SuriyaBalamurugan",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2023-06-21T20:22:57",
  "updatedAt": "2023-06-22T11:18:56",
  "commentCount": 1,
  "reactionCount": 1
}