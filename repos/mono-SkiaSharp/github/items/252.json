{
  "number": 252,
  "type": "issue",
  "state": "closed",
  "title": "Vulkan GPU backend",
  "body": "Does SkiaSharp support the [Vulkan GPU Backend](https://skia.org/user/special/vulkan)?  If not, any plans to add it?  I\u0027m working on a Vulkan app and am looking for a 2D solution for the UI.\r\n\r\n**Current PRs**\r\n - native: https://github.com/mono/skia/pull/69\r\n - managed: #1010\r\n\r\n\u003E VS bug [#727962](https://devdiv.visualstudio.com/DevDiv/_workitems/edit/727962)",
  "author": {
    "login": "jcoder58",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/enhancement",
      "color": "84b6eb"
    },
    {
      "name": "status/help-wanted",
      "color": "B8EC4A"
    },
    {
      "name": "type/feature-request",
      "color": "ededed"
    }
  ],
  "assignees": [
    {
      "login": "mattleibow",
      "type": "User"
    }
  ],
  "milestone": "v2.80.0",
  "createdAt": "2017-02-17T17:39:17",
  "updatedAt": "2022-08-19T21:02:30",
  "closedAt": "2020-05-16T01:16:47",
  "commentCount": 35,
  "reactionCount": 23,
  "engagement": {
    "syncedAt": "2026-02-06T13:56:31.8851518Z",
    "reactions": [
      {
        "user": "FoggyFinder",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851551Z"
      },
      {
        "user": "MarchingCube",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851559Z"
      },
      {
        "user": "tuccio",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851561Z"
      },
      {
        "user": "OndrejRitomsky",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851564Z"
      },
      {
        "user": "jmacato",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851566Z"
      },
      {
        "user": "kekekeks",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851567Z"
      },
      {
        "user": "pr8x",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851569Z"
      },
      {
        "user": "wieslawsoltes",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.885157Z"
      },
      {
        "user": "wieslawsoltes",
        "content": "hooray",
        "createdAt": "2026-02-06T13:56:31.8851571Z"
      },
      {
        "user": "wieslawsoltes",
        "content": "heart",
        "createdAt": "2026-02-06T13:56:31.8851573Z"
      },
      {
        "user": "wieslawsoltes",
        "content": "rocket",
        "createdAt": "2026-02-06T13:56:31.8851574Z"
      },
      {
        "user": "Michron",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851575Z"
      },
      {
        "user": "HyDr0x",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851577Z"
      },
      {
        "user": "HyDr0x",
        "content": "hooray",
        "createdAt": "2026-02-06T13:56:31.8851578Z"
      },
      {
        "user": "MonkAlex",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851579Z"
      },
      {
        "user": "pinki",
        "content": "hooray",
        "createdAt": "2026-02-06T13:56:31.885158Z"
      },
      {
        "user": "ahopper",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851581Z"
      },
      {
        "user": "mgnslndh",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851583Z"
      },
      {
        "user": "mattleibow",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851584Z"
      },
      {
        "user": "Sorien",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851585Z"
      },
      {
        "user": "BradChase2011",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851586Z"
      },
      {
        "user": "JoAlli",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851587Z"
      },
      {
        "user": "dmsch",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:56:31.8851588Z"
      }
    ],
    "comments": [
      {
        "id": 280816981,
        "author": "mattleibow",
        "body": "Most certainly we are going to be adding this. At this time no-one has asked, so we never got around to it, but it should be relatively simple to add. It just needs the few setup types, and then that gets handed over the the \u0060GRContext\u0060 to continue as normal.\r\n\r\nFeel free to have a go and send a PR :)",
        "createdAt": "2017-02-18T03:04:39",
        "reactions": []
      },
      {
        "id": 280848191,
        "author": "jcoder58",
        "body": "\u003EFeel free to have a go and send a PR :)\r\n\r\nI\u0027ll take a look at it.  Is there anyway to build just the Desktop?  ",
        "createdAt": "2017-02-18T14:15:30",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "hooray",
            "createdAt": "2026-02-06T13:56:25.0347326Z"
          },
          {
            "user": "Kavignon",
            "content": "hooray",
            "createdAt": "2026-02-06T13:56:25.0347329Z"
          }
        ]
      },
      {
        "id": 280853949,
        "author": "mattleibow",
        "body": "I usually just build \u0060externals-windows\u0060 on Windows and \u0060externals-osx\u0060 on macOS. This is the native bits, and then you can use the unit test projects to test. If you want to run a UI with it, you can use the samples. Just uninstall the SkiaSharp NuGet and add the project references.\r\n\r\nThe samples use NuGets because they are aimed at people just downloading and running the samples. For dev, I use the \u0060WindowsSample\u0060 or the \u0060MacSample\u0060. You should just need to add the \u0060/binding/Binding/Binding.shproj\u0060 and the \u0060/binding/SkiaSharp.[Desktop/OSX]/*.csproj\u0060\r\n\r\nIf you are using Linux, then there is just the one x64 platform and libs.\r\n\r\nLooking forward to seeing what you are doing.",
        "createdAt": "2017-02-18T15:51:31",
        "reactions": []
      },
      {
        "id": 280860646,
        "author": "jcoder58",
        "body": "Tried running WindowsSample and am getting:\r\n    \r\n    Unable to load DLL \u0027libSkiaSharp.dll\u0027: The specified module could not be found. (Exception from HRESULT: 0x8007007E)\r\n\r\nlibSkiaSharp.dll is installed in the x86/x64 folders.  I have Microsoft Visual C\u002B\u002B 2015 Redistributable installed  (reinstalled it to make sure it was the latest).  \r\n\r\nAlso, the link to the Microsoft Visual C\u002B\u002B 2015 Redistributable in the readme is broken.",
        "createdAt": "2017-02-18T17:27:42",
        "reactions": []
      },
      {
        "id": 280864186,
        "author": "mattleibow",
        "body": "@jcoder58 libSkiaSharp mush be in the same directory as the SkiaSharp.dll. Are you building as x86 or x64? AnyCPU _should_ be working now, but maybe not. Are you using the WindowsSample, but with the project references? Also, make sure you uninstall the SkiaSharp NuGets - or at least delete the SkiaSharp.dll reference from the NuGet.",
        "createdAt": "2017-02-18T18:13:50",
        "reactions": []
      },
      {
        "id": 280864786,
        "author": "mattleibow",
        "body": "@jcoder58, If you are still working, we can chat on https://gitter.im/xamarin/XamarinComponents and get you started.",
        "createdAt": "2017-02-18T18:23:08",
        "reactions": []
      },
      {
        "id": 280928126,
        "author": "jcoder58",
        "body": "Well, that didn\u0027t go far.  Skia doesn\u0027t have the Vulkan backend in the C API :(.  ",
        "createdAt": "2017-02-19T15:58:26",
        "reactions": []
      },
      {
        "id": 280940165,
        "author": "mattleibow",
        "body": "That is what I am doing with SkiaSharp... the C API. And then the C# API on that.\r\n\r\nYou could have a stab at that, it is not too tough once you get the hang of it. I basically just have a C method that calls the real C\u002B\u002B method.  You can just do what is needed, and then clean up later.\r\n\r\n",
        "createdAt": "2017-02-19T19:01:53",
        "reactions": []
      },
      {
        "id": 351038159,
        "author": "Kavignon",
        "body": "What\u0027s the current state of this and what\u0027s missing for C# ?\r\n",
        "createdAt": "2017-12-12T12:32:13",
        "reactions": []
      },
      {
        "id": 444175183,
        "author": "mattleibow",
        "body": "This is something that we will be looking at in the future.",
        "createdAt": "2018-12-04T17:00:10",
        "reactions": []
      },
      {
        "id": 506758557,
        "author": "MarchingCube",
        "body": "For people still waiting for this: we are starting to merge back our changes via https://github.com/mono/SkiaSharp/pull/897.",
        "createdAt": "2019-06-28T14:40:16",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "hooray",
            "createdAt": "2026-02-06T13:56:26.8728955Z"
          },
          {
            "user": "mattleibow",
            "content": "heart",
            "createdAt": "2026-02-06T13:56:26.8728958Z"
          }
        ]
      },
      {
        "id": 549074800,
        "author": "BradChase2011",
        "body": "Whats the current status on this?  I would love to do some testing and see what type of performance I get on our Vulkan rendering.",
        "createdAt": "2019-11-02T19:44:42",
        "reactions": [
          {
            "user": "rick-de-water",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:27.0839241Z"
          },
          {
            "user": "gregsn",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:27.0839244Z"
          }
        ]
      },
      {
        "id": 553325548,
        "author": "MarchingCube",
        "body": "@BradChase2011 Unfortunately our PR got stuck in the review process and we can\u0027t do much about it since it is us waiting for feedback. For us that means we have to keep a fork running and merge manually. Internally we are using SkiaSharp with Vulkan from several months without issues.",
        "createdAt": "2019-11-13T09:51:17",
        "reactions": [
          {
            "user": "FoggyFinder",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:27.2671392Z"
          },
          {
            "user": "mattleibow",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:27.2671395Z"
          },
          {
            "user": "BradChase2011",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:27.2671396Z"
          }
        ]
      },
      {
        "id": 553969891,
        "author": "mattleibow",
        "body": "That is my fault. Since there weren\u0027t that many votes/requests for Vulkan, it sort of slid down the list. I do still want to merge this. @MarchingCube what platforms are you using Vulkan on?",
        "createdAt": "2019-11-14T16:35:45",
        "reactions": []
      },
      {
        "id": 553983326,
        "author": "MarchingCube",
        "body": "We are running on windows exclusively at the moment. I think our test can be adopted to run on other OSes.",
        "createdAt": "2019-11-14T17:05:19",
        "reactions": []
      },
      {
        "id": 554122277,
        "author": "mattleibow",
        "body": "@MarchingCube OK. I merged the PRs into \u0022official\u0022 branches that I will keep up to date. I made some comments that I think we would want before we merge: #1010 and https://github.com/mono/skia/pull/69. I want to get this in, but my humanity is holding me back \uD83D\uDE09 We will accept PRs to the dev/vulkan branch, and I will keep it up to date. So, you should be able use the branches with minimal work.\r\n\r\nIt is not the best answer of \u0022merged\u0022, but until we get more of the API bound, I think we need a little longer.\r\n\r\nTo get more time allocated to this section of the API, you might need a few more \uD83D\uDC4D. Share this issue with friends and family and then I can take it up the ladder of priority.",
        "createdAt": "2019-11-14T22:57:45",
        "reactions": []
      },
      {
        "id": 554635913,
        "author": "MarchingCube",
        "body": "@mattleibow Thanks for the update, we already switched internally to use that branch (it already makes our life easier so thanks for that). About getting more API bound - I guess others might need to chime in with their requests since for us it already covers 100% of what we need at the moment.\r\n\r\nI guess biggest factor will be actually testing with other OSes and checking if current API covers it.\r\n\r\nAlso the issue got a bit more publicity now (no.3 top upvoted issue) \uD83D\uDE04",
        "createdAt": "2019-11-16T13:09:09",
        "reactions": []
      },
      {
        "id": 554663389,
        "author": "BradChase2011",
        "body": "@mattleibow @MarchingCube Sorry for the late response guys, had other pressing matters.  I have to wrap up some code, but hopefully I can test this on windows and droid (and AndroidTV) early/mid next week.  Thanks a ton for the work!  Cant wait to test!",
        "createdAt": "2019-11-16T18:43:33",
        "reactions": []
      },
      {
        "id": 554672730,
        "author": "mattleibow",
        "body": "@MarchingCube I see you got the family involved \uD83D\uDE1C Rather than actual features, I am concerned that the API has changed a fair bit from now to the current head: https://github.com/google/skia/tree/master/include/gpu/vk\r\n\r\nEven the \u0060VkInterface\u0060 is gone, so it might be useful to see what they are doing now, and then make this API work like that - even if we have to do a bit of extra work in managed layer for now. This way, we can avoid a breaking change when people update.",
        "createdAt": "2019-11-16T20:45:01",
        "reactions": [
          {
            "user": "Gillibald",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:28.5026989Z"
          },
          {
            "user": "WorkingRobot",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:56:28.5026992Z"
          }
        ]
      },
      {
        "id": 622944897,
        "author": "mattleibow",
        "body": "Rebased the PRs on the later m80 codebase. We can now work from there.",
        "createdAt": "2020-05-02T12:17:57",
        "reactions": []
      },
      {
        "id": 627297932,
        "author": "mattleibow",
        "body": "This has been pushed to the preview feed for initial testing:\r\n - feed: https://aka.ms/skiasharp-eap/index.json\r\n - version: **2.80.0-pr.1010.14**\r\n - packages: **SkiaSharp** and **SkiaSharp.Vulkan.SharpVk**",
        "createdAt": "2020-05-12T11:58:16",
        "reactions": []
      },
      {
        "id": 628213150,
        "author": "BradChase2011",
        "body": "@mattleibow I tried to use this, but SharpVk has a bug in their Droid version where it cant get a surface.   I posted the fix for me on his issues page https://github.com/FacticiusVir/SharpVk/issues/55. I run a modified version of his wrapper to be able to run on Droid.  So what is the best way to be able to build the vulkan version of this using my SharpVk fork?",
        "createdAt": "2020-05-13T19:57:49",
        "reactions": []
      },
      {
        "id": 628308104,
        "author": "mattleibow",
        "body": "@BradChase2011 at this point, this PR only builds skia with Vulkan support for Win32.\n\nTo build an Android skia with Vulkan, you will have to change the property in the native/android/build.cake. And then build the new native library.\n\nI\u0027ll have a look at this soon an see what breaks. Or, you can try by opening a PR to change that property. I think it is skia_uses_vulkan or something.\n",
        "createdAt": "2020-05-14T00:02:02",
        "reactions": []
      },
      {
        "id": 628312352,
        "author": "mattleibow",
        "body": "Interesting... seems to build for android just fine so far... I thought this was just for Android N\u002B and I was thinking I had to do something... Hmmm. \r\n\r\nI\u0027ll create a new PR and then you can try that.",
        "createdAt": "2020-05-14T00:16:38",
        "reactions": []
      },
      {
        "id": 628316804,
        "author": "mattleibow",
        "body": "Added this PR that will build for Android and Linux: https://github.com/mono/SkiaSharp/pull/1287\r\n\r\nFingers crossed it Just Works \u2122\uFE0F ",
        "createdAt": "2020-05-14T00:32:16",
        "reactions": []
      },
      {
        "id": 629536268,
        "author": "mattleibow",
        "body": "@BradChase2011 I just pushed out the Android/Linux PR as a NuGet to the preview feed as **2.80.0-pr.1287.3**",
        "createdAt": "2020-05-15T22:42:01",
        "reactions": []
      },
      {
        "id": 629567288,
        "author": "mattleibow",
        "body": "I hacked a few things and is seems to at least create a \u0060GRContext\u0060 on Android. I tested with a modified version of https://github.com/discosultan/VulkanCore.",
        "createdAt": "2020-05-16T01:16:02",
        "reactions": []
      },
      {
        "id": 629567383,
        "author": "mattleibow",
        "body": "Closing this now as all the supported platforms (Win32, Linux, Android) are building.",
        "createdAt": "2020-05-16T01:16:47",
        "reactions": [
          {
            "user": "garrynewman",
            "content": "heart",
            "createdAt": "2026-02-06T13:56:30.4140425Z"
          }
        ]
      },
      {
        "id": 630406325,
        "author": "BradChase2011",
        "body": "Awesome, thanks much!  Ill give it another shot here as soon as I get a chance to jump back into playing with libraries.  As far as I know SharpVk was the only wrapper I could find that has the latest bindings for Vulkan 1.2, it seems all the others stopped being updated on earlier versions.",
        "createdAt": "2020-05-18T20:03:09",
        "reactions": []
      },
      {
        "id": 638178780,
        "author": "garrynewman",
        "body": "I\u0027ve been trying to get this to work for a couple of days but I\u0027m failing. Is there an example of rendering to the backbuffer? The c\u002B\u002B examples I\u0027ve found seem to create a texture to render to rather than going straight at the screen.\r\n\r\nShould we be doing SKSurface.CreateAsRenderTarget or SKSurface.Create? Should we be manually filling out a GRVkImageInfo? Which properties need to be filled in? Is GRVkImageInfo.Alloc needed if you\u0027re attaching to an existing texture?\r\n\r\nEverything I try seems to end up with SKSurface.Create* returning null.\r\n",
        "createdAt": "2020-06-03T12:56:39",
        "reactions": []
      },
      {
        "id": 695179115,
        "author": "emmauss",
        "body": "@garrynewman  have you found a way to create a vulkan sksurface",
        "createdAt": "2020-09-19T07:41:58",
        "reactions": []
      },
      {
        "id": 695179787,
        "author": "garrynewman",
        "body": "No",
        "createdAt": "2020-09-19T07:49:49",
        "reactions": []
      },
      {
        "id": 696230021,
        "author": "mattleibow",
        "body": "Maybe @MarchingCube can help? I believe that they got that working pretty well all over...",
        "createdAt": "2020-09-21T16:34:41",
        "reactions": []
      },
      {
        "id": 711878652,
        "author": "MarchingCube",
        "body": "@mattleibow @garrynewman Missed the notification until I started poking around in SkiaSharp again :)\r\n\r\nLong story short - Initializing Skia Vulkan surface is not nearly as easy as in OpenGL :)\r\n\r\nSetup:\r\n1. Make sure that you initialize your Vulkan devices and instance\r\n2. Create your platform KHR vulkan surface (on windows it is \u0060Win32SurfaceKHR\u0060)\r\n3. Create swapchain from the surface and obtain images that can be rendered to from it.\r\n4. Each image needs to be wrapped into \u0060GRBackendRenderTarget\u0060 and you need to pass filled in \u0060GRVkImageInfo\u0060  (we are not setting \u0060Alloc\u0060 to anything).\r\n5. You can use \u0060SKSurface.Create\u0060 and give it created render target, \u0060GRContext\u0060 and it will create Vulkan accelerated backbuffer based Skia surface.\r\n\r\nRendering:\r\n1. Obtain the next image index from the swapchain\r\n2. Transition obtained image into color attachment layout\r\n3. **Draw here**\r\n4. Flush drawing commands from the canvas and context\r\n5. Transition obtained image into present source layout\r\n6. Present swapchain image\r\n\r\nThis description is quite simplified and omits several parts that vary based on your app - if you want to render all the time you need to also submit fences/semaphores before/after rendering to make sure that you don\u0027t render too fast and that rendering is actually done.",
        "createdAt": "2020-10-19T08:59:11",
        "reactions": []
      },
      {
        "id": 719985347,
        "author": "BradChase2011",
        "body": "@MarchingCube Thanks for the info!  If you have extra time, I would love for some more info on how to get this running.  We have a full UI library based on Vulkan and Skia for drawing vectors.\r\n\r\nSo a normal path we take right now is to take say an SVG, and then load it into a SKBitmap and SKCanvas and then DrawPicture and from there take the pixels, convert them into our format and push it over to the GPU Image.\r\n\r\nI am having a hard time understanding how that changes into using the Vulkan version of drawing.  Do you have a small example of setting up the different GR--- objects?  Or do you have any links to some good examples or any examples hah that helped you guys get moving forward?\r\n\r\nI guess to be clear, we don\u0027t write direct to the back buffer, we write to textures and then use those later on to write to the back buffer. \r\n\r\nAnything you can add or link to would be GREATLY appreciated, I cant seem to find any info anywhere.\r\n\r\nEDIT:  I cant seem to figure out how to link an SKBitmap over to the GRBackendRenderTarget or whatever is needed to push it into an Image on the vulkan side...\r\n\r\nEDIT2:  Using GrContext.CreateVulkan, always returns null, cant seem to figure out what I am missing there either...  Maybe it has to do with not setting GetProcedureAddress, but I am not sure what that property needs or does...\r\nNM, I was able to get it to return a context using the code from https://github.com/mono/SkiaSharp/blob/a285919b8f6721f07986fe45ca1417e8524ecce5/tests/VulkanTests/VkContexts/Win32/Win32VkContext.cs ",
        "createdAt": "2020-10-31T20:35:00",
        "reactions": []
      }
    ]
  }
}