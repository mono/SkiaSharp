{
  "number": 2675,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] Cannot build native iOS libSkiaSharp with cake",
  "body": "### Description\n\nUpon trying to build native libSkiaSharp for iOS native lib got following linker error. I suppose I may have made a mistake somewhere, but the only change I\u0027ve made was to set IOS_DEPLOYMENT_TARGET_VERSION in build.cake to 12 as long as I don\u0027t have 11 toolchain support anymore on macos sonoma.\r\n\r\nPLEASE NOTE: I\u0027m building from custom branch dev/glview as I want to get HW on MAUI. Actually I was successful even integrating Metal support for apple devices into MAUI, now I\u0027m trying to expose more native skia to get tesselation to SKVertices, for which I have to have access to GrTriangulator\r\n\r\nSteps to reproduce:\r\n\r\n~/SkiaSharp/native/ios $ dotnet cake\r\n\r\nPlease see the output of linker below\n\n### Code\n\n--\n\n### Expected Behavior\n\nExpect the iOS skia native to build successfully\n\n### Actual Behavior\n\nBuilding iOS native for skia fails at the linker stage\n\n### Version of SkiaSharp\n\nOther (Please indicate in the description)\n\n### Last Known Good Version of SkiaSharp\n\nOther (Please indicate in the description)\n\n### IDE / Editor\n\nOther (Please indicate in the description)\n\n### Platform / Operating System\n\niOS\n\n### Platform / Operating System Version\n\n_No response_\n\n### Devices\n\n_No response_\n\n### Relevant Screenshots\n\n_No response_\n\n### Relevant Log Output\n\n\u0060\u0060\u0060shell\nduplicate symbol \u0027__ZNK11skresources23CachingResourceProvider14loadImageAssetEPKcS2_S2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources28DataURIResourceProviderProxy14loadImageAssetEPKcS2_S2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20MultiFrameImageAsset12isMultiFrameEv\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources23CachingResourceProviderC2E5sk_spINS_16ResourceProviderEE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20FileResourceProvider4MakeE8SkStringb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources25ResourceProviderProxyBaseC2E5sk_spINS_16ResourceProviderEE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources23CachingResourceProviderC1E5sk_spINS_16ResourceProviderEE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources25ResourceProviderProxyBase8loadFontEPKcS2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZTVN11skresources23CachingResourceProviderE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources10ImageAsset8getFrameEf\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZTVN11skresources25ResourceProviderProxyBaseE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources28DataURIResourceProviderProxy12loadTypefaceEPKcS2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources25ResourceProviderProxyBase12loadTypefaceEPKcS2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources25ResourceProviderProxyBaseC1E5sk_spINS_16ResourceProviderEE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20MultiFrameImageAsset13generateFrameEf\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZTVN11skresources28DataURIResourceProviderProxyE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20FileResourceProviderC2E8SkStringb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20MultiFrameImageAssetC2ENSt3__110unique_ptrI17SkAnimCodecPlayerNS1_14default_deleteIS3_EEEEb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources20FileResourceProvider4loadEPKcS2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZTVN11skresources10ImageAssetE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources28DataURIResourceProviderProxyC2E5sk_spINS_16ResourceProviderEEb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20FileResourceProviderC1E8SkStringb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources25ResourceProviderProxyBase4loadEPKcS2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources25ResourceProviderProxyBase14loadAudioAssetEPKcS2_S2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources10ImageAsset12getFrameDataEf\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources25ResourceProviderProxyBase14loadImageAssetEPKcS2_S2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources28DataURIResourceProviderProxyC1E5sk_spINS_16ResourceProviderEEb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZTVN11skresources20FileResourceProviderE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZNK11skresources20FileResourceProvider14loadImageAssetEPKcS2_S2_\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20MultiFrameImageAsset8getFrameEf\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources28DataURIResourceProviderProxy4MakeE5sk_spINS_16ResourceProviderEEb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20MultiFrameImageAsset4MakeE5sk_spI6SkDataEb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZN11skresources20MultiFrameImageAssetC1ENSt3__110unique_ptrI17SkAnimCodecPlayerNS1_14default_deleteIS3_EEEEb\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nduplicate symbol \u0027__ZTVN11skresources20MultiFrameImageAssetE\u0027 in:\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskottie.a[73](libskresources.SkResources.o)\r\n    ../../../externals/skia/out/iossimulator/x86_64/libskresources.a[2](libskresources.SkResources.o)\r\nld: 34 duplicate symbols\r\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n\r\n/Users/bogdan/Repositories/SkiaSharp/native/ios/libSkiaSharp/libSkiaSharp.xcodeproj: warning: DEFINES_MODULE was set, but no umbrella header could be found to generate the module map (in target \u0027libSkiaSharp\u0027 from project \u0027libSkiaSharp\u0027)\r\n** ARCHIVE FAILED **\r\n\r\n\r\nThe following build commands failed:\r\n\tLd /Users/bogdan/Repositories/SkiaSharp/native/ios/libSkiaSharp/obj/Release/iphonesimulator/x86_64/Build/Intermediates.noindex/ArchiveIntermediates/libSkiaSharp/InstallationBuildProductsLocation/Library/Frameworks/libSkiaSharp.framework/libSkiaSharp normal (in target \u0027libSkiaSharp\u0027 from project \u0027libSkiaSharp\u0027)\r\n(1 failure)\r\nAn error occurred when executing task \u0027libSkiaSharp\u0027.\r\nError: xcodebuild: Process returned an error (exit code 65).\n\u0060\u0060\u0060\n\n\n### Code of Conduct\n\n- [x] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "bogdan799",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2023-11-26T01:31:23",
  "updatedAt": "2024-02-09T21:00:26",
  "closedAt": "2024-01-10T20:09:02",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T20:22:33.1224878Z",
    "reactions": [],
    "comments": [
      {
        "id": 1885643088,
        "author": "mattleibow",
        "createdAt": "2024-01-10T20:09:41",
        "reactions": []
      }
    ]
  }
}