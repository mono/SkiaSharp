{
  "number": 2664,
  "type": "pr",
  "state": "closed",
  "title": "Provide allocate-less overloads of methods in SKTextBlobBuilder",
  "body": "In Uno Platform, we are using \u0060AllocatePositionedRun\u0060, which in some scenarios can be problematic as it\u0027s allocating and it\u0027s in a hot path. See for example this is a case where this was responsible for 11.3% of all allocations.\r\n\r\n![image](https://github.com/mono/SkiaSharp/assets/31348972/b3761455-752d-4d65-9a04-48d78b5cd2b5)\r\n\r\nThe idea here is to introduce a new API that won\u0027t allocate \u0060SKPositionedRunBuffer\u0060 and instead give us the \u0060Span\u0060s that we need right away. I have made the same change to APIs other than \u0060AllocatePositionedRun\u0060 for parity.\r\n\r\n- Fixes https://github.com/mono/SkiaSharp/issues/2776",
  "author": {
    "login": "Youssef1313",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2023-11-03T16:13:50",
  "updatedAt": "2024-03-27T20:50:54",
  "closedAt": "2024-03-27T20:27:08",
  "commentCount": 5,
  "reactionCount": 0,
  "draft": false,
  "merged": false,
  "mergeableState": "unknown",
  "baseBranch": "main",
  "headBranch": "performant-alternative",
  "additions": 149,
  "deletions": 27,
  "changedFiles": 2,
  "commits": 1,
  "reviews": [],
  "engagement": {
    "syncedAt": "2026-02-06T12:55:51.5402923Z",
    "reactions": [],
    "comments": [
      {
        "id": 1792833864,
        "author": "Gillibald",
        "body": "Why aren\u0027t you changing SKRunBuffer to a readonly struct?",
        "createdAt": "2023-11-03T17:14:49",
        "reactions": []
      },
      {
        "id": 1792835921,
        "author": "Youssef1313",
        "body": "@Gillibald Avoiding breaking changes",
        "createdAt": "2023-11-03T17:16:18",
        "reactions": []
      },
      {
        "id": 1792838929,
        "author": "Gillibald",
        "body": "This can be a breaking change for V3",
        "createdAt": "2023-11-03T17:18:27",
        "reactions": [
          {
            "user": "mattleibow",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:55:51.0332487Z"
          }
        ]
      },
      {
        "id": 1974126089,
        "author": "mattleibow",
        "body": "This sort of came to me https://github.com/mono/SkiaSharp/pull/2775\r\n\r\nLet me know if this is useful and leave comments/suggestions.",
        "createdAt": "2024-03-02T00:23:05",
        "reactions": []
      },
      {
        "id": 2023914808,
        "author": "mattleibow",
        "body": "Thanks for this PR.\r\n\r\nClosing this in favour of https://github.com/mono/SkiaSharp/pull/2775\r\n\r\nSince this API will be 3.0\u002B and the whole way the build works is different, the current API was mostly wrong. Hopefully the 3.x APIs are better to use.",
        "createdAt": "2024-03-27T20:27:08",
        "reactions": [
          {
            "user": "Youssef1313",
            "content": "\u002B1",
            "createdAt": "2026-02-06T12:55:51.4900406Z"
          }
        ]
      }
    ]
  }
}