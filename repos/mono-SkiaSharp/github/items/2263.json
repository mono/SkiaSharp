{
  "number": 2263,
  "type": "issue",
  "state": "open",
  "title": "[QUESTION] SKBitmap.Decode(stream) will dispose this stream, feature or bug?",
  "body": "\u003C!--\r\n\r\nYou can ask questions here, but there might be better places to do that as well:\r\n\r\n - If you have questions on how to use SkiaSharp with .NET, this is the best place.\r\n - If you have questions on how to draw a picture, but need some suggestions, there is the community to help:\r\n    - StackOverflow: https://stackoverflow.com/questions/tagged/skiasharp\r\n    - Xamarin Forums: https://forums.xamarin.com\r\n    - Gitter.im Chat: https://gitter.im/xamarin/XamarinComponents\r\n - If you have questions on skia, or need to ask more advanced questions about the native API, the skia Group is the place to go: https://groups.google.com/forum/#!forum/skia-discuss\r\n\r\nBut... If you still aren\u0027t sure about where to ask your question, then go ahead and ask here! We will try and answer you, but if we can\u0027t, then we will help you get the answers you want.\r\n\r\n--\u003E\r\n\r\nI use SKBitmap.Decode(stream) to create a Bitmap, when i need continue use this stream, i found it is dispose.\r\n\r\n![sharex-20220928152228](https://user-images.githubusercontent.com/17793881/192715483-3fd77411-1554-4c91-9593-4b7b80638eca.png)\r\n\r\n\r\n![sharex-20220928152307](https://user-images.githubusercontent.com/17793881/192715523-64eb35f2-ddab-4857-bb85-05f2b435c731.png)\r\n\r\n\r\nSkiasharp Version: 2.88.2\r\n",
  "author": {
    "login": "xtuzy",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-09-28T07:35:17",
  "updatedAt": "2025-09-13T17:24:18",
  "commentCount": 9,
  "reactionCount": 6,
  "engagement": {
    "syncedAt": "2026-02-06T13:23:56.4732549Z",
    "reactions": [
      {
        "user": "PetrVobornik",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:23:56.4732622Z"
      },
      {
        "user": "Ebola-Chan-bot",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:23:56.4732629Z"
      },
      {
        "user": "tigransard",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:23:56.473263Z"
      },
      {
        "user": "stesee",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:23:56.4732632Z"
      },
      {
        "user": "jlidbeck",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:23:56.4732633Z"
      },
      {
        "user": "jbhelm",
        "content": "\u002B1",
        "createdAt": "2026-02-06T13:23:56.4732634Z"
      }
    ],
    "comments": [
      {
        "id": 1261325484,
        "author": "LukePulverenti",
        "body": "Are you saying this was different in earlier versions?",
        "createdAt": "2022-09-28T18:44:45",
        "reactions": []
      },
      {
        "id": 1261527531,
        "author": "xtuzy",
        "body": "no difference compare with 2.88.0, i  just feel it is not right, stream should be disposed by user like this\r\n\u0060\u0060\u0060\r\nusing(var stream = ***)\r\n{\r\n  var bitmap = SKBitmap.Decode(stream);\r\n}\r\n\u0060\u0060\u0060",
        "createdAt": "2022-09-28T22:29:01",
        "reactions": [
          {
            "user": "Ebola-Chan-bot",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.031431Z"
          },
          {
            "user": "p3p3pp3",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.0314316Z"
          },
          {
            "user": "jlidbeck",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.0314317Z"
          }
        ]
      },
      {
        "id": 1303121489,
        "author": "dallonxu",
        "body": "@xtuzy \r\n\r\nJust use \u0060SKData\u0060 to wrap the \u0060stream\u0060, the \u0060stream\u0060 will not be closed after \u0060SKBitmap.Decode\u0060.\r\n\u0060\u0060\u0060cs\r\nusing(var stream = ***)\r\n{\r\n    var skData = SKData.Create(stream);\r\n    var bitmap = SKBitmap.Decode(skData);\r\n    //stream will not be closed here\r\n}\r\n\u0060\u0060\u0060",
        "createdAt": "2022-11-04T08:39:04",
        "reactions": [
          {
            "user": "N-Olbert",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543093Z"
          },
          {
            "user": "Vivelin",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.25431Z"
          },
          {
            "user": "FrantisekSidak",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543101Z"
          },
          {
            "user": "Copernicus13",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543102Z"
          },
          {
            "user": "maxenko",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543102Z"
          },
          {
            "user": "enqbator",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543103Z"
          },
          {
            "user": "drozdik-m",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543104Z"
          },
          {
            "user": "Xaxage",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543105Z"
          },
          {
            "user": "OleksiiZuiev",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543105Z"
          },
          {
            "user": "magicxor",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543106Z"
          },
          {
            "user": "BenHakobyan",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543107Z"
          },
          {
            "user": "dyskette",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543107Z"
          },
          {
            "user": "gustavo-cantero",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543108Z"
          },
          {
            "user": "JeanDanielGasser",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543108Z"
          },
          {
            "user": "Ebola-Chan-bot",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.2543109Z"
          },
          {
            "user": "mihaigonciar",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.254311Z"
          },
          {
            "user": "jlidbeck",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.254311Z"
          }
        ]
      },
      {
        "id": 1685777924,
        "author": "maxenko",
        "body": "This is a really bad design choice if not a bug.",
        "createdAt": "2023-08-21T07:14:15",
        "reactions": [
          {
            "user": "enqbator",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656159Z"
          },
          {
            "user": "drozdik-m",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656166Z"
          },
          {
            "user": "JNecker",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656166Z"
          },
          {
            "user": "TWhidden",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656168Z"
          },
          {
            "user": "Xaxage",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656168Z"
          },
          {
            "user": "g0dm0d3",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656169Z"
          },
          {
            "user": "OleksiiZuiev",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656169Z"
          },
          {
            "user": "magicxor",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.465617Z"
          },
          {
            "user": "nifiz",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656171Z"
          },
          {
            "user": "koszeggy",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656171Z"
          },
          {
            "user": "JeanDanielGasser",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656172Z"
          },
          {
            "user": "Ebola-Chan-bot",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656172Z"
          },
          {
            "user": "p3p3pp3",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656173Z"
          },
          {
            "user": "Xopabyteh",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656174Z"
          },
          {
            "user": "SirMrDexter",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656174Z"
          },
          {
            "user": "dstj",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.4656175Z"
          }
        ]
      },
      {
        "id": 1685893843,
        "author": "mattleibow",
        "body": "I\u0027ll need to confirm, but I am pretty sure this is expected. The decode usually reads all the way to the end, and the stream may not always be rewindable. So there was not much point in keeping it open... However, the Stream overloads could maybe get an additional parameter to indicate whether or not to close the stream. ",
        "createdAt": "2023-08-21T08:34:37",
        "reactions": [
          {
            "user": "koszeggy",
            "content": "confused",
            "createdAt": "2026-02-06T13:23:55.6478622Z"
          },
          {
            "user": "Ebola-Chan-bot",
            "content": "-1",
            "createdAt": "2026-02-06T13:23:55.6478628Z"
          },
          {
            "user": "p3p3pp3",
            "content": "-1",
            "createdAt": "2026-02-06T13:23:55.6478629Z"
          },
          {
            "user": "p3p3pp3",
            "content": "confused",
            "createdAt": "2026-02-06T13:23:55.647863Z"
          }
        ]
      },
      {
        "id": 2486803099,
        "author": "nifiz",
        "body": "@mattleibow Managing a Stream should be left up to the user, not a completely different function they call. ",
        "createdAt": "2024-11-19T21:37:03",
        "reactions": [
          {
            "user": "angelofb",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.8319423Z"
          },
          {
            "user": "Ebola-Chan-bot",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.8319428Z"
          },
          {
            "user": "p3p3pp3",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.8319429Z"
          },
          {
            "user": "jbhelm",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:55.831943Z"
          }
        ]
      },
      {
        "id": 2764464308,
        "author": "Ebola-Chan-bot",
        "body": "\u003E I\u0027ll need to confirm, but I am pretty sure this is expected. The decode usually reads all the way to the end, and the stream may not always be rewindable. So there was not much point in keeping it open... However, the Stream overloads could maybe get an additional parameter to indicate whether or not to close the stream.\n\nAt least for me, this behavior is very unexpected. I usually keep a Stream instance for multiple purposes, rather than expecting it to be disposed by a seemingly \u0022read-only\u0022 operation. And it cost me so much time to find that the bug in my app ultimately comes from this behavior.",
        "createdAt": "2025-03-30T09:10:32",
        "reactions": [
          {
            "user": "p3p3pp3",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:56.0328539Z"
          },
          {
            "user": "jlidbeck",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:56.0328544Z"
          },
          {
            "user": "jbhelm",
            "content": "\u002B1",
            "createdAt": "2026-02-06T13:23:56.0328545Z"
          }
        ]
      },
      {
        "id": 3288390125,
        "author": "tigransard",
        "body": "there is another workaround that I fond in the code\n\n\u0060\u0060\u0060\nvar skStream = new SKManagedStream(stream, disposeManagedStream: false);\nusing var bitmap = SKBitmap.Decode(skStream);\n\u0060\u0060\u0060\n\nin this case your original Stream will not be closed;",
        "createdAt": "2025-09-13T13:51:00",
        "reactions": []
      },
      {
        "id": 3288657972,
        "author": "mattleibow",
        "body": "I think we could ad some internal wrapper/proxy stream so you can disable this feature.\n\nSkia will always dispose, but we can hide it if we want.\n\n@tigransard has a good workaround that we could implement internally. ",
        "createdAt": "2025-09-13T17:24:18",
        "reactions": []
      }
    ]
  }
}