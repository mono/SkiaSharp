{
  "number": 1943,
  "type": "issue",
  "state": "open",
  "title": "[QUESTION] I implemented multiple layers for partial updates (in GL mode) using SKSurface, am I doing it correctly?",
  "body": "Thank your such as awesome project @mattleibow ! \r\n\r\n**Question**: I have scoured the internet for answers on how to effectively implement a way to only partially update the drawing by basically creating multiple layers but have only found clues here and there. I am building my own UI in WinForms by drawing it using SkiaSharp \u002B the \u0060SKGLControl\u0060 control. Everything is working really well but I can\u0027t help feel there should be an effective way of not redrawing every \u0022UI widget\u0022 from scratch every time. So I have tried coming up with a concept of having multipe layers that I can draw into and then composite in a final scene.\r\n\r\nFrom what I\u0027ve found the SKSurface seems to be the ideal candidate. So what I do is I create a SKSurface for each layer, draw into the canvas of each surface and then draw all my layers (SKSurfaces) on top of each other in the SKGLControl PaintSurface event. I started by creating a raster surface (I think) and it worked right away but I am under the impression that I won\u0027t use the GPU in that case? So I tried following this sample: https://docs.microsoft.com/en-us/dotnet/api/skiasharp.skcanvas?view=skiasharp-2.80.2 to create a GL surface. This did not work when I did \u0060var context = GRContext.Create(GRBackend.OpenGL)\u0060 to create my GL context (only blank screen) but once I tried passing in the GLContext from the SKGLControl everything started working!\r\n\r\nThis is how I am doing it currently, would you experts and especially @mattleibow say this is a correct way of implementing layers and still have everything GPU accelerated? Any pitfalls? Sample code below:\r\n\r\n\u0060\u0060\u0060cs\r\npublic partial class Form1 : Form\r\n    {\r\n        public Form1()\r\n        {\r\n            InitializeComponent();\r\n            skglControl1.PaintSurface \u002B= SkglControl1_PaintSurface;\r\n        }\r\n\r\n        private SKSurface _layer1;\r\n        private SKSurface _layer2;\r\n\r\n        private void SkglControl1_PaintSurface(object sender, SKPaintGLSurfaceEventArgs e)\r\n        {\r\n            DrawTextInLayer(e.Surface, \u0022Root layer\u0022, 0, 50);\r\n\r\n            // Create the layer only the first time\r\n            if (_layer1 == null \u0026\u0026 _layer2 == null)\r\n            {\r\n                // Note: Creating a new context using GRContext.Create(GRBackend.OpenGL) does not seem to work,\r\n                // I have to use the same one from the skGlControl i\u0027m currently using\r\n                _layer1 = SKSurface.Create(e.Surface.Context, true, new SKImageInfo(256, 256));\r\n                _layer2 = SKSurface.Create(e.Surface.Context, true, new SKImageInfo(256, 256));\r\n\r\n                // Draw these only once\r\n                DrawTextInLayer(_layer1, \u0022Layer 1\u0022, 0, 100);\r\n                DrawTextInLayer(_layer2, \u0022Layer 2\u0022, 0, 150);\r\n            }\r\n\r\n            // Draw the layers onto the main canvas\r\n            e.Surface.Canvas.DrawSurface(_layer1, 0, 0);\r\n            e.Surface.Canvas.DrawSurface(_layer2, 0, 0);\r\n        }\r\n\r\n        private void DrawTextInLayer(SKSurface layer, string text, float x, float y)\r\n        {\r\n            var redBrush = new SKPaint\r\n            {\r\n                Color = SKColors.Red\r\n            };\r\n\r\n            layer.Canvas.DrawText(text, x, y, redBrush);\r\n        }\r\n    }\r\n\u0060\u0060\u0060\r\n\r\nMany thanks for this project!",
  "author": {
    "login": "johot",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-01-31T21:20:26",
  "updatedAt": "2023-02-23T17:07:32",
  "commentCount": 2,
  "reactionCount": 1,
  "engagement": {
    "syncedAt": "2026-02-04T20:28:08.4420318Z",
    "reactions": [
      {
        "user": "blhough",
        "content": "heart",
        "createdAt": "2026-02-04T20:28:08.4420403Z"
      }
    ],
    "comments": [
      {
        "id": 1116940493,
        "author": "geometrikal",
        "createdAt": "2022-05-04T05:25:44",
        "reactions": []
      },
      {
        "id": 1442131798,
        "author": "feanor12",
        "createdAt": "2023-02-23T17:07:31",
        "reactions": []
      }
    ]
  }
}