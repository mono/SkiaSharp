{
  "number": 1157,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] Could not load file or assembly \u0027libSkiaSharp\u0027 or one of its dependencies. The module was expected to contain an assembly manifest.",
  "body": "Using SkiaSharp from NuGet, version 1.68.1.1, I was getting a BadImageFormat exception when running my ASP.NET (standard) server, which referenced a PCL using SkiaSharp. I added at one point \r\n\r\n\u0060\u0060\u0060\r\n  \u003CTarget Name=\u0022CopyRequiredNativeAssets\u0022 AfterTargets=\u0022_FunctionsPostPublish\u0022\u003E\r\n    \u003CItemGroup\u003E\r\n      \u003CNativeAssetToCopy Include=\u0022$(PublishDir)runtimes\\win-x64\\native\\libSkiaSharp.dll\u0022 /\u003E\r\n    \u003C/ItemGroup\u003E\r\n    \u003CCopy SourceFiles=\u0022@(NativeAssetToCopy)\u0022 DestinationFolder=\u0022$(PublishDir)bin\u0022 /\u003E\r\n  \u003C/Target\u003E\r\n\u0060\u0060\u0060\r\n\r\nwhich came from another bug report here. I now get this assembly manifest error, and I\u0027m out of ideas and things to search for. In my unit test project, I had no issues loading and using SkiaSharp in the PCL. Everything is set to \u0060AnyCPU\u0060, which I thought was fixed in the targets file.\r\n\r\nWhat am I missing, and is there more I can try to fix this?\r\n",
  "author": {
    "login": "Drise13",
    "type": "User"
  },
  "labels": [
    {
      "name": "status/needs-info",
      "color": "B8EC4A"
    }
  ],
  "assignees": [],
  "createdAt": "2020-02-27T22:51:36",
  "updatedAt": "2022-08-19T06:02:36",
  "closedAt": "2020-06-25T01:08:35",
  "commentCount": 5,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-06T14:11:43.6597731Z",
    "reactions": [],
    "comments": [
      {
        "id": 592221322,
        "author": "Drise13",
        "body": "I\u0027ve also tried \r\n\u0060\u0060\u0060\r\n \u003CPropertyGroup\u003E\r\n    \u003CPreferredNativeSkiaSharp\u003Ex64\u003C/PreferredNativeSkiaSharp\u003E\r\n  \u003C/PropertyGroup\u003E\r\n\u0060\u0060\u0060",
        "createdAt": "2020-02-27T23:00:18",
        "reactions": []
      },
      {
        "id": 593443244,
        "author": "mattleibow",
        "body": "What is the server you are deploying on? It looks to be Azure Functions?\r\n\r\nI think you got the code from here? https://github.com/mono/SkiaSharp/issues/1001\r\n\r\nFrom that, I see you are using \u0060x64\u0060. I believe Azure Functions is \u0060x86\u0060 - which is resulting in the \u0060BadImageFormatException\u0060.",
        "createdAt": "2020-03-02T14:58:18",
        "reactions": []
      },
      {
        "id": 593464950,
        "author": "Drise13",
        "body": "The server is a typical IIS server run on Windows. Build should be in \u0060x64\u0060.",
        "createdAt": "2020-03-02T15:40:40",
        "reactions": []
      },
      {
        "id": 614327013,
        "author": "mattleibow",
        "body": "It may be that the server is running as x86. The \u0060BadImageFormatException\u0060 means that the dll was found, but not correct. Try \u0060x86\u0060.",
        "createdAt": "2020-04-15T23:19:28",
        "reactions": []
      },
      {
        "id": 646361063,
        "author": "mattleibow",
        "body": "Did you manage to resolve this issue?",
        "createdAt": "2020-06-18T23:52:00",
        "reactions": []
      }
    ]
  }
}