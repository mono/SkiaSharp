{
  "number": 2999,
  "type": "issue",
  "state": "closed",
  "title": "Managed vtable types (ie. containing any reference types) are not supported. (With WindowsSdkPackageVersion 10.0.19041.38)",
  "body": "### Description\n\nIn this pull request I try to Update the WindowsAppSDK Dependency to 1.6.240829007 \r\n\r\nhttps://github.com/Mapsui/Mapsui/pull/2747\r\n\r\nThis needs following Entry in the csproj File\r\n\u0060\u0060\u0060\r\n\u003C!-- Windows App Sdk 1.6 Workaround--\u003E\r\n\u003CWindowsSdkPackageVersion\u003E10.0.19041.38\u003C/WindowsSdkPackageVersion\u003E\r\n\u0060\u0060\u0060\r\nWhich in Turn causes Managed vtable types (ie. containing any reference types) are not supported\r\n\r\nWhat I discovered is that adding alone without Updating WindowsAppSdk Causes this Exception so it is a Behavior change\r\nIn the Windows App SDK Ref starting around 10.0.x.38 Versions.\r\n\r\n\u0060\u0060\u0060\r\n\u003C!-- Windows App Sdk 1.6 Workaround--\u003E\r\n\u003CWindowsSdkPackageVersion\u003E10.0.19041.38\u003C/WindowsSdkPackageVersion\u003E\r\n\u0060\u0060\u0060\r\n\r\nSample the Reproduces the Crash, should display a circle could not test it it crashed before it can display anything.\r\n\r\nFrom the Callstack it seems Code that is executed in SKXamlCanvas.DoInvalidate crashes the Application\r\n\r\n[App1.zip](https://github.com/user-attachments/files/17005205/App1.zip)\r\n\n\n### Code\n\nThe best way to share code for larger projects is a link to a GitHub repository: https://github.com/user/repo/tree/bug-123\r\n\r\nBut, you can also share a short block of code here:\r\n\u0060\u0060\u0060cs\r\n// some C# code here\r\n\u0060\u0060\u0060\r\nYou can also share some XAML:\r\n\u0060\u0060\u0060xaml\r\n\u003C!-- xaml code here --\u003E\r\n\u0060\u0060\u0060\r\n\n\n### Expected Behavior\n\nNo exception and SkiaSharp Works with WindowsAppSdk 1.6\n\n### Actual Behavior\n\nSkiaSharp Crashes with Exception of \u0022Which in Turn causes Managed vtable types (ie. containing any reference types) are not supported\u0022\n\n### Version of SkiaSharp\n\n2.88.3 (Current)\n\n### Last Known Good Version of SkiaSharp\n\nNone\n\n### IDE / Editor\n\nVisual Studio (Windows)\n\n### Platform / Operating System\n\nWindows\n\n### Platform / Operating System Version\n\nWindows 11, Visual Studio 2022 Preview 17.12\n\n### Devices\n\nWindows Packaged Windows App\n\n### Relevant Screenshots\n\nCall Stack of Exception in the IDE.\r\n\u003Cimg width=\u0022988\u0022 alt=\u0022image\u0022 src=\u0022https://github.com/user-attachments/assets/c8caabd8-e99e-4eff-a6ef-0e511b9589b1\u0022\u003E\r\n\n\n### Relevant Log Output\n\n\u0060\u0060\u0060shell\nCall Stack Of Exception\r\n\r\n\r\nWinRT.Runtime.dll!WinRT.ObjectReference\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E.GetVtable(nint thisPtr)\r\nWinRT.Runtime.dll!WinRT.ObjectReference\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E.ObjectReference(nint thisPtr)\r\nWinRT.Runtime.dll!WinRT.ObjectReference\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E.Attach(ref nint thisPtr, System.Guid iid)\r\nWinRT.Runtime.dll!WinRT.ObjectReference\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E.TryAs(WinRT.IObjectReference sourceRef, System.Guid iid, out WinRT.ObjectReference\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E objRef)\r\nWinRT.Runtime.dll!WinRT.IObjectReference.TryAs\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E(System.Guid iid, out WinRT.ObjectReference\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E objRef)\r\nWinRT.Runtime.dll!WinRT.IObjectReference.As\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E(System.Guid iid)\r\nWinRT.Runtime.dll!WinRT.IObjectReference.As\u003CABI.SkiaSharp.Views.Windows.IBufferByteAccess.Vftbl\u003E()\r\n[Native to Managed Transition]\r\n[Managed to Native Transition]\r\nSystem.Private.CoreLib.dll!System.Reflection.MethodBaseInvoker.InterpretedInvoke_Method(object obj, nint* args)\r\nSystem.Private.CoreLib.dll!System.Reflection.MethodBaseInvoker.InvokeWithNoArgs(object obj, System.Reflection.BindingFlags invokeAttr)\r\nWinRT.Runtime.dll!WinRT.IWinRTObject.IsInterfaceImplementedFallback.__GetObjectReferenceViaVftbl|1_1(WinRT.IObjectReference objRef, System.Type vftblType)\r\nWinRT.Runtime.dll!WinRT.IWinRTObject.IsInterfaceImplementedFallback(System.RuntimeTypeHandle interfaceType, bool throwIfNotImplemented)\r\nWinRT.Runtime.dll!WinRT.IWinRTObject.System.Runtime.InteropServices.IDynamicInterfaceCastable.IsInterfaceImplemented(System.RuntimeTypeHandle interfaceType, bool throwIfNotImplemented)\r\nSystem.Private.CoreLib.dll!System.Runtime.InteropServices.DynamicInterfaceCastableHelpers.IsInterfaceImplemented(System.Runtime.InteropServices.IDynamicInterfaceCastable castable, System.RuntimeType interfaceType, bool throwIfNotImplemented)\r\n[Native to Managed Transition]\r\n[Managed to Native Transition]\r\nWinRT.Runtime.dll!WinRT.CastExtensions.As\u003CSkiaSharp.Views.Windows.IBufferByteAccess\u003E(object value)\r\nSkiaSharp.Views.Windows.dll!SkiaSharp.Views.Windows.Utils.GetByteBuffer(Windows.Storage.Streams.IBuffer buffer)\r\nSkiaSharp.Views.Windows.dll!SkiaSharp.Views.Windows.WindowsExtensions.GetPixels(Microsoft.UI.Xaml.Media.Imaging.WriteableBitmap bitmap)\r\nSkiaSharp.Views.Windows.dll!SkiaSharp.Views.Windows.SKXamlCanvas.CreateBitmap(out SkiaSharp.SKSizeI unscaledSize, out float dpi)\r\nSkiaSharp.Views.Windows.dll!SkiaSharp.Views.Windows.SKXamlCanvas.DoInvalidate()\r\nMicrosoft.InteractiveExperiences.Projection.dll!ABI.Microsoft.UI.Dispatching.DispatcherQueueHandler.Do_Abi_Invoke(nint thisPtr)\r\n[Native to Managed Transition]\r\n[Managed to Native Transition]\r\nMicrosoft.WinUI.dll!ABI.Microsoft.UI.Xaml.IApplicationStaticsMethods.Start(WinRT.IObjectReference _obj, Microsoft.UI.Xaml.ApplicationInitializationCallback callback)\r\nMicrosoft.WinUI.dll!Microsoft.UI.Xaml.Application.Start(Microsoft.UI.Xaml.ApplicationInitializationCallback callback)\r\nMapsui.Samples.WinUI.dll!Mapsui.Samples.WinUI.Program.Main(string[] args) Line 26\r\n\u0060\u0060\u0060\n\u0060\u0060\u0060\n\n\n### Code of Conduct\n\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "inforithmics",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2024-09-15T09:28:31",
  "updatedAt": "2024-10-25T16:28:28",
  "closedAt": "2024-10-25T16:28:28",
  "commentCount": 31,
  "reactionCount": 5,
  "engagement": {
    "syncedAt": "2026-02-04T20:10:54.1655618Z",
    "reactions": [
      {
        "user": "vilgotf",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:10:54.1655677Z"
      },
      {
        "user": "Auto72",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:10:54.1655684Z"
      },
      {
        "user": "ArchieCoder",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:10:54.1655686Z"
      },
      {
        "user": "pauldendulk",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:10:54.1655687Z"
      },
      {
        "user": "john-hollander",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:10:54.1655688Z"
      }
    ],
    "comments": [
      {
        "id": 2351493169,
        "author": "inforithmics",
        "createdAt": "2024-09-15T09:32:24",
        "reactions": []
      },
      {
        "id": 2351780709,
        "author": "inforithmics",
        "createdAt": "2024-09-15T20:24:36",
        "reactions": [
          {
            "user": "pauldendulk",
            "content": "hooray",
            "createdAt": "2026-02-04T20:10:48.7363149Z"
          }
        ]
      },
      {
        "id": 2368497470,
        "author": "jeromelaban",
        "createdAt": "2024-09-23T14:43:21",
        "reactions": [
          {
            "user": "AdrianSkib",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.9244345Z"
          },
          {
            "user": "trydalch",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.92445Z"
          },
          {
            "user": "pauldendulk",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.9244503Z"
          },
          {
            "user": "beto-rodriguez",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.9244505Z"
          },
          {
            "user": "baskren",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.9244506Z"
          },
          {
            "user": "cmonachan-git",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.9244507Z"
          },
          {
            "user": "ToolmakerSteve",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:48.9244509Z"
          }
        ]
      },
      {
        "id": 2368646330,
        "author": "inforithmics",
        "createdAt": "2024-09-23T15:29:25",
        "reactions": [
          {
            "user": "baskren",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:49.0866288Z"
          }
        ]
      },
      {
        "id": 2368651536,
        "author": "inforithmics",
        "createdAt": "2024-09-23T15:30:48",
        "reactions": []
      },
      {
        "id": 2377430562,
        "author": "Auto72",
        "createdAt": "2024-09-26T16:30:27",
        "reactions": []
      },
      {
        "id": 2378838817,
        "author": "Bush-cat",
        "createdAt": "2024-09-27T09:21:29",
        "reactions": [
          {
            "user": "Auto72",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:49.7216589Z"
          }
        ]
      },
      {
        "id": 2378873814,
        "author": "Auto72",
        "createdAt": "2024-09-27T09:40:22",
        "reactions": []
      },
      {
        "id": 2381919164,
        "author": "mattleibow",
        "createdAt": "2024-09-30T03:13:53",
        "reactions": []
      },
      {
        "id": 2382246085,
        "author": "Auto72",
        "createdAt": "2024-09-30T06:46:32",
        "reactions": []
      },
      {
        "id": 2383828431,
        "author": "jeromelaban",
        "createdAt": "2024-09-30T17:52:54",
        "reactions": []
      },
      {
        "id": 2383882361,
        "author": "inforithmics",
        "createdAt": "2024-09-30T18:23:45",
        "reactions": []
      },
      {
        "id": 2392476148,
        "author": "beto-rodriguez",
        "createdAt": "2024-10-03T22:56:14",
        "reactions": []
      },
      {
        "id": 2403658662,
        "author": "bytesandwich",
        "createdAt": "2024-10-10T00:20:16",
        "reactions": []
      },
      {
        "id": 2405653417,
        "author": "mpulukkinen",
        "createdAt": "2024-10-10T17:16:33",
        "reactions": []
      },
      {
        "id": 2405662086,
        "author": "bfmyr4",
        "createdAt": "2024-10-10T17:21:20",
        "reactions": []
      },
      {
        "id": 2405684299,
        "author": "mpulukkinen",
        "createdAt": "2024-10-10T17:33:41",
        "reactions": []
      },
      {
        "id": 2407017615,
        "author": "TopperDEL",
        "createdAt": "2024-10-11T09:30:48",
        "reactions": []
      },
      {
        "id": 2407191440,
        "author": "Joost-Jens-Luminis",
        "createdAt": "2024-10-11T11:15:47",
        "reactions": []
      },
      {
        "id": 2407219403,
        "author": "TopperDEL",
        "createdAt": "2024-10-11T11:32:14",
        "reactions": []
      },
      {
        "id": 2407244121,
        "author": "Joost-Jens-Luminis",
        "createdAt": "2024-10-11T11:47:44",
        "reactions": []
      },
      {
        "id": 2407501570,
        "author": "eysdev",
        "createdAt": "2024-10-11T14:11:17",
        "reactions": []
      },
      {
        "id": 2408614781,
        "author": "core2lord",
        "createdAt": "2024-10-12T16:14:53",
        "reactions": []
      },
      {
        "id": 2408617156,
        "author": "beto-rodriguez",
        "createdAt": "2024-10-12T16:23:20",
        "reactions": [
          {
            "user": "ghuotvez",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:52.8195632Z"
          }
        ]
      },
      {
        "id": 2408805500,
        "author": "core2lord",
        "createdAt": "2024-10-13T03:34:20",
        "reactions": []
      },
      {
        "id": 2408907061,
        "author": "Bush-cat",
        "createdAt": "2024-10-13T09:47:08",
        "reactions": []
      },
      {
        "id": 2410162335,
        "author": "Joost-Jens-Luminis",
        "createdAt": "2024-10-14T06:36:54",
        "reactions": [
          {
            "user": "eysdev",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:53.3597248Z"
          },
          {
            "user": "Mangepange",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:53.3597254Z"
          },
          {
            "user": "AdrianSkib",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:53.3597255Z"
          },
          {
            "user": "d2dyno1",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:53.3597256Z"
          },
          {
            "user": "Trix07",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:53.3597257Z"
          }
        ]
      },
      {
        "id": 2413629946,
        "author": "AdrianSkib",
        "createdAt": "2024-10-15T11:28:37",
        "reactions": []
      },
      {
        "id": 2417619085,
        "author": "ghuotvez",
        "createdAt": "2024-10-16T18:37:47",
        "reactions": []
      },
      {
        "id": 2438259016,
        "author": "mattleibow",
        "createdAt": "2024-10-25T16:25:03",
        "reactions": [
          {
            "user": "TopperDEL",
            "content": "heart",
            "createdAt": "2026-02-04T20:10:53.9189786Z"
          }
        ]
      },
      {
        "id": 2438267264,
        "author": "mattleibow",
        "createdAt": "2024-10-25T16:28:26",
        "reactions": [
          {
            "user": "TopperDEL",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:10:54.1161994Z"
          }
        ]
      }
    ]
  }
}