{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3421,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T17:55:00Z"
  },
  "inputs": {
    "triageFile": "ai-triage/3421.json"
  },
  "conclusion": "reproduced",
  "assessment": "likely-bug",
  "notes": "Reproduced on macOS arm64: Animation.Create() returns null when given a .lottie file (dotLottie ZIP format) because Skottie only parses raw Lottie JSON. Raw .json files and JSON strings load successfully. The .lottie format is a ZIP archive containing Lottie JSON animations — Skia's Skottie module has no ZIP extraction support. This behavior is consistent across 3.116.0, 3.119.2, and main. While Skottie was never designed to handle dotLottie format, the silent null return on a common file format (.lottie is now the default download from LottieFiles) represents a usability gap.",
  "reproductionTime": "~8 minutes",
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      { "name": "SkiaSharp", "version": "3.116.0" },
      { "name": "SkiaSharp.Skottie", "version": "3.116.0" }
    ]
  },
  "versionResults": [
    {
      "version": "3.116.0",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Animation.Create returns null for .lottie ZIP file; raw JSON works fine."
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Same behavior on latest stable release."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "reproduced",
      "notes": "Confirmed via xUnit test on main branch — .lottie ZIP returns null, raw JSON works."
    }
  ],
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create standalone console project with SkiaSharp 3.116.0 and SkiaSharp.Skottie",
      "layer": "setup",
      "command": "mkdir -p /tmp/repro-3421 && cd /tmp/repro-3421 && dotnet new console -n Repro --framework net8.0 && cd Repro && dotnet add package SkiaSharp --version 3.116.0 && dotnet add package SkiaSharp.Skottie --version 3.116.0",
      "exitCode": 0,
      "output": "Restore succeeded.",
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Write reproduction code: creates a minimal Lottie JSON, a .lottie ZIP file (dotLottie format), and tests Animation.Create with both formats",
      "layer": "csharp",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "Console project referencing SkiaSharp and SkiaSharp.Skottie 3.116.0",
          "content": "<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net8.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n  <ItemGroup>\n    <PackageReference Include=\"SkiaSharp\" Version=\"3.116.0\" />\n    <PackageReference Include=\"SkiaSharp.Skottie\" Version=\"3.116.0\" />\n  </ItemGroup>\n</Project>"
        },
        {
          "filename": "Program.cs",
          "description": "Reproduction code that tests Animation.Create with raw .json, .lottie ZIP, and JSON string parsing",
          "content": "using System;\nusing System.IO;\nusing System.IO.Compression;\nusing SkiaSharp.Skottie;\n\n// Minimal valid Lottie JSON animation\nvar lottieJson = @\"{\n  \"\"v\"\": \"\"5.5.2\"\",\n  \"\"fr\"\": 30,\n  \"\"ip\"\": 0,\n  \"\"op\"\": 60,\n  \"\"w\"\": 100,\n  \"\"h\"\": 100,\n  \"\"layers\"\": [\n    {\n      \"\"ty\"\": 1,\n      \"\"sc\"\": \"\"#ff0000\"\",\n      \"\"ip\"\": 0,\n      \"\"op\"\": 60,\n      \"\"st\"\": 0,\n      \"\"sr\"\": 1,\n      \"\"sw\"\": 100,\n      \"\"sh\"\": 100,\n      \"\"ks\"\": {\n        \"\"o\"\": { \"\"a\"\": 0, \"\"k\"\": 100 },\n        \"\"r\"\": { \"\"a\"\": 0, \"\"k\"\": 0 },\n        \"\"p\"\": { \"\"a\"\": 0, \"\"k\"\": [50, 50] },\n        \"\"a\"\": { \"\"a\"\": 0, \"\"k\"\": [50, 50] },\n        \"\"s\"\": { \"\"a\"\": 0, \"\"k\"\": [100, 100] }\n      }\n    }\n  ]\n}\";\n\n// Test 1: Raw Lottie JSON file (.json)\nvar jsonPath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)!, \"test.json\");\nFile.WriteAllText(jsonPath, lottieJson);\nConsole.WriteLine($\"Test 1: Loading raw Lottie JSON file (.json)\");\nvar jsonAnimation = Animation.Create(jsonPath);\nConsole.WriteLine($\"  Result: {(jsonAnimation != null ? \"SUCCESS - Animation loaded\" : \"NULL - Animation is null\")}\");\nif (jsonAnimation != null)\n{\n    Console.WriteLine($\"  Duration: {jsonAnimation.Duration.TotalSeconds}s, Size: {jsonAnimation.Size}, FPS: {jsonAnimation.Fps}\");\n    jsonAnimation.Dispose();\n}\n\n// Test 2: dotLottie file (.lottie) - this is a ZIP archive containing the JSON\nvar lottiePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)!, \"test.lottie\");\nusing (var zipStream = new FileStream(lottiePath, FileMode.Create))\nusing (var archive = new ZipArchive(zipStream, ZipArchiveMode.Create))\n{\n    var manifest = archive.CreateEntry(\"manifest.json\");\n    using (var writer = new StreamWriter(manifest.Open()))\n        writer.Write(@\"{\"\"generator\"\":\"\"test\"\",\"\"version\"\":1,\"\"animations\"\":[{\"\"id\"\":\"\"test\"\",\"\"speed\"\":1}]}\");\n    var anim = archive.CreateEntry(\"animations/test.json\");\n    using (var writer = new StreamWriter(anim.Open()))\n        writer.Write(lottieJson);\n}\n\nConsole.WriteLine();\nConsole.WriteLine($\"Test 2: Loading dotLottie file (.lottie) - ZIP archive\");\nvar lottieAnimation = Animation.Create(lottiePath);\nConsole.WriteLine($\"  Result: {(lottieAnimation != null ? \"SUCCESS - Animation loaded\" : \"NULL - Animation is null\")}\");\nif (lottieAnimation != null)\n{\n    Console.WriteLine($\"  Duration: {lottieAnimation.Duration.TotalSeconds}s, Size: {lottieAnimation.Size}\");\n    lottieAnimation.Dispose();\n}\n\n// Test 3: Animation.Parse with raw JSON string (baseline)\nConsole.WriteLine();\nConsole.WriteLine($\"Test 3: Parsing raw Lottie JSON string via Animation.Parse()\");\nvar parsedAnimation = Animation.Parse(lottieJson);\nConsole.WriteLine($\"  Result: {(parsedAnimation != null ? \"SUCCESS - Animation loaded\" : \"NULL - Animation is null\")}\");\nif (parsedAnimation != null)\n{\n    Console.WriteLine($\"  Duration: {parsedAnimation.Duration.TotalSeconds}s, Size: {parsedAnimation.Size}, FPS: {parsedAnimation.Fps}\");\n    parsedAnimation.Dispose();\n}\n\nConsole.WriteLine();\nConsole.WriteLine(\"Summary:\");\nConsole.WriteLine($\"  JSON file (.json):    {(jsonAnimation != null ? \"WORKS\" : \"NULL\")}\");\nConsole.WriteLine($\"  dotLottie (.lottie):  {(lottieAnimation != null ? \"WORKS\" : \"NULL\")}\");\nConsole.WriteLine($\"  JSON string parse:    {(parsedAnimation != null ? \"WORKS\" : \"NULL\")}\");"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Run reproduction with SkiaSharp 3.116.0 — raw JSON works, .lottie ZIP returns null",
      "layer": "csharp",
      "command": "cd /tmp/repro-3421/Repro && dotnet run",
      "exitCode": 0,
      "output": "Test 1: Loading raw Lottie JSON file (.json)\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nTest 2: Loading dotLottie file (.lottie) - ZIP archive\n  Result: NULL - Animation is null\n\nTest 3: Parsing raw Lottie JSON string via Animation.Parse()\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nSummary:\n  JSON file (.json):    WORKS\n  dotLottie (.lottie):  NULL\n  JSON string parse:    WORKS",
      "result": "wrong-output"
    },
    {
      "stepNumber": 4,
      "description": "Update to latest SkiaSharp 3.119.2 and retest — same result",
      "layer": "csharp",
      "command": "cd /tmp/repro-3421/Repro && dotnet add package SkiaSharp --version 3.119.2 && dotnet add package SkiaSharp.Skottie --version 3.119.2 && dotnet run",
      "exitCode": 0,
      "output": "Test 1: Loading raw Lottie JSON file (.json)\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nTest 2: Loading dotLottie file (.lottie) - ZIP archive\n  Result: NULL - Animation is null\n\nTest 3: Parsing raw Lottie JSON string via Animation.Parse()\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nSummary:\n  JSON file (.json):    WORKS\n  dotLottie (.lottie):  NULL\n  JSON string parse:    WORKS",
      "result": "wrong-output"
    },
    {
      "stepNumber": 5,
      "description": "Test on main branch via xUnit test — .lottie ZIP returns null, raw JSON works",
      "layer": "csharp",
      "command": "dotnet test tests/SkiaSharp.Tests.Console/SkiaSharp.Tests.Console.csproj --no-build --filter \"FullyQualifiedName~DotLottieZipReturnsNull\"",
      "exitCode": 0,
      "output": "Passed!  - Failed: 0, Passed: 1, Skipped: 0, Total: 1",
      "result": "success"
    }
  ],
  "errorMessages": {
    "primaryError": "Animation.Create() returns null when given a .lottie file (dotLottie ZIP format). No exception thrown — silent failure."
  },
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "8.0.417",
    "skiaSharpVersion": "3.116.0",
    "dockerUsed": false
  },
  "feedback": {
    "triageCorrections": [
      {
        "topic": "classification",
        "upstream": "Classified as type/question with confidence 0.8",
        "corrected": "Reproduction confirms Animation.Create returns null for .lottie files. While this could be considered 'working as designed' (Skottie only supports JSON), the silent null return on a common format is a usability gap that could warrant either format detection or a better error signal. Classified as likely-bug rather than question."
      }
    ]
  }
}
