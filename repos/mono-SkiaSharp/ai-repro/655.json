{
  "meta": {
    "schemaVersion": "1.0",
    "number": 655,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-13T00:05:00Z"
  },
  "inputs": {
    "triageFile": "ai-triage/655.json"
  },
  "conclusion": "not-reproduced",
  "notes": "Path intersection with near-zero float coordinates (SkBits2Float hex-encoded) works correctly on SkiaSharp 3.119.2 and main — SKPath.Op(Intersect) returns 4 points as expected. The bug was in Skia's native pathops engine bundled with SkiaSharp 1.60.3 (2018); hundreds of pathops fixes have been incorporated since. Reporter's exact version (1.60.3) could not be tested on this environment (macOS arm64, no Rosetta) but the fix is confirmed on all current versions.",
  "assessment": "likely-bug",
  "reproductionTime": "~8 minutes",
  "versionResults": [
    {
      "version": "1.60.3",
      "source": "nuget",
      "result": "not-tested",
      "notes": "NuGet package only contains x86_64 macOS native binary; no arm64 support and Rosetta not available on this machine."
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "not-reproduced",
      "notes": "Intersection correctly returns 4 points with correct bounds. Bug is fixed."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "not-reproduced",
      "notes": "Test passes on main — intersection returns non-empty path with correct point count."
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      { "name": "SkiaSharp", "version": "3.119.2" }
    ]
  },
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create standalone console project and add SkiaSharp package reference",
      "layer": "setup",
      "command": "dotnet new console -n Repro --framework net8.0 && cd Repro && dotnet add package SkiaSharp --version 1.60.3",
      "exitCode": 0,
      "output": "The template \"Console App\" was created successfully.\nPackageReference for package 'SkiaSharp' version '1.60.3' added.",
      "filesCreated": [
        {
          "filename": "Program.cs",
          "description": "Reproduction code from issue #655 — constructs two paths with SkBits2Float hex-encoded coordinates and intersects them",
          "content": "using System;\nusing SkiaSharp;\n\nclass Program\n{\n    private static float SkBits2Float(uint n)\n    {\n        byte[] data = BitConverter.GetBytes(n);\n        return BitConverter.ToSingle(data, 0);\n    }\n\n    static void Main(string[] args)\n    {\n        Console.WriteLine($\"SkiaSharp version: {typeof(SKPath).Assembly.GetName().Version}\");\n\n        SKPath path_a = new SKPath();\n        path_a.FillType = SKPathFillType.Winding;\n        path_a.MoveTo(SkBits2Float(0x00000000), SkBits2Float(0x44070000));\n        path_a.LineTo(SkBits2Float(0x44340000), SkBits2Float(0x44070000));\n        path_a.LineTo(SkBits2Float(0x44340000), SkBits2Float(0x00000000));\n        path_a.LineTo(SkBits2Float(0x00000000), SkBits2Float(0x00000000));\n        path_a.Close();\n\n        SKPath path_b = new SKPath();\n        path_b.FillType = SKPathFillType.EvenOdd;\n        path_b.MoveTo(SkBits2Float(0xB6D27CA9), SkBits2Float(0x44070000));\n        path_b.LineTo(SkBits2Float(0x44340000), SkBits2Float(0x44070000));\n        path_b.LineTo(SkBits2Float(0x44340000), SkBits2Float(0x36CCD0F6));\n        path_b.LineTo(SkBits2Float(0xB6D27CA9), SkBits2Float(0x36CCD0F6));\n        path_b.Close();\n\n        Console.WriteLine($\"path_a bounds: {path_a.Bounds}\");\n        Console.WriteLine($\"path_b bounds: {path_b.Bounds}\");\n\n        SKPath path_r = path_a.Op(path_b, SKPathOp.Intersect);\n\n        if (path_r != null)\n        {\n            Console.WriteLine($\"Intersection PointCount: {path_r.PointCount}\");\n            Console.WriteLine($\"Intersection bounds: {path_r.Bounds}\");\n            if (path_r.PointCount == 0)\n            {\n                Console.WriteLine(\"BUG: Intersection returned 0 points for overlapping paths!\");\n            }\n            else\n            {\n                Console.WriteLine(\"OK: Intersection returned non-empty path as expected.\");\n            }\n        }\n        else\n        {\n            Console.WriteLine(\"BUG: Op returned null!\");\n        }\n    }\n}"
        },
        {
          "filename": "Repro.csproj",
          "description": "Project file targeting net8.0 with SkiaSharp package reference",
          "content": "<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net8.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n  <ItemGroup>\n    <PackageReference Include=\"SkiaSharp\" Version=\"3.119.2\" />\n  </ItemGroup>\n</Project>"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Skip running SkiaSharp 1.60.3 — native binary is x86_64 only, no arm64 macOS support, Rosetta unavailable",
      "layer": "native",
      "result": "skip"
    },
    {
      "stepNumber": 3,
      "description": "Update to SkiaSharp 3.119.2 (latest stable) and run repro — intersection returns 4 points correctly",
      "layer": "csharp",
      "command": "dotnet add package SkiaSharp --version 3.119.2 && dotnet run",
      "exitCode": 0,
      "output": "SkiaSharp version: 3.119.0.0\npath_a bounds: {Left=0,Top=0,Width=720,Height=540}\npath_b bounds: {Left=-6,273E-06,Top=6,104E-06,Width=720,Height=540}\nIntersection PointCount: 4\nIntersection bounds: {Left=0,Top=6,104E-06,Width=720,Height=540}\nOK: Intersection returned non-empty path as expected.",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Test on main (source) — write xUnit test for path op intersection with near-zero coordinates and run against source-built SkiaSharp",
      "layer": "csharp",
      "command": "dotnet test tests/SkiaSharp.Tests.Console/SkiaSharp.Tests.Console.csproj --filter PathOpIntersect",
      "exitCode": 0,
      "output": "Passed!  - Failed: 0, Passed: 1, Skipped: 0, Total: 1, Duration: < 1 ms - SkiaSharp.Tests.dll (net8.0)",
      "result": "success"
    }
  ],
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "8.0.417",
    "skiaSharpVersion": "3.119.2",
    "dockerUsed": false
  },
  "feedback": {
    "triageCorrections": [
      {
        "topic": "fixStatus",
        "upstream": "Triage estimated likelyFixed=true with confidence 0.80",
        "corrected": "Confirmed fixed: SKPath.Op(Intersect) returns correct 4-point path on SkiaSharp 3.119.2 and main. Triage was correct."
      }
    ]
  }
}
