{
  "meta": {
    "schemaVersion": "2.0",
    "number": 2421,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-11T23:42:00Z"
  },
  "conclusion": "needs-hardware",
  "notes": "Issue reports that SKPaint constructor crashes on iOS physical device with '@rpath/libSkiaSharp.framework/libSkiaSharp' native loading error. Works on iOS simulator and Android. Reproduced the native loading on macOS console successfully with both 2.88.3 and 3.119.2 — SKPaint creates without error. Attempted to build a MAUI project targeting iOS with 2.88.3 NativeAssets but the build itself failed because the 2.88.3 iOS native assets contain device-only binaries (built for 'iOS' not 'iOS-simulator'), confirming the framework packaging issue. The actual crash requires deploying to a physical iOS device to observe the @rpath resolution failure. No iOS device is available in this environment.",
  "reproductionTime": "~8 minutes",
  "versionResults": [
    {
      "version": "2.88.3",
      "source": "nuget",
      "result": "not-tested",
      "notes": "SKPaint loads fine on macOS console. iOS device required to reproduce the @rpath loading failure. MAUI iOS build failed due to device-only native binary in simulator build."
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "not-tested",
      "notes": "SKPaint loads fine on macOS console. Cannot test on iOS device — no device available."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "not-tested",
      "notes": "Issue is iOS device-specific native loading. Building from source would not help reproduce without an iOS physical device for deployment testing."
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      {
        "name": "SkiaSharp",
        "version": "2.88.3"
      },
      {
        "name": "SkiaSharp",
        "version": "3.119.2"
      }
    ]
  },
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create standalone console project and add SkiaSharp 2.88.3 to verify native loading on macOS",
      "layer": "setup",
      "command": "dotnet new console -n Repro --framework net8.0 && cd Repro && dotnet add package SkiaSharp --version 2.88.3",
      "output": "Restore succeeded. Package 'SkiaSharp' version '2.88.3' added.",
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Test SKPaint constructor with SkiaSharp 2.88.3 on macOS — the operation that crashes on iOS device",
      "layer": "csharp",
      "command": "dotnet run",
      "output": "OS: Darwin 25.2.0\nArch: Arm64\nSkiaSharp version: 2.88.0.0\nSKPaint created successfully\nPaint color set to: #ffff0000\nRESULT: Native library loaded successfully on this platform.",
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Inspect SkiaSharp.NativeAssets.iOS 2.88.3 nupkg to verify iOS framework is included",
      "layer": "deployment",
      "command": "curl -sLo /tmp/check-ios-native-2883.nupkg https://api.nuget.org/v3-flatcontainer/skiasharp.nativeassets.ios/2.88.3/skiasharp.nativeassets.ios.2.88.3.nupkg && unzip -l /tmp/check-ios-native-2883.nupkg | grep framework",
      "output": "runtimes/ios/native/libSkiaSharp.framework/libSkiaSharp (24MB)\nruntimes/ios/native/libSkiaSharp.framework/Modules/module.modulemap\nruntimes/ios/native/libSkiaSharp.framework/_CodeSignature/CodeResources\nruntimes/ios/native/libSkiaSharp.framework/Info.plist",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Create MAUI project targeting iOS with SkiaSharp 2.88.3 to test iOS build pipeline",
      "layer": "deployment",
      "command": "dotnet new maui -n MauiRepro && dotnet add package SkiaSharp.Views.Maui.Controls --version 2.88.3 && dotnet add package SkiaSharp.HarfBuzz --version 2.88.3",
      "output": "Restore succeeded. Packages added.",
      "result": "success"
    },
    {
      "stepNumber": 5,
      "description": "Build MAUI project for iOS to verify framework bundling — failed because 2.88.3 native assets contain device-only binary, incompatible with simulator build",
      "layer": "deployment",
      "command": "dotnet build -f net10.0-ios",
      "output": "error: ld: building for 'iOS-simulator', but linking in dylib built for 'iOS'\nclang++: error: linker command failed with exit code 1",
      "result": "failure"
    },
    {
      "stepNumber": 6,
      "description": "Test SKPaint constructor with latest stable SkiaSharp 3.119.2 on macOS console",
      "layer": "csharp",
      "command": "dotnet add package SkiaSharp --version 3.119.2 && dotnet run",
      "output": "OS: Darwin 25.2.0\nArch: Arm64\nSkiaSharp version: 3.119.0.0\nSKPaint created successfully\nRESULT: Native library loaded successfully on this platform.",
      "result": "success"
    }
  ],
  "errorMessages": {
    "primaryError": "@rpath/libSkiaSharp.framework/libSkiaSharp — native framework not found on iOS physical device at runtime",
    "stackTrace": "at SkiaSharp.SKPaint..ctor()\nat OxyPlot.Maui.Skia.SkiaRenderContext..ctor() in OxyPlot.Maui.Skia\\SkiaRenderContext.cs:line 24\nat OxyPlot.Maui.Skia.PlotView.CreateRenderContext() in OxyPlot.Maui.Skia\\PlotView.cs:line 41",
    "additionalErrors": [
      "ld: building for 'iOS-simulator', but linking in dylib built for 'iOS' — confirms 2.88.3 NativeAssets.iOS only contains device binary, not xcframework"
    ]
  },
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "8.0.417",
    "skiaSharpVersion": "2.88.3",
    "dockerUsed": false
  },
  "blockers": [
    "Requires physical iOS device to reproduce the @rpath native loading failure — the bug only manifests when deploying to a real device, not on simulator or other platforms",
    "iOS simulator build with 2.88.3 native assets fails at link time because the framework is device-only (not xcframework), preventing even simulator testing"
  ]
}
