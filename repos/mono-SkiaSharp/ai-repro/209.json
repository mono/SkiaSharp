{
  "meta": {
    "schemaVersion": "1.1",
    "number": 209,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T02:50:00Z"
  },
  "conclusion": "not-reproduced",
  "assessment": "likely-bug",
  "notes": "Attempted to reproduce AccessViolationException during concurrent SKBitmap.Decode operations from multiple threads. Created a standalone console app with 4 test modes (byte[] decode, Stream decode, SKCodec decode, file path decode), each running 100 threads × 500 iterations (200,000 total operations). All tests passed without error on SkiaSharp 3.119.2 (latest release) and on main branch source. The original issue was reported in 2016 with SkiaSharp v1.x on IIS (.NET Framework 4.x). The issue was likely fixed in subsequent SkiaSharp/Skia updates that improved internal thread safety. An existing test (SKObjectTest.EnsureMultithreadingDoesNotThrow) also passes on main.",
  "triageFile": "ai-triage/209.json",
  "triageNotes": "Triage correctly identified as type/bug with high severity. Classification as threading/reliability issue confirmed by reproduction attempt.",
  "reproductionTime": "~12 minutes",
  "reproProject": {
    "type": "console",
    "tfm": "net10.0",
    "packages": [
      {"name": "SkiaSharp", "version": "3.119.2"}
    ]
  },
  "versionResults": [
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "not-reproduced",
      "notes": "All 200,000 concurrent decode operations completed successfully across 4 test modes (byte[], Stream, SKCodec, file path). No AccessViolationException or other errors."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "not-reproduced",
      "notes": "Existing test SKObjectTest.EnsureMultithreadingDoesNotThrow passes (2 test cases). Tests concurrent SKBitmap.Decode from multiple tasks."
    }
  ],
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create standalone console project with latest SkiaSharp for concurrent decode testing",
      "layer": "setup",
      "command": "dotnet new console -n Repro --framework net10.0 && dotnet add package SkiaSharp",
      "exitCode": 0,
      "output": "PackageReference for package 'SkiaSharp' version '3.119.2' added.",
      "result": "success",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "Console project targeting net10.0 with SkiaSharp 3.119.2",
          "content": "<Project Sdk=\"Microsoft.NET.Sdk\">\n  <PropertyGroup>\n    <OutputType>Exe</OutputType>\n    <TargetFramework>net10.0</TargetFramework>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <Nullable>enable</Nullable>\n  </PropertyGroup>\n  <ItemGroup>\n    <PackageReference Include=\"SkiaSharp\" Version=\"3.119.2\" />\n  </ItemGroup>\n  <ItemGroup>\n    <None Update=\"baboon.jpg\">\n      <CopyToOutputDirectory>PreserveNewest</CopyToOutputDirectory>\n    </None>\n  </ItemGroup>\n</Project>"
        },
        {
          "filename": "Program.cs",
          "description": "Concurrent decode test with 4 modes: byte[] decode, Stream decode, SKCodec decode, file path decode. Each runs 100 threads × 500 iterations.",
          "content": null
        }
      ]
    },
    {
      "stepNumber": 2,
      "description": "Build the reproduction project",
      "layer": "setup",
      "command": "dotnet build",
      "exitCode": 0,
      "output": "Build succeeded. 0 Warning(s) 0 Error(s)",
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Run concurrent decode test with SkiaSharp 3.119.2 — 100 threads × 500 iterations across 4 test modes (200,000 total operations)",
      "layer": "csharp",
      "command": "dotnet run --no-build",
      "exitCode": 0,
      "output": "=== SkiaSharp Thread Safety Reproduction (Issue #209) ===\nSkiaSharp version: 3.119.0.0\nRuntime: .NET 10.0.2\nOS: macOS 26.2.0\nArch: Arm64\n\n--- Test 1: Concurrent byte[] decode ---\n  Threads: 100, Iterations: 500\n  Completed in 9430ms\n  Success: 50000, Errors: 0\n  Result: PASS\n\n--- Test 2: Concurrent Stream decode ---\n  Threads: 100, Iterations: 500\n  Completed in 189098ms\n  Success: 50000, Errors: 0\n  Result: PASS\n\n--- Test 3: Concurrent SKCodec decode ---\n  Threads: 100, Iterations: 500\n  Completed in 8659ms\n  Success: 50000, Errors: 0\n  Result: PASS\n\n--- Test 4: Concurrent file path decode ---\n  Threads: 100, Iterations: 500\n  Completed in 8193ms\n  Success: 50000, Errors: 0\n  Result: PASS\n\nOVERALL: All tests passed - no thread safety issues detected",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Run existing thread safety test on main branch source (SKObjectTest.EnsureMultithreadingDoesNotThrow)",
      "layer": "csharp",
      "command": "dotnet test tests/SkiaSharp.Tests.Console/SkiaSharp.Tests.Console.csproj --no-build --filter EnsureMultithreadingDoesNotThrow -f net8.0",
      "exitCode": 0,
      "output": "Passed! - Failed: 0, Passed: 2, Skipped: 0, Total: 2, Duration: 19 ms - SkiaSharp.Tests.dll (net8.0)",
      "result": "success"
    }
  ],
  "artifacts": [
    {
      "filename": "baboon.jpg",
      "description": "Test image used for concurrent decode operations, from SkiaSharp test content",
      "source": "test-data",
      "url": null,
      "available": true
    }
  ],
  "errorMessages": null,
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "10.0.102",
    "skiaSharpVersion": "3.119.2",
    "dockerUsed": false
  },
  "blockers": null
}
