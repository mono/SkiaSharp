{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3435,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T19:24:17Z"
  },
  "conclusion": "partial",
  "notes": "Confirmed root cause: SkiaSharp.Views.Blazor does not target net10.0 (ships only net8.0;net6.0). Builds succeed because .NET falls back to net8.0, but reporter indicates runtime DllNotFoundException in browser. TFM gap definitively confirmed in 3.116.1, 3.119.2-preview.1, and main branch source. Unable to verify browser runtime error without GUI testing.",
  "assessment": "breaking-change",
  "reproductionTime": "~15 minutes",
  "inputs": {
    "triageFile": ".data-cache/repos/mono-SkiaSharp/ai-triage/3435.json"
  },
  "environment": {
    "os": "macOS",
    "arch": "arm64",
    "dotnetVersion": "8.0.417 / 10.0.102",
    "skiaSharpVersion": "3.116.1, 3.119.2-preview.1",
    "dockerUsed": false
  },
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create Blazor WASM project targeting .NET 10",
      "command": "dotnet new blazorwasm -n Repro --framework net10.0",
      "layer": "setup",
      "result": "success",
      "exitCode": 0,
      "output": "Template created successfully. Restore succeeded.",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "Blazor WASM project file targeting net10.0",
          "content": "<Project Sdk=\"Microsoft.NET.Sdk.BlazorWebAssembly\">\n  <PropertyGroup>\n    <TargetFramework>net10.0</TargetFramework>\n    <Nullable>enable</Nullable>\n    <ImplicitUsings>enable</ImplicitUsings>\n  </PropertyGroup>\n  <ItemGroup>\n    <PackageReference Include=\"Microsoft.AspNetCore.Components.WebAssembly\" Version=\"10.0.2\" />\n    <PackageReference Include=\"Microsoft.AspNetCore.Components.WebAssembly.DevServer\" Version=\"10.0.2\" PrivateAssets=\"all\" />\n  </ItemGroup>\n</Project>"
        }
      ]
    },
    {
      "stepNumber": 2,
      "description": "Add SkiaSharp 3.116.1 packages (reporter's version)",
      "command": "dotnet add package SkiaSharp --version 3.116.1 && dotnet add package SkiaSharp.Views.Blazor --version 3.116.1",
      "layer": "setup",
      "result": "success",
      "exitCode": 0,
      "output": "PackageReference added for SkiaSharp 3.116.1 and SkiaSharp.Views.Blazor 3.116.1. Restore succeeded."
    },
    {
      "stepNumber": 3,
      "description": "Verify SkiaSharp.Views.Blazor package TFMs",
      "command": "curl -sLo /tmp/pkg.nupkg https://api.nuget.org/.../3.116.1.nupkg && unzip -l /tmp/pkg.nupkg | grep lib/",
      "layer": "deployment",
      "result": "wrong-output",
      "exitCode": 0,
      "output": "lib/net8.0/SkiaSharp.Views.Blazor.dll\nlib/net6.0/SkiaSharp.Views.Blazor.dll"
    },
    {
      "stepNumber": 4,
      "description": "Add SkiaSharp usage code to Home.razor",
      "layer": "csharp",
      "result": "success",
      "filesCreated": [
        {
          "filename": "Pages/Home.razor",
          "description": "Blazor page with SKCanvasView component",
          "content": "@page \"/\"\n@using SkiaSharp\n@using SkiaSharp.Views.Blazor\n\n<PageTitle>Home</PageTitle>\n<h1>Hello, world!</h1>\n<p>Testing SkiaSharp on Blazor WASM with .NET 10:</p>\n<SKCanvasView OnPaintSurface=\"OnPaintSurface\" style=\"width: 400px; height: 400px;\" />\n\n@code {\n    private void OnPaintSurface(SKPaintSurfaceEventArgs e)\n    {\n        var canvas = e.Surface.Canvas;\n        canvas.Clear(SKColors.White);\n        using var paint = new SKPaint { Color = SKColors.Blue, IsAntialias = true, StrokeWidth = 10, Style = SKPaintStyle.Stroke };\n        canvas.DrawCircle(200, 200, 100, paint);\n    }\n}"
        }
      ]
    },
    {
      "stepNumber": 5,
      "description": "Build Blazor WASM project with SkiaSharp 3.116.1 on .NET 10",
      "command": "dotnet build",
      "layer": "deployment",
      "result": "success",
      "exitCode": 0,
      "output": "Build succeeded in 9.6s\nLinked libSkiaSharp.a successfully from $HOME/.nuget/packages/skiasharp.nativeassets.webassembly/3.116.1/...\nEmscripten wasm-ld completed without errors"
    },
    {
      "stepNumber": 6,
      "description": "Test with SkiaSharp 3.119.2-preview.1 (latest preview)",
      "command": "dotnet add package SkiaSharp --version 3.119.2-preview.1 && dotnet add package SkiaSharp.Views.Blazor --version 3.119.2-preview.1",
      "layer": "setup",
      "result": "success",
      "exitCode": 0,
      "output": "Packages added and restored successfully"
    },
    {
      "stepNumber": 7,
      "description": "Verify 3.119.2-preview.1 TFMs",
      "command": "curl -sLo /tmp/pkg-preview.nupkg https://api.nuget.org/.../3.119.2-preview.1.nupkg && unzip -l /tmp/pkg-preview.nupkg | grep lib/",
      "layer": "deployment",
      "result": "wrong-output",
      "exitCode": 0,
      "output": "lib/net8.0/SkiaSharp.Views.Blazor.dll\nlib/net6.0/SkiaSharp.Views.Blazor.dll"
    },
    {
      "stepNumber": 8,
      "description": "Build with latest preview",
      "command": "dotnet build",
      "layer": "deployment",
      "result": "success",
      "exitCode": 0,
      "output": "Build succeeded in 9.98s. Linked libSkiaSharp.a from 3.119.2-preview.1. WASM compilation completed."
    },
    {
      "stepNumber": 9,
      "description": "Check main branch source TFM configuration",
      "command": "grep TFMCurrent source/SkiaSharp.Build.props",
      "layer": "csharp",
      "result": "wrong-output",
      "exitCode": 0,
      "output": "<TFMPrevious>net6.0</TFMPrevious>\n<TFMCurrent>net8.0</TFMCurrent>\n<TFMNext></TFMNext>"
    }
  ],
  "versionResults": [
    {
      "version": "3.116.1",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Package lacks net10.0 TFM. Build succeeds (fallback to net8.0) but reporter indicates runtime DllNotFoundException in browser. Root cause confirmed: missing TFM."
    },
    {
      "version": "3.119.2-preview.1",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Same issue - no net10.0 TFM in package. Exhibits same behavior as 3.116.1."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "not-tested",
      "notes": "Source build confirms TFMCurrent=net8.0, TFMNext empty. Cannot produce package with net10.0 until PR #3514 merges. Issue is architectural (missing TFM), not code defect."
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net10.0",
    "packages": [
      { "name": "SkiaSharp", "version": "3.116.1" },
      { "name": "SkiaSharp.Views.Blazor", "version": "3.116.1" }
    ]
  },
  "artifacts": [
    {
      "filename": "skiasharp.views.blazor.3.116.1.nupkg",
      "description": "SkiaSharp.Views.Blazor 3.116.1 - inspected for TFM verification",
      "source": "external",
      "url": "https://api.nuget.org/v3-flatcontainer/skiasharp.views.blazor/3.116.1/skiasharp.views.blazor.3.116.1.nupkg",
      "available": true
    },
    {
      "filename": "skiasharp.views.blazor.3.119.2-preview.1.nupkg",
      "description": "SkiaSharp.Views.Blazor 3.119.2-preview.1 - inspected for TFM verification",
      "source": "external",
      "url": "https://api.nuget.org/v3-flatcontainer/skiasharp.views.blazor/3.119.2-preview.1/skiasharp.views.blazor.3.119.2-preview.1.nupkg",
      "available": true
    }
  ],
  "errorMessages": {
    "primaryError": "System.DllNotFoundException: libSkiaSharp",
    "additionalErrors": ["Reported by user - browser runtime error"]
  },
  "blockers": [
    "Browser GUI required to fully observe runtime DllNotFoundException - confirmed TFM gap through package inspection instead"
  ],
  "feedback": {
    "triageCorrections": [
      {
        "topic": "labels",
        "upstream": "Labeled as os/Windows-Classic and area/libSkiaSharp.native",
        "corrected": "Should be os/WASM and area/SkiaSharp.Views.Blazor - WASM static linking and TFM issue, not Windows-specific or native loading problem"
      }
    ]
  }
}
