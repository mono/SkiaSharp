{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3396,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T19:01:50Z"
  },
  "inputs": {
    "triageFile": "ai-triage/3396.json"
  },
  "conclusion": "needs-platform",
  "notes": "Unity WebGL is not an officially supported platform for SkiaSharp. The NativeAssets.WebAssembly package requires .NET SDK MSBuild integration (UsingMicrosoftNETSdkBlazorWebAssembly or UsingMicrosoftNETSdkWebAssembly properties) to trigger static linking of libSkiaSharp.a via NativeFileReference items. Unity WebGL uses its own IL2CPP/Mono-based WASM build pipeline that does not process MSBuild NativeFileReference targets. Cannot reproduce the DllNotFoundException without Unity Editor installation (5GB+ download, license required), but verified the root cause by inspecting package structure and MSBuild targets.",
  "assessment": "docs-gap",
  "reproductionTime": "~20 minutes",
  "versionResults": [
    {
      "version": "3.116.1",
      "source": "nuget",
      "result": "not-tested",
      "notes": "Unity WebGL unavailable - would require Unity Editor installation and WebGL build module"
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      {
        "name": "SkiaSharp",
        "version": "3.116.1"
      },
      {
        "name": "SkiaSharp.NativeAssets.WebAssembly",
        "version": "3.116.1"
      },
      {
        "name": "SkiaSharp.Views.Blazor",
        "version": "3.116.1"
      }
    ]
  },
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create Blazor WebAssembly project to verify SkiaSharp WASM works with .NET SDK (supported platform)",
      "layer": "setup",
      "command": "dotnet new blazorwasm -n BlazorWasmTest --framework net8.0",
      "exitCode": 0,
      "output": "The template \"Blazor WebAssembly Standalone App\" was created successfully.\n\nProcessing post-creation actions...\nRestoring $HOME/tmp/repro-3396/BlazorWasmTest/BlazorWasmTest.csproj:\n  Determining projects to restore...\n  Restored $HOME/tmp/repro-3396/BlazorWasmTest/BlazorWasmTest.csproj (in 11.2 sec).\nRestore succeeded.",
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Add SkiaSharp packages including NativeAssets.WebAssembly",
      "layer": "setup",
      "command": "dotnet add package SkiaSharp --version 3.116.1 && dotnet add package SkiaSharp.NativeAssets.WebAssembly --version 3.116.1 && dotnet add package SkiaSharp.Views.Blazor --version 3.116.1",
      "exitCode": 0,
      "output": "info : PackageReference for package 'SkiaSharp' version '3.116.1' added to file '$HOME/tmp/repro-3396/BlazorWasmTest/BlazorWasmTest.csproj'.\ninfo : PackageReference for package 'SkiaSharp.NativeAssets.WebAssembly' version '3.116.1' added to file '$HOME/tmp/repro-3396/BlazorWasmTest/BlazorWasmTest.csproj'.\ninfo : PackageReference for package 'SkiaSharp.Views.Blazor' version '3.116.1' added to file '$HOME/tmp/repro-3396/BlazorWasmTest/BlazorWasmTest.csproj'.\nlog  : Restored $HOME/tmp/repro-3396/BlazorWasmTest/BlazorWasmTest.csproj (in 1.29 sec).",
      "filesCreated": [
        {
          "filename": "Program.cs",
          "description": "Modified Program.cs to test SkiaSharp initialization at startup",
          "content": "using Microsoft.AspNetCore.Components.Web;\nusing Microsoft.AspNetCore.Components.WebAssembly.Hosting;\nusing BlazorWasmTest;\nusing SkiaSharp;\n\nvar builder = WebAssemblyHostBuilder.CreateDefault(args);\nbuilder.RootComponents.Add<App>(\"#app\");\nbuilder.RootComponents.Add<HeadOutlet>(\"head::after\");\n\nbuilder.Services.AddScoped(sp => new HttpClient { BaseAddress = new Uri(builder.HostEnvironment.BaseAddress) });\n\n// Test SkiaSharp availability\ntry\n{\n    var info = new SKImageInfo(100, 100);\n    using var surface = SKSurface.Create(info);\n    using var canvas = surface.Canvas;\n    canvas.Clear(SKColors.White);\n    using var paint = new SKPaint { Color = SKColors.Blue };\n    canvas.DrawCircle(50, 50, 40, paint);\n    Console.WriteLine(\"✓ SkiaSharp initialized successfully\");\n}\ncatch (Exception ex)\n{\n    Console.WriteLine($\"✗ SkiaSharp failed: {ex.GetType().Name}: {ex.Message}\");\n}\n\nawait builder.Build().RunAsync();"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Build Blazor WASM project - expected warning about native linking not enabled",
      "layer": "csharp",
      "command": "dotnet build",
      "exitCode": 0,
      "output": "  Determining projects to restore...\n  All projects are up-to-date for restore.\n  BlazorWasmTest -> $HOME/tmp/repro-3396/BlazorWasmTest/bin/Debug/net8.0/BlazorWasmTest.dll\n  BlazorWasmTest (Blazor output) -> $HOME/tmp/repro-3396/BlazorWasmTest/bin/Debug/net8.0/wwwroot\nWorkloadManifest.targets(124,5): warning : @(NativeFileReference) is not empty, but the native references won't be linked in, because neither $(WasmBuildNative), nor $(RunAOTCompilation) are 'true'. NativeFileReference=$HOME/.nuget/packages/skiasharp.nativeassets.webassembly/3.116.1/buildTransitive/netstandard1.0/libSkiaSharp.a/3.1.34/st/libSkiaSharp.a\n\nBuild succeeded.\n\n    1 Warning(s)\n    0 Error(s)\n\nTime Elapsed 00:00:09.06",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Enable WasmBuildNative to trigger native linking (requires wasm-tools workload)",
      "layer": "setup",
      "command": "dotnet build",
      "exitCode": 1,
      "output": "  Determining projects to restore...\nerror NETSDK1147: To build this project, the following workloads must be installed: wasm-tools-net8\nerror NETSDK1147: To install these workloads, run the following command: dotnet workload restore\n\nBuild FAILED.\n\n    0 Warning(s)\n    1 Error(s)\n\nTime Elapsed 00:00:00.35",
      "filesCreated": [
        {
          "filename": "BlazorWasmTest.csproj",
          "description": "Project file with WasmBuildNative enabled",
          "content": "<Project Sdk=\"Microsoft.NET.Sdk.BlazorWebAssembly\">\n\n  <PropertyGroup>\n    <TargetFramework>net8.0</TargetFramework>\n    <Nullable>enable</Nullable>\n    <ImplicitUsings>enable</ImplicitUsings>\n    <WasmBuildNative>true</WasmBuildNative>\n  </PropertyGroup>\n\n  <ItemGroup>\n    <PackageReference Include=\"Microsoft.AspNetCore.Components.WebAssembly\" Version=\"8.0.23\" />\n    <PackageReference Include=\"Microsoft.AspNetCore.Components.WebAssembly.DevServer\" Version=\"8.0.23\" PrivateAssets=\"all\" />\n    <PackageReference Include=\"SkiaSharp\" Version=\"3.116.1\" />\n    <PackageReference Include=\"SkiaSharp.NativeAssets.WebAssembly\" Version=\"3.116.1\" />\n    <PackageReference Include=\"SkiaSharp.Views.Blazor\" Version=\"3.116.1\" />\n  </ItemGroup>\n\n</Project>"
        }
      ],
      "result": "failure"
    },
    {
      "stepNumber": 5,
      "description": "Inspect SkiaSharp.NativeAssets.WebAssembly package to verify Unity is unsupported",
      "layer": "setup",
      "command": "cat $HOME/.nuget/packages/skiasharp.nativeassets.webassembly/3.116.1/buildTransitive/netstandard1.0/SkiaSharp.NativeAssets.WebAssembly.targets",
      "exitCode": 0,
      "output": "MSBuild targets show explicit checks for .NET SDK WASM properties:\n\n<PropertyGroup Condition=\"('$(UsingMicrosoftNETSdkBlazorWebAssembly)' == 'true' or '$(UsingMicrosoftNETSdkWebAssembly)' == 'true') and '$(ShouldIncludeNativeSkiaSharp)' == 'True'\">\n\nAlso includes Uno Platform support (lines 9-19) but NO Unity support. Unity WebGL uses its own Emscripten pipeline that does not set these MSBuild properties, so the .a files are never passed to the linker.",
      "result": "success"
    }
  ],
  "artifacts": [
    {
      "filename": "libSkiaSharp.a",
      "description": "Static library for Emscripten 3.1.34 (single-threaded, no SIMD) - user manually tried placing this in Unity project",
      "source": "external",
      "url": "https://www.nuget.org/packages/SkiaSharp.NativeAssets.WebAssembly/3.116.1",
      "available": true
    }
  ],
  "errorMessages": {
    "primaryError": "DllNotFoundException: libSkiaSharp",
    "additionalErrors": [
      "NETSDK1147: wasm-tools-net8 workload required for native linking (requires elevated permissions)"
    ]
  },
  "environment": {
    "os": "macOS (Darwin)",
    "arch": "arm64",
    "dotnetVersion": "8.0.417",
    "skiaSharpVersion": "3.116.1",
    "dockerUsed": false
  },
  "blockers": [
    "Unity Editor not installed (5GB+ download required)",
    "Unity WebGL build module not installed",
    "Unity license required for WebGL builds",
    "wasm-tools-net8 workload requires elevated permissions (sudo) to install",
    "Cannot verify actual DllNotFoundException without Unity runtime environment"
  ],
  "feedback": {
    "triageCorrections": [
      {
        "topic": "classification",
        "upstream": "Classified as type/question with confidence 0.70",
        "corrected": "This is a legitimate bug report (DllNotFoundException) for an unsupported platform. Should be type/feature-request or type/enhancement to add Unity WebGL support, not type/question. The user is reporting a real error, not asking how to use the API."
      }
    ]
  }
}
