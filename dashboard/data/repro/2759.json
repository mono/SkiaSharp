{
  "meta": {
    "schemaVersion": "1.0",
    "number": 2759,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T17:45:00Z"
  },
  "conclusion": "not-reproduced",
  "notes": "Tested SKBitmap.Decode with multiple PNG types (16-bit RGB, 8-bit RGBA, 8-bit colormap/palette, large 8-bit RGBA) across SkiaSharp 2.88.3, 2.88.6, 3.119.2, and main (source). All decodes succeeded on all versions. Also tested edge cases: truncated PNGs (10%, 50%, 90%), empty files, header-only files, and non-existent paths \u2014 all behaved correctly. The reporter\u0027s specific PNG file (image1.png) was never attached to the issue, making it impossible to reproduce the exact failure. The original #933/#1981 was a zlib SSE decompression bug fixed in 2.88.1. Without the reporter\u0027s specific image, we cannot determine whether their PNG triggers a different code path. The reporter was asked (via triage) to provide the sample file but never responded.",
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create standalone console project with SkiaSharp 2.88.3 and copy test PNG files (baboon.png 16-bit RGB, color-wheel.png 8-bit RGBA, index8.png 8-bit colormap, testimage.png 8-bit RGBA)",
      "layer": "setup",
      "command": "dotnet new console -n Repro --framework net8.0 \u0026\u0026 cd Repro \u0026\u0026 dotnet add package SkiaSharp --version 2.88.3",
      "exitCode": 0,
      "output": "The template \u0022Console App\u0022 was created successfully.\nPackageReference for package \u0027SkiaSharp\u0027 version \u00272.88.3\u0027 added.",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "Console project targeting net8.0 with SkiaSharp 2.88.3",
          "content": "\u003CProject Sdk=\u0022Microsoft.NET.Sdk\u0022\u003E\n\n  \u003CPropertyGroup\u003E\n    \u003COutputType\u003EExe\u003C/OutputType\u003E\n    \u003CTargetFramework\u003Enet8.0\u003C/TargetFramework\u003E\n    \u003CImplicitUsings\u003Eenable\u003C/ImplicitUsings\u003E\n    \u003CNullable\u003Eenable\u003C/Nullable\u003E\n  \u003C/PropertyGroup\u003E\n\n  \u003CItemGroup\u003E\n    \u003CPackageReference Include=\u0022SkiaSharp\u0022 Version=\u00222.88.3\u0022 /\u003E\n  \u003C/ItemGroup\u003E\n\n\u003C/Project\u003E"
        },
        {
          "filename": "Program.cs",
          "description": "Reproduction code testing SKBitmap.Decode with multiple PNG types via file path, stream, and byte array",
          "content": "using System;\nusing System.IO;\nusing System.Runtime.InteropServices;\nusing SkiaSharp;\n\nConsole.WriteLine($\u0022SkiaSharp version: {typeof(SKBitmap).Assembly.GetName().Version}\u0022);\nConsole.WriteLine($\u0022OS: {RuntimeInformation.OSDescription}\u0022);\nConsole.WriteLine($\u0022Arch: {RuntimeInformation.ProcessArchitecture}\u0022);\nConsole.WriteLine();\n\nvar pngFiles = new[]\n{\n    \u0022baboon.png\u0022,      // 16-bit RGB\n    \u0022color-wheel.png\u0022, // 8-bit RGBA\n    \u0022index8.png\u0022,      // 8-bit colormap (palette)\n    \u0022testimage.png\u0022,   // 8-bit RGBA large\n};\n\nint failures = 0;\nforeach (var file in pngFiles)\n{\n    var path = Path.Combine(AppContext.BaseDirectory, file);\n    if (!File.Exists(path))\n        path = Path.Combine(Directory.GetCurrentDirectory(), file);\n    if (!File.Exists(path))\n    {\n        Console.WriteLine($\u0022[SKIP] {file} - not found\u0022);\n        continue;\n    }\n\n    var bmp = SKBitmap.Decode(path);\n    if (bmp == null)\n    {\n        Console.WriteLine($\u0022[FAIL] SKBitmap.Decode(\\\u0022{file}\\\u0022) returned null\u0022);\n        failures\u002B\u002B;\n        using var codec = SKCodec.Create(path, out var codecResult);\n        Console.WriteLine($\u0022       SKCodec.Create result: {codecResult}, codec null: {codec == null}\u0022);\n    }\n    else\n    {\n        Console.WriteLine($\u0022[PASS] {file}: {bmp.Width}x{bmp.Height}, ColorType={bmp.ColorType}, AlphaType={bmp.AlphaType}\u0022);\n        bmp.Dispose();\n    }\n}\n\nConsole.WriteLine();\nConsole.WriteLine(\u0022--- Stream decode test ---\u0022);\nforeach (var file in pngFiles)\n{\n    var path = Path.Combine(AppContext.BaseDirectory, file);\n    if (!File.Exists(path))\n        path = Path.Combine(Directory.GetCurrentDirectory(), file);\n    if (!File.Exists(path)) continue;\n\n    using var stream = File.OpenRead(path);\n    using var skStream = new SKManagedStream(stream);\n    using var codec = SKCodec.Create(skStream, out var result);\n    if (codec == null)\n    {\n        Console.WriteLine($\u0022[FAIL] SKCodec.Create(stream) for {file}: result={result}\u0022);\n        failures\u002B\u002B;\n    }\n    else\n        Console.WriteLine($\u0022[PASS] {file}: codec OK, format={codec.EncodedFormat}, result={result}\u0022);\n}\n\nConsole.WriteLine();\nConsole.WriteLine(\u0022--- Byte array decode test ---\u0022);\nforeach (var file in pngFiles)\n{\n    var path = Path.Combine(AppContext.BaseDirectory, file);\n    if (!File.Exists(path))\n        path = Path.Combine(Directory.GetCurrentDirectory(), file);\n    if (!File.Exists(path)) continue;\n\n    var bytes = File.ReadAllBytes(path);\n    using var data = SKData.CreateCopy(bytes);\n    using var bmp = SKBitmap.Decode(data);\n    if (bmp == null)\n    {\n        Console.WriteLine($\u0022[FAIL] SKBitmap.Decode(SKData) for {file} returned null\u0022);\n        failures\u002B\u002B;\n    }\n    else\n        Console.WriteLine($\u0022[PASS] {file}: {bmp.Width}x{bmp.Height}\u0022);\n}\n\nConsole.WriteLine();\nConsole.WriteLine($\u0022Total failures: {failures}\u0022);\nreturn failures \u003E 0 ? 1 : 0;"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Run reproduction with SkiaSharp 2.88.3 \u2014 test SKBitmap.Decode(string) with 4 PNG types plus stream and byte array decode paths",
      "layer": "csharp",
      "command": "dotnet run",
      "exitCode": 0,
      "output": "SkiaSharp version: 2.88.0.0\n\n[PASS] baboon.png: 512x512, ColorType=Rgba8888, AlphaType=Opaque\n[PASS] color-wheel.png: 128x128, ColorType=Rgba8888, AlphaType=Premul\n[PASS] index8.png: 1024x1218, ColorType=Rgba8888, AlphaType=Premul\n[PASS] testimage.png: 1920x1080, ColorType=Rgba8888, AlphaType=Premul\n\n--- Stream decode test ---\n[PASS] baboon.png: codec OK, format=Png, result=Success\n[PASS] color-wheel.png: codec OK, format=Png, result=Success\n[PASS] index8.png: codec OK, format=Png, result=Success\n[PASS] testimage.png: codec OK, format=Png, result=Success\n\n--- Byte array decode test ---\n[PASS] baboon.png: 512x512\n[PASS] color-wheel.png: 128x128\n[PASS] index8.png: 1024x1218\n[PASS] testimage.png: 1920x1080\n\nTotal failures: 0",
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Test edge cases: large 4096x4096 gradient PNG, truncated PNGs at 10%/50%/90%, empty file, header-only file, non-existent path",
      "layer": "csharp",
      "command": "dotnet run (with edge-case Program.cs)",
      "exitCode": 0,
      "output": "--- Edge case: Large gradient PNG ---\n[PASS] Large gradient: 4096x4096\n--- Edge case: Truncated PNG ---\n  Truncated at 10%: Decode=True, Codec=True, Result=Success\n  Truncated at 50%: Decode=True, Codec=True, Result=Success\n  Truncated at 90%: Decode=True, Codec=True, Result=Success\n--- Edge case: Empty file ---\n  Empty file: Decode=False (null expected)\n--- Edge case: PNG header only ---\n  Header-only: Decode=False (null expected)\n--- Edge case: Non-existent file ---\n  Non-existent: Decode=False\n\nTotal edge-case failures (unexpected null on valid PNG): 0",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Test with SkiaSharp 2.88.6 (version mentioned in issue body)",
      "layer": "csharp",
      "command": "dotnet add package SkiaSharp --version 2.88.6 \u0026\u0026 dotnet run",
      "exitCode": 0,
      "output": "SkiaSharp version: 2.88.0.0\n[PASS] baboon.png: 512x512, ColorType=Rgba8888, AlphaType=Opaque\n[PASS] color-wheel.png: 128x128, ColorType=Rgba8888, AlphaType=Premul\n[PASS] index8.png: 1024x1218, ColorType=Rgba8888, AlphaType=Premul\n[PASS] testimage.png: 1920x1080, ColorType=Rgba8888, AlphaType=Premul\nTotal failures: 0",
      "result": "success"
    },
    {
      "stepNumber": 5,
      "description": "Test with latest SkiaSharp 3.119.2 (latest stable)",
      "layer": "csharp",
      "command": "dotnet add package SkiaSharp \u0026\u0026 dotnet run",
      "exitCode": 0,
      "output": "SkiaSharp version: 3.119.0.0\n[PASS] baboon.png: 512x512, ColorType=Rgba8888, AlphaType=Opaque\n[PASS] color-wheel.png: 128x128, ColorType=Rgba8888, AlphaType=Premul\n[PASS] index8.png: 1024x1218, ColorType=Rgba8888, AlphaType=Premul\n[PASS] testimage.png: 1920x1080, ColorType=Rgba8888, AlphaType=Premul\nTotal failures: 0",
      "result": "success"
    },
    {
      "stepNumber": 6,
      "description": "Build and run existing decode tests on main branch (source) \u2014 CanDecodePotentiallyCorruptPngFiles, CanDecodeImageStreams, TestBitmapDecodeDrawsCorrectly",
      "layer": "csharp",
      "command": "dotnet test tests/SkiaSharp.Tests.Console/SkiaSharp.Tests.Console.csproj --no-build --filter \u0022FullyQualifiedName~SKBitmapTest.TestBitmapDecodeDrawsCorrectly|FullyQualifiedName~SKBitmapTest.CanDecodePotentiallyCorruptPngFiles|FullyQualifiedName~SKBitmapTest.CanDecodeImageStreams\u0022",
      "exitCode": 0,
      "output": "Passed!  - Failed:     0, Passed:     7, Skipped:     0, Total:     7, Duration: 74 ms - SkiaSharp.Tests.dll (net8.0)",
      "result": "success"
    }
  ],
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "8.0.417",
    "skiaSharpVersion": "2.88.3",
    "dockerUsed": false
  },
  "inputs": {
    "triageFile": "ai-triage/2759.json"
  },
  "assessment": "unknown",
  "reproductionTime": "~12 minutes",
  "versionResults": [
    {
      "version": "2.88.3",
      "source": "nuget",
      "result": "not-reproduced",
      "notes": "All 4 PNG types decoded successfully via SKBitmap.Decode(string), SKCodec.Create(stream), and SKBitmap.Decode(SKData)."
    },
    {
      "version": "2.88.6",
      "source": "nuget",
      "result": "not-reproduced",
      "notes": "All 4 PNG types decoded successfully. Same results as 2.88.3."
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "not-reproduced",
      "notes": "All 4 PNG types decoded successfully on latest stable release."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "not-reproduced",
      "notes": "Ran 7 existing decode-related tests (CanDecodePotentiallyCorruptPngFiles, CanDecodeImageStreams, TestBitmapDecodeDrawsCorrectly) \u2014 all passed."
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      {
        "name": "SkiaSharp",
        "version": "2.88.3"
      }
    ]
  },
  "artifacts": [
    {
      "filename": "image1.png",
      "description": "Reporter\u0027s PNG file that fails to decode. Never attached to the issue \u2014 this is the critical missing artifact preventing reproduction.",
      "source": "issue-attachment",
      "available": false
    }
  ],
  "feedback": {
    "triageCorrections": [
      {
        "topic": "reproduction-feasibility",
        "upstream": "Triage recommended requesting sample image (actionability: request-info, confidence 0.90)",
        "corrected": "Confirmed: without the reporter\u0027s specific PNG file, the bug cannot be reproduced. All standard PNG types (16-bit RGB, 8-bit RGBA, 8-bit colormap) and edge cases (truncated, large, empty) decode correctly across all tested versions."
      }
    ]
  }
}