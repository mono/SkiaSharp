{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3421,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T17:55:00Z"
  },
  "conclusion": "reproduced",
  "notes": "Reproduced on macOS arm64: Animation.Create() returns null when given a .lottie file (dotLottie ZIP format) because Skottie only parses raw Lottie JSON. Raw .json files and JSON strings load successfully. The .lottie format is a ZIP archive containing Lottie JSON animations \u2014 Skia\u0027s Skottie module has no ZIP extraction support. This behavior is consistent across 3.116.0, 3.119.2, and main. While Skottie was never designed to handle dotLottie format, the silent null return on a common file format (.lottie is now the default download from LottieFiles) represents a usability gap.",
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create standalone console project with SkiaSharp 3.116.0 and SkiaSharp.Skottie",
      "layer": "setup",
      "command": "mkdir -p /tmp/repro-3421 \u0026\u0026 cd /tmp/repro-3421 \u0026\u0026 dotnet new console -n Repro --framework net8.0 \u0026\u0026 cd Repro \u0026\u0026 dotnet add package SkiaSharp --version 3.116.0 \u0026\u0026 dotnet add package SkiaSharp.Skottie --version 3.116.0",
      "exitCode": 0,
      "output": "Restore succeeded.",
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Write reproduction code: creates a minimal Lottie JSON, a .lottie ZIP file (dotLottie format), and tests Animation.Create with both formats",
      "layer": "csharp",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "Console project referencing SkiaSharp and SkiaSharp.Skottie 3.116.0",
          "content": "\u003CProject Sdk=\u0022Microsoft.NET.Sdk\u0022\u003E\n  \u003CPropertyGroup\u003E\n    \u003COutputType\u003EExe\u003C/OutputType\u003E\n    \u003CTargetFramework\u003Enet8.0\u003C/TargetFramework\u003E\n    \u003CImplicitUsings\u003Eenable\u003C/ImplicitUsings\u003E\n    \u003CNullable\u003Eenable\u003C/Nullable\u003E\n  \u003C/PropertyGroup\u003E\n  \u003CItemGroup\u003E\n    \u003CPackageReference Include=\u0022SkiaSharp\u0022 Version=\u00223.116.0\u0022 /\u003E\n    \u003CPackageReference Include=\u0022SkiaSharp.Skottie\u0022 Version=\u00223.116.0\u0022 /\u003E\n  \u003C/ItemGroup\u003E\n\u003C/Project\u003E"
        },
        {
          "filename": "Program.cs",
          "description": "Reproduction code that tests Animation.Create with raw .json, .lottie ZIP, and JSON string parsing",
          "content": "using System;\nusing System.IO;\nusing System.IO.Compression;\nusing SkiaSharp.Skottie;\n\n// Minimal valid Lottie JSON animation\nvar lottieJson = @\u0022{\n  \u0022\u0022v\u0022\u0022: \u0022\u00225.5.2\u0022\u0022,\n  \u0022\u0022fr\u0022\u0022: 30,\n  \u0022\u0022ip\u0022\u0022: 0,\n  \u0022\u0022op\u0022\u0022: 60,\n  \u0022\u0022w\u0022\u0022: 100,\n  \u0022\u0022h\u0022\u0022: 100,\n  \u0022\u0022layers\u0022\u0022: [\n    {\n      \u0022\u0022ty\u0022\u0022: 1,\n      \u0022\u0022sc\u0022\u0022: \u0022\u0022#ff0000\u0022\u0022,\n      \u0022\u0022ip\u0022\u0022: 0,\n      \u0022\u0022op\u0022\u0022: 60,\n      \u0022\u0022st\u0022\u0022: 0,\n      \u0022\u0022sr\u0022\u0022: 1,\n      \u0022\u0022sw\u0022\u0022: 100,\n      \u0022\u0022sh\u0022\u0022: 100,\n      \u0022\u0022ks\u0022\u0022: {\n        \u0022\u0022o\u0022\u0022: { \u0022\u0022a\u0022\u0022: 0, \u0022\u0022k\u0022\u0022: 100 },\n        \u0022\u0022r\u0022\u0022: { \u0022\u0022a\u0022\u0022: 0, \u0022\u0022k\u0022\u0022: 0 },\n        \u0022\u0022p\u0022\u0022: { \u0022\u0022a\u0022\u0022: 0, \u0022\u0022k\u0022\u0022: [50, 50] },\n        \u0022\u0022a\u0022\u0022: { \u0022\u0022a\u0022\u0022: 0, \u0022\u0022k\u0022\u0022: [50, 50] },\n        \u0022\u0022s\u0022\u0022: { \u0022\u0022a\u0022\u0022: 0, \u0022\u0022k\u0022\u0022: [100, 100] }\n      }\n    }\n  ]\n}\u0022;\n\n// Test 1: Raw Lottie JSON file (.json)\nvar jsonPath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)!, \u0022test.json\u0022);\nFile.WriteAllText(jsonPath, lottieJson);\nConsole.WriteLine($\u0022Test 1: Loading raw Lottie JSON file (.json)\u0022);\nvar jsonAnimation = Animation.Create(jsonPath);\nConsole.WriteLine($\u0022  Result: {(jsonAnimation != null ? \u0022SUCCESS - Animation loaded\u0022 : \u0022NULL - Animation is null\u0022)}\u0022);\nif (jsonAnimation != null)\n{\n    Console.WriteLine($\u0022  Duration: {jsonAnimation.Duration.TotalSeconds}s, Size: {jsonAnimation.Size}, FPS: {jsonAnimation.Fps}\u0022);\n    jsonAnimation.Dispose();\n}\n\n// Test 2: dotLottie file (.lottie) - this is a ZIP archive containing the JSON\nvar lottiePath = Path.Combine(Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)!, \u0022test.lottie\u0022);\nusing (var zipStream = new FileStream(lottiePath, FileMode.Create))\nusing (var archive = new ZipArchive(zipStream, ZipArchiveMode.Create))\n{\n    var manifest = archive.CreateEntry(\u0022manifest.json\u0022);\n    using (var writer = new StreamWriter(manifest.Open()))\n        writer.Write(@\u0022{\u0022\u0022generator\u0022\u0022:\u0022\u0022test\u0022\u0022,\u0022\u0022version\u0022\u0022:1,\u0022\u0022animations\u0022\u0022:[{\u0022\u0022id\u0022\u0022:\u0022\u0022test\u0022\u0022,\u0022\u0022speed\u0022\u0022:1}]}\u0022);\n    var anim = archive.CreateEntry(\u0022animations/test.json\u0022);\n    using (var writer = new StreamWriter(anim.Open()))\n        writer.Write(lottieJson);\n}\n\nConsole.WriteLine();\nConsole.WriteLine($\u0022Test 2: Loading dotLottie file (.lottie) - ZIP archive\u0022);\nvar lottieAnimation = Animation.Create(lottiePath);\nConsole.WriteLine($\u0022  Result: {(lottieAnimation != null ? \u0022SUCCESS - Animation loaded\u0022 : \u0022NULL - Animation is null\u0022)}\u0022);\nif (lottieAnimation != null)\n{\n    Console.WriteLine($\u0022  Duration: {lottieAnimation.Duration.TotalSeconds}s, Size: {lottieAnimation.Size}\u0022);\n    lottieAnimation.Dispose();\n}\n\n// Test 3: Animation.Parse with raw JSON string (baseline)\nConsole.WriteLine();\nConsole.WriteLine($\u0022Test 3: Parsing raw Lottie JSON string via Animation.Parse()\u0022);\nvar parsedAnimation = Animation.Parse(lottieJson);\nConsole.WriteLine($\u0022  Result: {(parsedAnimation != null ? \u0022SUCCESS - Animation loaded\u0022 : \u0022NULL - Animation is null\u0022)}\u0022);\nif (parsedAnimation != null)\n{\n    Console.WriteLine($\u0022  Duration: {parsedAnimation.Duration.TotalSeconds}s, Size: {parsedAnimation.Size}, FPS: {parsedAnimation.Fps}\u0022);\n    parsedAnimation.Dispose();\n}\n\nConsole.WriteLine();\nConsole.WriteLine(\u0022Summary:\u0022);\nConsole.WriteLine($\u0022  JSON file (.json):    {(jsonAnimation != null ? \u0022WORKS\u0022 : \u0022NULL\u0022)}\u0022);\nConsole.WriteLine($\u0022  dotLottie (.lottie):  {(lottieAnimation != null ? \u0022WORKS\u0022 : \u0022NULL\u0022)}\u0022);\nConsole.WriteLine($\u0022  JSON string parse:    {(parsedAnimation != null ? \u0022WORKS\u0022 : \u0022NULL\u0022)}\u0022);"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Run reproduction with SkiaSharp 3.116.0 \u2014 raw JSON works, .lottie ZIP returns null",
      "layer": "csharp",
      "command": "cd /tmp/repro-3421/Repro \u0026\u0026 dotnet run",
      "exitCode": 0,
      "output": "Test 1: Loading raw Lottie JSON file (.json)\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nTest 2: Loading dotLottie file (.lottie) - ZIP archive\n  Result: NULL - Animation is null\n\nTest 3: Parsing raw Lottie JSON string via Animation.Parse()\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nSummary:\n  JSON file (.json):    WORKS\n  dotLottie (.lottie):  NULL\n  JSON string parse:    WORKS",
      "result": "wrong-output"
    },
    {
      "stepNumber": 4,
      "description": "Update to latest SkiaSharp 3.119.2 and retest \u2014 same result",
      "layer": "csharp",
      "command": "cd /tmp/repro-3421/Repro \u0026\u0026 dotnet add package SkiaSharp --version 3.119.2 \u0026\u0026 dotnet add package SkiaSharp.Skottie --version 3.119.2 \u0026\u0026 dotnet run",
      "exitCode": 0,
      "output": "Test 1: Loading raw Lottie JSON file (.json)\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nTest 2: Loading dotLottie file (.lottie) - ZIP archive\n  Result: NULL - Animation is null\n\nTest 3: Parsing raw Lottie JSON string via Animation.Parse()\n  Result: SUCCESS - Animation loaded\n  Duration: 2s, Size: {Width=100, Height=100}, FPS: 30\n\nSummary:\n  JSON file (.json):    WORKS\n  dotLottie (.lottie):  NULL\n  JSON string parse:    WORKS",
      "result": "wrong-output"
    },
    {
      "stepNumber": 5,
      "description": "Test on main branch via xUnit test \u2014 .lottie ZIP returns null, raw JSON works",
      "layer": "csharp",
      "command": "dotnet test tests/SkiaSharp.Tests.Console/SkiaSharp.Tests.Console.csproj --no-build --filter \u0022FullyQualifiedName~DotLottieZipReturnsNull\u0022",
      "exitCode": 0,
      "output": "Passed!  - Failed: 0, Passed: 1, Skipped: 0, Total: 1",
      "result": "success"
    }
  ],
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "8.0.417",
    "skiaSharpVersion": "3.116.0",
    "dockerUsed": false
  },
  "inputs": {
    "triageFile": "ai-triage/3421.json"
  },
  "assessment": "likely-bug",
  "reproductionTime": "~8 minutes",
  "versionResults": [
    {
      "version": "3.116.0",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Animation.Create returns null for .lottie ZIP file; raw JSON works fine."
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Same behavior on latest stable release."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "reproduced",
      "notes": "Confirmed via xUnit test on main branch \u2014 .lottie ZIP returns null, raw JSON works."
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      {
        "name": "SkiaSharp",
        "version": "3.116.0"
      },
      {
        "name": "SkiaSharp.Skottie",
        "version": "3.116.0"
      }
    ]
  },
  "errorMessages": {
    "primaryError": "Animation.Create() returns null when given a .lottie file (dotLottie ZIP format). No exception thrown \u2014 silent failure."
  },
  "feedback": {
    "triageCorrections": [
      {
        "topic": "classification",
        "upstream": "Classified as type/question with confidence 0.8",
        "corrected": "Reproduction confirms Animation.Create returns null for .lottie files. While this could be considered \u0027working as designed\u0027 (Skottie only supports JSON), the silent null return on a common format is a usability gap that could warrant either format detection or a better error signal. Classified as likely-bug rather than question."
      }
    ]
  }
}