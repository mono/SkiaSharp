{
  "meta": {
    "schemaVersion": "1.0",
    "number": 3421,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-13T16:20:50Z"
  },
  "conclusion": "reproduced",
  "notes": "Reproduced as reported: Animation.Create() returns null when given a .lottie file (dotLottie ZIP archive format). This is expected behavior \u2014 Skia\u0027s Skottie module only parses raw Lottie JSON, not the dotLottie container format (which is a ZIP archive containing JSON animations \u002B manifest). The reporter likely downloaded a .lottie file from LottieFiles, which defaults to the dotLottie format. The workaround is to either download the raw .json format from LottieFiles or extract the JSON from the .lottie ZIP before passing it to Animation.Create().",
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create console project and add SkiaSharp.Skottie 3.116.0 (reporter\u0027s version)",
      "layer": "setup",
      "command": "mkdir -p /tmp/repro-3421 \u0026\u0026 cd /tmp/repro-3421 \u0026\u0026 dotnet new console -n Repro --framework net8.0 \u0026\u0026 cd Repro \u0026\u0026 dotnet add package SkiaSharp.Skottie --version 3.116.0",
      "exitCode": 0,
      "output": "PackageReference for package \u0027SkiaSharp.Skottie\u0027 version \u00273.116.0\u0027 added.",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "Console project referencing SkiaSharp.Skottie 3.116.0",
          "content": "\u003CProject Sdk=\u0022Microsoft.NET.Sdk\u0022\u003E\n  \u003CPropertyGroup\u003E\n    \u003COutputType\u003EExe\u003C/OutputType\u003E\n    \u003CTargetFramework\u003Enet8.0\u003C/TargetFramework\u003E\n    \u003CImplicitUsings\u003Eenable\u003C/ImplicitUsings\u003E\n    \u003CNullable\u003Eenable\u003C/Nullable\u003E\n  \u003C/PropertyGroup\u003E\n  \u003CItemGroup\u003E\n    \u003CPackageReference Include=\u0022SkiaSharp.Skottie\u0022 Version=\u00223.116.0\u0022 /\u003E\n  \u003C/ItemGroup\u003E\n\u003C/Project\u003E"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Write reproduction code that creates a .lottie (ZIP) file and a raw .json Lottie file, then tests Animation.Create() with both",
      "layer": "csharp",
      "filesCreated": [
        {
          "filename": "Program.cs",
          "description": "Repro code: creates minimal Lottie JSON and dotLottie ZIP, tests Animation.Create() with both formats",
          "content": "using System;\nusing System.IO;\nusing System.IO.Compression;\nusing SkiaSharp;\nusing SkiaSharp.Skottie;\n\nstring lottieJson = \u0022{\\\u0022v\\\u0022:\\\u00225.7.4\\\u0022,\\\u0022fr\\\u0022:30,\\\u0022ip\\\u0022:0,\\\u0022op\\\u0022:60,\\\u0022w\\\u0022:100,\\\u0022h\\\u0022:100,\\\u0022layers\\\u0022:[{\\\u0022ty\\\u0022:1,\\\u0022sc\\\u0022:\\\u0022#ff0000\\\u0022,\\\u0022sw\\\u0022:100,\\\u0022sh\\\u0022:100,\\\u0022ip\\\u0022:0,\\\u0022op\\\u0022:60,\\\u0022st\\\u0022:0,\\\u0022ks\\\u0022:{\\\u0022o\\\u0022:{\\\u0022a\\\u0022:0,\\\u0022k\\\u0022:100},\\\u0022r\\\u0022:{\\\u0022a\\\u0022:0,\\\u0022k\\\u0022:0},\\\u0022p\\\u0022:{\\\u0022a\\\u0022:0,\\\u0022k\\\u0022:[50,50,0]},\\\u0022a\\\u0022:{\\\u0022a\\\u0022:0,\\\u0022k\\\u0022:[50,50,0]},\\\u0022s\\\u0022:{\\\u0022a\\\u0022:0,\\\u0022k\\\u0022:[100,100,100]}}}]}\u0022;\n\nstring dir = Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location)!;\nstring jsonPath = Path.Combine(dir, \u0022test.json\u0022);\nFile.WriteAllText(jsonPath, lottieJson);\n\nstring lottiePath = Path.Combine(dir, \u0022test.lottie\u0022);\nusing (var zip = ZipFile.Open(lottiePath, ZipArchiveMode.Create))\n{\n    var manifestEntry = zip.CreateEntry(\u0022manifest.json\u0022);\n    using (var w = new StreamWriter(manifestEntry.Open())) w.Write(\u0022{\\\u0022generator\\\u0022:\\\u0022test\\\u0022,\\\u0022version\\\u0022:1.0,\\\u0022animations\\\u0022:[{\\\u0022id\\\u0022:\\\u0022animation_0\\\u0022}]}\u0022);\n    var animEntry = zip.CreateEntry(\u0022animations/animation_0.json\u0022);\n    using (var w = new StreamWriter(animEntry.Open())) w.Write(lottieJson);\n}\n\nConsole.WriteLine($\u0022Test 1 (.json): {(Animation.Create(jsonPath) != null ? \u0022NOT NULL\u0022 : \u0022NULL\u0022)}\u0022);\nConsole.WriteLine($\u0022Test 2 (.lottie): {(Animation.Create(lottiePath) != null ? \u0022NOT NULL\u0022 : \u0022NULL\u0022)}\u0022);\nConsole.WriteLine($\u0022Test 3 (.lottie via SKData): {(Animation.Create(SKData.Create(lottiePath)) != null ? \u0022NOT NULL\u0022 : \u0022NULL\u0022)}\u0022);"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Build the reproduction project",
      "layer": "csharp",
      "command": "cd /tmp/repro-3421/Repro \u0026\u0026 dotnet build",
      "exitCode": 0,
      "output": "Build succeeded. 0 Warning(s) 0 Error(s)",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Run reproduction \u2014 Animation.Create() with .lottie (ZIP) file should return null, confirming the reported bug",
      "layer": "csharp",
      "command": "cd /tmp/repro-3421/Repro \u0026\u0026 dotnet run",
      "exitCode": 0,
      "output": "SkiaSharp.Skottie version: 3.116.0.0\nRuntime: .NET 8.0.23\n\n=== Test 1: Load raw .json Lottie file ===\nAnimation from .json: NOT NULL (valid)\n  Duration: 00:00:02s, FPS: 30, Size: {Width=100, Height=100}\n\n=== Test 2: Load .lottie (ZIP) file ===\nAnimation from .lottie: NULL\n  BUG CONFIRMED: .lottie file returns null Animation (silent failure)\n\n=== Test 3: Load .lottie data via SKData ===\nAnimation from .lottie data: NULL\n  BUG CONFIRMED: .lottie data also returns null Animation\n\nSUCCESS: test completed",
      "result": "wrong-output"
    },
    {
      "stepNumber": 5,
      "description": "Test with latest stable SkiaSharp 3.119.2 in fresh project directory",
      "layer": "csharp",
      "command": "mkdir -p /tmp/repro-3421-latest \u0026\u0026 cd /tmp/repro-3421-latest \u0026\u0026 dotnet new console -n Repro --framework net8.0 \u0026\u0026 cd Repro \u0026\u0026 dotnet add package SkiaSharp.Skottie --version 3.119.2 \u0026\u0026 cp /tmp/repro-3421/Repro/Program.cs . \u0026\u0026 dotnet run",
      "exitCode": 0,
      "output": "SkiaSharp.Skottie version: 3.119.0.0\nRuntime: .NET 8.0.23\n\n=== Test 1: Load raw .json Lottie file ===\nAnimation from .json: NOT NULL (valid)\n  Duration: 00:00:02s, FPS: 30, Size: {Width=100, Height=100}\n\n=== Test 2: Load .lottie (ZIP) file ===\nAnimation from .lottie: NULL\n  BUG CONFIRMED: .lottie file returns null Animation (silent failure)\n\n=== Test 3: Load .lottie data via SKData ===\nAnimation from .lottie data: NULL\n  BUG CONFIRMED: .lottie data also returns null Animation\n\nSUCCESS: test completed",
      "result": "wrong-output"
    },
    {
      "stepNumber": 6,
      "description": "Test on main branch source \u2014 run existing Skottie tests (42 tests, all JSON-based) and confirm Animation.Create code has no dotLottie support",
      "layer": "csharp",
      "command": "cd $REPO \u0026\u0026 dotnet test tests/SkiaSharp.Tests.Console/SkiaSharp.Tests.Console.csproj --filter \u0022FullyQualifiedName~AnimationTest\u0022 --no-restore",
      "exitCode": 0,
      "output": "Passed! - Failed: 0, Passed: 42, Skipped: 0, Total: 42, Duration: 1 s\n\nAnimation.Create(string path) on main reads file to SKData and passes raw bytes to skottie_animation_make_from_data(). No ZIP detection or dotLottie handling exists.",
      "result": "wrong-output"
    }
  ],
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "8.0.23",
    "skiaSharpVersion": "3.116.0",
    "dockerUsed": false,
    "dotnetSdkVersion": "10.0.102"
  },
  "inputs": {
    "triageFile": "ai-triage/3421.json"
  },
  "assessment": "working-as-designed",
  "scope": "unknown",
  "reproductionTime": "~15 minutes",
  "versionResults": [
    {
      "version": "3.116.0",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Animation.Create() returns null for .lottie (ZIP) file. Raw .json Lottie works fine.",
      "platform": "host-macos-arm64"
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "reproduced",
      "notes": "Same behavior \u2014 .lottie returns null, raw .json works.",
      "platform": "host-macos-arm64"
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "reproduced",
      "notes": "No dotLottie support in Animation.Create on main. All 42 existing Skottie tests pass with JSON input. Code unchanged from released versions.",
      "platform": "host-macos-arm64"
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net8.0",
    "packages": [
      {
        "name": "SkiaSharp.Skottie",
        "version": "3.116.0"
      }
    ]
  },
  "errorMessages": {
    "primaryError": "Animation.Create() returns null when given a .lottie file (dotLottie ZIP format). No exception is thrown \u2014 silent failure.",
    "additionalErrors": [
      "Animation.Create(SKData) also returns null for .lottie data \u2014 same root cause, the Skottie JSON parser cannot parse ZIP binary data."
    ]
  },
  "feedback": {
    "triageCorrections": [
      {
        "topic": "classification",
        "upstream": "type/question (confidence 0.8) \u2014 triage classified as question since API is working as designed",
        "corrected": "Reproduction confirms the reported behavior occurs (null return). Classification as question vs bug is editorial \u2014 the factual conclusion is reproduced. However, triage\u0027s analysis that this is working-as-designed is correct: Skottie only supports JSON, not dotLottie ZIP."
      }
    ]
  },
  "output": {
    "proposedResponse": {
      "status": "ready",
      "body": "Thanks for reporting this! We were able to reproduce the issue \u2014 \u0060Animation.Create()\u0060 does return \u0060null\u0060 when given a \u0060.lottie\u0060 file.\n\nThe reason is that \u0060.lottie\u0060 files use the **dotLottie format**, which is a ZIP archive containing Lottie JSON animations and a manifest. Skia\u0027s Skottie module (which SkiaSharp wraps) only understands raw **Lottie JSON** \u2014 it cannot parse ZIP archives.\n\nThis is a common source of confusion because [LottieFiles](https://lottiefiles.com) now defaults to \u0060.lottie\u0060 downloads rather than raw \u0060.json\u0060.\n\n**Workarounds:**\n\n1. **Download the JSON format** from LottieFiles instead of \u0060.lottie\u0060 (look for the \u0060.json\u0060 download option)\n\n2. **Extract the JSON** from the \u0060.lottie\u0060 ZIP before loading:\n\u0060\u0060\u0060csharp\nusing System.IO.Compression;\n\nusing var zip = ZipFile.OpenRead(\u0022animation.lottie\u0022);\nvar entry = zip.Entries.First(e =\u003E e.FullName.EndsWith(\u0022.json\u0022) \n    \u0026\u0026 e.FullName.StartsWith(\u0022animations/\u0022));\nusing var stream = entry.Open();\nvar animation = SkiaSharp.Skottie.Animation.Create(stream);\n\u0060\u0060\u0060\n\n**Tested versions:**\n| Version | Result |\n|---------|--------|\n| 3.116.0 (reported) | \u274C null (expected \u2014 ZIP not supported) |\n| 3.119.2 (latest) | \u274C null (same) |\n| main (source) | \u274C null (same) |\n\nNote: Adding dotLottie format support would require new functionality in the Skottie module. This could be tracked as a feature request if there\u0027s interest.",
      "summary": "Reproduced \u2014 .lottie is a ZIP format not supported by Skottie; workaround provided."
    },
    "actionability": {
      "suggestedAction": "close-with-docs",
      "confidence": 0.85,
      "reason": "Reproduced on all tested versions including main. The behavior is by design \u2014 Skia\u0027s Skottie module only parses Lottie JSON, not the dotLottie container format (ZIP). The reporter needs to extract JSON from the .lottie file or download raw .json from LottieFiles. This is a documentation/awareness gap, not a code defect."
    },
    "workarounds": [
      "Download the Lottie JSON format (.json) directly from LottieFiles instead of the dotLottie format (.lottie).",
      "Extract the Lottie JSON from the .lottie ZIP archive before passing to Animation.Create(). The .lottie format is a ZIP containing animations/*.json files: using var zip = ZipFile.OpenRead(\u0022file.lottie\u0022); var entry = zip.Entries.First(e =\u003E e.FullName.EndsWith(\u0022.json\u0022) \u0026\u0026 e.FullName.StartsWith(\u0022animations/\u0022)); using var stream = entry.Open(); var animation = Animation.Create(stream);"
    ],
    "actions": [
      {
        "type": "update-labels",
        "description": "Add area/Skottie label to indicate this is specific to the Skottie sub-module",
        "risk": "low",
        "confidence": 0.9,
        "labels": [
          "area/Skottie"
        ]
      },
      {
        "type": "add-comment",
        "description": "Post reproduction results with workarounds for extracting JSON from .lottie files",
        "risk": "low",
        "confidence": 0.85
      }
    ]
  }
}