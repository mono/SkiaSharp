{
  "meta": {
    "schemaVersion": "1.0",
    "number": 2421,
    "repo": "mono/SkiaSharp",
    "analyzedAt": "2026-02-12T17:45:00Z"
  },
  "conclusion": "needs-hardware",
  "notes": "Issue #2421 reports a DllNotFoundException for @rpath/libSkiaSharp.framework/libSkiaSharp when creating SKPaint on a real iOS device via .NET MAUI (SkiaSharp 2.88.3). The reporter confirms it works on the iOS simulator and Android. Created a MAUI app with SkiaSharp 3.119.2 on .NET 10 \u2014 the device build (ios-arm64) includes libSkiaSharp.framework in the app bundle, and the simulator build runs successfully. However, the bug specifically requires a physical iOS device to reproduce (simulator uses a different build/linking pipeline). Without a connected iOS device, the runtime crash cannot be verified. The triage identified iOS managed linker stripping or Windows Hot Restart as likely root causes. All 60 SKPaint tests pass on main branch source.",
  "reproductionSteps": [
    {
      "stepNumber": 1,
      "description": "Create a .NET 10 MAUI project and add SkiaSharp.Views.Maui.Controls 3.119.2",
      "layer": "setup",
      "command": "dotnet new maui -n Repro \u0026\u0026 dotnet add package SkiaSharp.Views.Maui.Controls",
      "exitCode": 0,
      "output": "PackageReference for package \u0027SkiaSharp.Views.Maui.Controls\u0027 version \u00273.119.2\u0027 added.",
      "filesCreated": [
        {
          "filename": "Repro.csproj",
          "description": "MAUI project file targeting net10.0-ios with SkiaSharp 3.119.2",
          "content": "\u003CProject Sdk=\u0022Microsoft.NET.Sdk\u0022\u003E\n  \u003CPropertyGroup\u003E\n    \u003CTargetFrameworks\u003Enet10.0-android;net10.0-ios;net10.0-maccatalyst\u003C/TargetFrameworks\u003E\n    \u003COutputType\u003EExe\u003C/OutputType\u003E\n    \u003CUseMaui\u003Etrue\u003C/UseMaui\u003E\n    \u003CSingleProject\u003Etrue\u003C/SingleProject\u003E\n    \u003CImplicitUsings\u003Eenable\u003C/ImplicitUsings\u003E\n    \u003CNullable\u003Eenable\u003C/Nullable\u003E\n  \u003C/PropertyGroup\u003E\n  \u003CItemGroup\u003E\n    \u003CPackageReference Include=\u0022Microsoft.Maui.Controls\u0022 Version=\u0022$(MauiVersion)\u0022 /\u003E\n    \u003CPackageReference Include=\u0022SkiaSharp.Views.Maui.Controls\u0022 Version=\u00223.119.2\u0022 /\u003E\n  \u003C/ItemGroup\u003E\n\u003C/Project\u003E"
        },
        {
          "filename": "MainPage.xaml.cs",
          "description": "Reproduction code that creates an SKPaint object \u2014 the exact operation that crashes on real iOS devices",
          "content": "using SkiaSharp;\n\nnamespace Repro;\n\npublic partial class MainPage : ContentPage\n{\n    public MainPage()\n    {\n        InitializeComponent();\n        try\n        {\n            using var paint = new SKPaint();\n            paint.Color = SKColors.Red;\n            paint.IsAntialias = true;\n            System.Diagnostics.Debug.WriteLine($\u0022SKPaint created successfully: Color={paint.Color}\u0022);\n        }\n        catch (Exception ex)\n        {\n            System.Diagnostics.Debug.WriteLine($\u0022SKPaint FAILED: {ex.GetType().Name}: {ex.Message}\u0022);\n        }\n    }\n}"
        }
      ],
      "result": "success"
    },
    {
      "stepNumber": 2,
      "description": "Build for iOS device target (ios-arm64) and verify native framework is in app bundle",
      "layer": "deployment",
      "command": "dotnet build -f net10.0-ios -p:RuntimeIdentifier=ios-arm64",
      "exitCode": 0,
      "output": "Build succeeded. 0 Warning(s), 0 Error(s). Repro.app/Frameworks/libSkiaSharp.framework/libSkiaSharp is present in the build output.",
      "result": "success"
    },
    {
      "stepNumber": 3,
      "description": "Build for iOS simulator target (iossimulator-arm64) and verify native framework is in app bundle",
      "layer": "deployment",
      "command": "dotnet build -f net10.0-ios -p:RuntimeIdentifier=iossimulator-arm64",
      "exitCode": 0,
      "output": "Build succeeded. Repro.app/Frameworks/libSkiaSharp.framework/libSkiaSharp is present in the build output.",
      "result": "success"
    },
    {
      "stepNumber": 4,
      "description": "Install and launch app on iOS simulator (iPhone 14 Pro, iOS 16.2) to verify SKPaint works",
      "layer": "csharp",
      "command": "xcrun simctl boot \u003Csim-id\u003E \u0026\u0026 xcrun simctl install \u003Csim-id\u003E Repro.app \u0026\u0026 xcrun simctl launch --console \u003Csim-id\u003E com.companyname.repro",
      "exitCode": 0,
      "output": "App installed and launched successfully on simulator. No DllNotFoundException or crash observed.",
      "result": "success"
    },
    {
      "stepNumber": 5,
      "description": "Attempt to deploy and run on real iOS device to reproduce the DllNotFoundException",
      "layer": "deployment",
      "result": "skip"
    }
  ],
  "environment": {
    "os": "macOS 26.2",
    "arch": "arm64",
    "dotnetVersion": "10.0.102",
    "skiaSharpVersion": "3.119.2",
    "dockerUsed": false
  },
  "inputs": {
    "triageFile": "ai-triage/2421.json"
  },
  "assessment": "likely-bug",
  "reproductionTime": "~12 minutes",
  "versionResults": [
    {
      "version": "2.88.3",
      "source": "nuget",
      "result": "not-tested",
      "notes": "Reporter\u0027s version targets net6.0-ios only; no .NET 6 SDK available in current environment."
    },
    {
      "version": "3.119.2",
      "source": "nuget",
      "result": "not-tested",
      "notes": "Built successfully for ios-arm64. libSkiaSharp.framework present in app bundle. App runs on iOS simulator without crash. Cannot test on real device \u2014 no physical iOS device connected."
    },
    {
      "version": "main (source)",
      "source": "source",
      "result": "not-tested",
      "notes": "All 60 SKPaint tests pass (1 skipped for GPU). Cannot verify iOS device-specific deployment behavior from desktop test runner."
    }
  ],
  "reproProject": {
    "type": "console",
    "tfm": "net10.0-ios",
    "packages": [
      {
        "name": "SkiaSharp.Views.Maui.Controls",
        "version": "3.119.2"
      }
    ]
  },
  "blockers": [
    "Requires physical iOS device \u2014 reporter states the bug only occurs on real iOS devices, not on the simulator. No physical iOS device is connected to this machine.",
    "Cannot test reporter\u0027s exact version (SkiaSharp 2.88.3) \u2014 it only targets net6.0-ios and no .NET 6 SDK is available."
  ]
}