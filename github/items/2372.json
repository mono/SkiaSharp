{
  "number": 2372,
  "type": "issue",
  "state": "closed",
  "title": "[FEATURE] Expose existing RTree optimization option on SkPictureRecorder.BeginRecording()",
  "body": "We\u0027re looking to pan and zoom some SkiaSharp\u0027s SkPictures that consist of a reasonably large number of simple operations (~25K, text, lines, rect fills). We\u0027re finding a zoomed and translated DrawPicture is rendering on the order of 5 fps on recent model iOS devices, which is clearly unacceptable.\r\n\r\nBut yay! It turns out Skia has had built in support for RTree-based operations culling for a long time, and it looks very promising:\r\n\r\nhttps://groups.google.com/g/skia-discuss/c/EPOuhhloIF4/m/rZyakh1fBwAJ\r\nhttps://bugs.chromium.org/p/chromium/issues/detail?id=485597#c22\r\n\r\nBut oh no! SkiaSharp doesn\u0027t expose this functionality, either in C# or the C wrappers in the Mono fork of Skia.\r\n\r\nBut yay! The fix looks very straightforward - just exposing the constructor of an RTreeFactory instance, and passing it as an extra parameter to BeginRecording().\r\n\r\nI\u0027ve created forks of both SkiaSharp and mono/skia, and implemented a swag at a simple C# api, C wrappers, and some smoke tests. You can find the (fairly small, simple, but unvetted) changes here:\r\n\r\nhttps://github.com/mono/SkiaSharp/compare/main...kcoop:SkiaSharp:kcoop-rtree\r\nhttps://github.com/mono/skia/compare/xamarin-mobile-bindings...kcoop:mono-skia:kcoop-rtree\r\n\r\nThis seems like a valuable, big bang for the buck PR. Very small change, and who wouldn\u0027t want significant rendering improvements for large-ish documents by simply adding a bool? I\u0027m happy to do what\u0027s needed to make this happen.\r\n\r\n[Edited to remove noise - I\u0027ve now discovered this repo uses submodules to build mono/skia]\r\n\r\n",
  "author": {
    "login": "kcoop",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2023-02-03T19:46:00",
  "updatedAt": "2024-06-18T09:09:51",
  "closedAt": "2024-06-18T09:09:51",
  "commentCount": 5,
  "reactionCount": 4,
  "engagement": {
    "syncedAt": "2026-02-04T20:13:38.2854328Z",
    "reactions": [
      {
        "user": "wieslawsoltes",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:13:38.2854521Z"
      },
      {
        "user": "angelofb",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:13:38.2854528Z"
      },
      {
        "user": "mgnslndh",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:13:38.285455Z"
      },
      {
        "user": "alexandrvslv",
        "content": "\u002B1",
        "createdAt": "2026-02-04T20:13:38.2854554Z"
      }
    ],
    "comments": [
      {
        "id": 2049696713,
        "author": "TwinkyDaniel",
        "createdAt": "2024-04-11T13:28:29",
        "reactions": []
      },
      {
        "id": 2053551634,
        "author": "mattleibow",
        "createdAt": "2024-04-13T07:08:41",
        "reactions": [
          {
            "user": "TwinkyDaniel",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:13:37.6204847Z"
          }
        ]
      },
      {
        "id": 2055677142,
        "author": "TwinkyDaniel",
        "createdAt": "2024-04-15T06:51:48",
        "reactions": []
      },
      {
        "id": 2056089593,
        "author": "wieslawsoltes",
        "createdAt": "2024-04-15T08:13:22",
        "reactions": []
      },
      {
        "id": 2057793693,
        "author": "mattleibow",
        "createdAt": "2024-04-15T20:57:14",
        "reactions": [
          {
            "user": "TwinkyDaniel",
            "content": "\u002B1",
            "createdAt": "2026-02-04T20:13:38.2351507Z"
          }
        ]
      }
    ]
  }
}