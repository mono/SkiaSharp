{
  "number": 2341,
  "type": "issue",
  "state": "open",
  "title": "[BUG] [WinUI] Scale delay is observed during window resize",
  "body": "**Description**\r\nWhen the window of WinUI application (that has SKCanvasView inside it) is constantly resized the scale of the canvas drawing does not look accurate for some of the frames. That leaves the feeling that the canvas is somehow flickering. The issue can be reproduced with every drawing in the canvas, but it is easily reproduced when you have multiple text drawings on the screen.\r\n\r\nAfter a brief research I\u0027ve found that the issues was caused by [this ](https://github.com/mono/SkiaSharp/pull/1804) PR. And more specifically by the following code change:\r\n![Screenshot 2022-12-15 114944](https://user-images.githubusercontent.com/9336157/207827868-e5677bf7-2e10-4ce0-80d4-a3a2caf4b5be.png)\r\n\r\nI can suggest two possible solutions for this issue:\r\n1. You can bring back the Scale Transform and set the Stretch to None.\r\n2. Or you can invoke DoInvalidate instead of Invalidate from OnSizeChanged. Invalidate invokes DoInvalidate, but from within a dispatcher which causes the inaccurate rendering of the frames. SizeChanged should be invoked from within the UI thread, so it is safe to invoke DoInvalidate instead of Invalidate. \r\n\r\n\u003C!-- a general description goes here --\u003E\r\n\r\n**Code**\r\n\r\n\u003C!-- a snippet of code that demonstrates the issue --\u003E\r\n\u0060\u0060\u0060csharp\r\nusing SkiaSharp;\r\nusing SkiaSharp.Views.Maui;\r\nusing SkiaSharp.Views.Maui.Controls;\r\n\r\nnamespace SkiaScaleWinUI;\r\n\r\npublic partial class App : Application\r\n{\r\n    public App()\r\n    {\r\n        InitializeComponent();\r\n\r\n        MainPage = new TextPage();\r\n    }\r\n\r\n    public class TextPage : ContentPage\r\n    {\r\n        public TextPage()\r\n        {\r\n            Title = \u0022Framed Text\u0022;\r\n\r\n            SKCanvasView canvasView = new SKCanvasView();\r\n            canvasView.PaintSurface \u002B= OnCanvasViewPaintSurface;\r\n            Content = canvasView;\r\n        }\r\n\r\n        void OnCanvasViewPaintSurface(object sender, SKPaintSurfaceEventArgs args)\r\n        {\r\n            SKSurface surface = args.Surface;\r\n            SKCanvas canvas = surface.Canvas;\r\n\r\n            canvas.Clear();\r\n\r\n            string str = \u0022Hello SkiaSharp!\u0022;\r\n            SKPaint textPaint = new SKPaint { Color = SKColors.Chocolate, TextSize = 24 };\r\n\r\n            canvas.DrawText(str, 0, args.Info.Height / 2, textPaint);\r\n        }\r\n    }\r\n}\r\n\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\n\u003C!-- a general description of what was the expected behavior or result --\u003E\r\nDuring windows resize the text should not be scaled - at the size and the DPI should be taken into account, but the visual representation should not be affected by this.\r\n\r\n**Actual Behavior**\r\n\r\n\u003C!-- a general description of what really happened --\u003E\r\nThe text does not look good for some of the frames during window resize.\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  2.88.3\r\n- Last known good version:  unknown\r\n- IDE:  Visual Studio\r\n- Platform Target Frameworks: \r\n  - WinUI\r\n\r\n**Screenshots**\r\n\r\n\u003C!-- if the issue is a visual issue, please include screenshots showing the problem if possible --\u003E\r\n![67](https://user-images.githubusercontent.com/9336157/207826602-e55f5776-b5b6-4e0b-b418-1654641fc47a.png)\r\n![68](https://user-images.githubusercontent.com/9336157/207826607-8bd2003a-2103-4c1e-ab24-92fbeee57d8a.png)\r\n\r\n**Reproduction Link**\r\n\r\n\u003C!-- please upload or provide a link to a reproduction case --\u003E\r\n[SkiaScaleWinUI.zip](https://github.com/mono/SkiaSharp/files/10235785/SkiaScaleWinUI.zip)\r\n\r\n",
  "author": {
    "login": "APopatanasov",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-12-15T10:02:23",
  "updatedAt": "2025-02-20T07:56:02",
  "commentCount": 11,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T19:56:23.7326264Z",
    "reactions": [],
    "comments": [
      {
        "id": 1357171985,
        "author": "FrozDark",
        "createdAt": "2022-12-19T06:46:56",
        "reactions": []
      },
      {
        "id": 1357251169,
        "author": "APopatanasov",
        "createdAt": "2022-12-19T08:12:50",
        "reactions": []
      },
      {
        "id": 1367668506,
        "author": "bmitc",
        "createdAt": "2022-12-30T01:01:23",
        "reactions": []
      },
      {
        "id": 1374504381,
        "author": "bmitc",
        "createdAt": "2023-01-07T14:48:46",
        "reactions": []
      },
      {
        "id": 1694963601,
        "author": "bmitc",
        "createdAt": "2023-08-28T03:52:45",
        "reactions": []
      },
      {
        "id": 1859303325,
        "author": "trusktr",
        "createdAt": "2023-12-17T22:23:01",
        "reactions": []
      },
      {
        "id": 1863937978,
        "author": "bmitc",
        "createdAt": "2023-12-20T06:46:24",
        "reactions": []
      },
      {
        "id": 2057709307,
        "author": "bmitc",
        "createdAt": "2024-04-15T20:04:07",
        "reactions": []
      },
      {
        "id": 2058186847,
        "author": "FrozDark",
        "createdAt": "2024-04-16T04:02:47",
        "reactions": []
      },
      {
        "id": 2072436830,
        "author": "Mangepange",
        "createdAt": "2024-04-23T14:16:58",
        "reactions": []
      },
      {
        "id": 2670722413,
        "author": "Mangepange",
        "createdAt": "2025-02-20T07:56:00",
        "reactions": []
      }
    ]
  }
}