{
  "number": 2551,
  "type": "issue",
  "state": "closed",
  "title": "[BUG] SKSwapChainPanel - Only the last created instance renders in Uno WASM",
  "body": "**Description**\r\n\r\nThe \u0060SKSwapChainPanel\u0060 does not function as expected when used in an Uno Platform WASM project. Only the last created instance renders. Using the \u0060SKSwapChainPanel\u0060 within an Android app renders all instances as expected.\r\n\r\n**Code**\r\n\r\nXAML\r\n\u0060\u0060\u0060xml\r\n\u003CGrid\u003E\r\n    \u003CImage Source=\u0022ms-appx:///ResourceAndSkia/Assets/Images/TestBackground.png\u0022 Stretch=\u0022UniformToFill\u0022 /\u003E\r\n    \u003CStackPanel HorizontalAlignment=\u0022Center\u0022 VerticalAlignment=\u0022Center\u0022\u003E\r\n        \u003CTextBlock AutomationProperties.AutomationId=\u0022HelloTextBlock\u0022 Text=\u0022Hello Uno Platform\u0022 /\u003E\r\n    \u003C/StackPanel\u003E\r\n    \u003CScrollViewer\u003E\r\n        \u003CStackPanel x:Name=\u0022SkiaStack\u0022 /\u003E\r\n    \u003C/ScrollViewer\u003E\r\n\u003C/Grid\u003E\r\n\u0060\u0060\u0060\r\n\r\nC# Code-behind\r\n\u0060\u0060\u0060csharp\r\npublic sealed partial class MainPage : Page\r\n{\r\n    public MainPage()\r\n    {\r\n        this.InitializeComponent();\r\n        this.Loaded \u002B= MainPage_Loaded;\r\n    }\r\n\r\n    private void MainPage_Loaded(object sender, RoutedEventArgs e)\r\n    {\r\n        var c1 = new SKXamlCanvas();\r\n        add(c1);\r\n        c1.PaintSurface \u002B= Canvas_PaintSurface;\r\n\r\n#if WASM || ANDROID\r\n        for(int i =  0; i \u003C 3; i\u002B\u002B)\r\n        {\r\n            var c2 = new SKSwapChainPanel();\r\n            add(c2);\r\n            c2.PaintSurface \u002B= Canvas_PaintSurface;\r\n        }\r\n#else\r\n        // still no SwapChain for WinUI...\r\n        for (int i = 0; i \u003C 3; i\u002B\u002B)\r\n        {\r\n            var c3 = new SKXamlCanvas();\r\n            add(c3);\r\n            c3.PaintSurface \u002B= Canvas_PaintSurface;\r\n        }\r\n#endif\r\n    }\r\n\r\n    private void add(FrameworkElement element)\r\n    {\r\n        element.Height = 200;\r\n        element.Width = 200;\r\n        SkiaStack.Children.Add(element);\r\n    }\r\n\r\n    private void Canvas_PaintSurface(object? sender, SKPaintSurfaceEventArgs e)\r\n    {\r\n        // red for XAML canvas\r\n        paint(e.Surface.Canvas, new SKColor(255, 0, 0, 128));\r\n    }\r\n\r\n    private void Canvas_PaintSurface(object? sender, SKPaintGLSurfaceEventArgs e)\r\n    {\r\n        // yellow for SwapChain\r\n        paint(e.Surface.Canvas, new SKColor(255, 255, 0, 128));\r\n    }\r\n\r\n    private void paint(SKCanvas canvas, SKColor fillColor)\r\n    {\r\n        canvas.Clear();\r\n        canvas.Scale((float)XamlRoot.RasterizationScale);\r\n        using var fillPaint = new SKPaint()\r\n        {\r\n            Color = fillColor,\r\n            Style = SKPaintStyle.Fill,\r\n        };\r\n        canvas.DrawRect(0, 0, 200, 100, fillPaint);\r\n    }\r\n}\r\n\u0060\u0060\u0060\r\n\r\n**Expected Behavior**\r\n\r\nI expect every instance of the \u0060SKSwapChainPanel\u0060 to render content in a WASM application, similar to how it works on Android, or how the \u0060SKGLView\u0060 works in Blazor.\r\n\r\n**Actual Behavior**\r\n\r\nIn WASM, only the last created instance of \u0060SKSwapChainPanel\u0060 renders content. See the images below - a transparent red rectangle is rendered on an \u0060SKXamlPanel\u0060, the yellow rectangles are rendered on \u0060SKSwapChainPanel\u0060.\r\n\r\n- In the WASM version, the first two instances of \u0060SKSwapChainPanel\u0060 do not render.\r\n- In the Android version, all instances render as expected.\r\n- In the WinUI Desktop, \u0060SKSwapChainPanel\u0060 is unavailable, so only red \u0060SKXamlPanel\u0060 instances are rendered. (Any plans for \u0060SKSwapChainPanel\u0060 in WinUI desktop?)\r\n\r\n**Basic Information**\r\n\r\n- Version with issue: SkiaSharp.Views.Uno.WinUI 2.88.4-preview.89\r\n- Last known good version:  N/A\r\n- IDE:  Visual Studio\r\n- Platform Target Frameworks:\r\n  - WinUI:  Windows 11\r\n  - WASM:\r\n- Target Devices:\r\n  - Edge - Version 115.0.1901.203 (Official build) (64-bit)\r\n  - Chrome - Version 115.0.5790.171 (Official Build) (64-bit)\r\n  - Firefox - 116.0.2 (64-bit)\r\n\r\n![VS About](https://github.com/mono/SkiaSharp/assets/1674843/713f135b-ebd6-4161-bce2-79158f112765)\r\n\r\n**Screenshots**\r\n\r\n### WASM - first two instances of SKSwapChainPanel are missing\r\n![WASM](https://github.com/mono/SkiaSharp/assets/1674843/0361c893-c170-4c0e-9dc0-9a52a27dc3ba)\r\n\r\n### Android\r\n\r\n![Android](https://github.com/mono/SkiaSharp/assets/1674843/9f55ed3b-68f3-4208-9aca-a2a639f6face)\r\n\r\n### WinUI Desktop\r\n\r\n![WinUIDesktop](https://github.com/mono/SkiaSharp/assets/1674843/6e9329ad-c3fe-4666-aa0b-f9cfe0db4394)\r\n\r\n**Reproduction Link**\r\n\r\n[SkiaRepro.zip](https://github.com/mono/SkiaSharp/files/12328063/SkiaRepro.zip)\r\n",
  "author": {
    "login": "darenm",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2023-08-12T18:43:56",
  "updatedAt": "2023-09-20T18:00:28",
  "closedAt": "2023-08-17T22:37:01",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T20:24:47.9036691Z",
    "reactions": [],
    "comments": [
      {
        "id": 1686501346,
        "author": "darenm",
        "createdAt": "2023-08-21T15:02:32",
        "reactions": []
      }
    ]
  }
}