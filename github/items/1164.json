{
  "number": 1164,
  "type": "issue",
  "state": "open",
  "title": "[BUG] ToTextureImage causes Native Crash (1.68.2-preview.39)",
  "body": "**Description**\r\nI\u0027m using an \u0060SKGLView\u0060 on macOS to render some \u0060SKImage\u0060 objects - since the latest preview build introduces \u0060ToTextureImage\u0060 i wanted to use this to create the \u0060SKImage\u0060 object on the GPU. This causes the following native crash for me\r\n\r\n**Code**\r\n\u0060\u0060\u0060\r\n=================================================================\r\n\tNative Crash Reporting\r\n=================================================================\r\nGot a SIGSEGV while executing native code. This usually indicates\r\na fatal error in the mono runtime or one of the native libraries \r\nused by your application.\r\n=================================================================\r\n\r\n=================================================================\r\n\tNative stacktrace:\r\n=================================================================\r\n\t0x109680d38 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MacOS/test : mono_dump_native_crash_info\r\n\t0x109674555 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MacOS/test : mono_handle_native_crash\r\n\t0x1099bfb33 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MacOS/test : altstack_handle_and_restore.cold.1\r\n\t0x1095f26ac - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MacOS/test : altstack_handle_and_restore\r\n\t0x7fff3a333980 - /System/Library/Frameworks/OpenGL.framework/Versions/A/Libraries/libGL.dylib : glGenTextures\r\n\t0x10a28226c - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a281e76 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1a672c - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1a67d4 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1cdecb - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1b3006 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1cd9f6 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1b4b3f - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1e5b17 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1b345c - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1eab72 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a0fcf0d - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a0fcfba - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1a8d11 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1e776c - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a1e88ff - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a2b831b - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x10a2b81d1 - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : gr_backendrendertarget_get_gl_framebufferinfo\r\n\t0x109fc065a - /Users/dev/test.MacOS/bin/Debug/test.app/Contents/MonoBundle/libSkiaSharp.dylib : sk_image_make_texture_image\r\n\t0x13f30f4dc - Unknown\r\n\r\n=================================================================\r\n\tTelemetry Dumper:\r\n=================================================================\r\nPkilling 0x70000a93f000 from 0x700007971000\r\nPkilling 0x700007d77000 from 0x700007971000\r\nPkilling 0x70000572c000 from 0x700007971000\r\nPkilling 0x700008380000 from 0x700007971000\r\nPkilling 0x700008d15000 from 0x700007971000\r\nPkilling 0x700005dc1000 from 0x700007971000\r\nPkilling 0x70000931e000 from 0x700007971000\r\nPkilling 0x700005a35000 from 0x700007971000\r\nPkilling 0x1112c7dc0 from 0x700007971000\r\nPkilling 0x7000063ca000 from 0x700007971000\r\nPkilling 0x700009927000 from 0x700007971000\r\nPkilling 0x700006d5f000 from 0x700007971000\r\nPkilling 0x7000069d3000 from 0x700007971000\r\nPkilling 0x700009f30000 from 0x700007971000\r\nPkilling 0x700007368000 from 0x700007971000\r\nPkilling 0x70000a539000 from 0x700007971000\r\nPkilling 0x700007f7a000 from 0x700007971000\r\nPkilling 0x70000890f000 from 0x700007971000\r\nPkilling 0x700008583000 from 0x700007971000\r\nPkilling 0x700008f18000 from 0x700007971000\r\nPkilling 0x700005fc4000 from 0x700007971000\r\nPkilling 0x700009521000 from 0x700007971000\r\nPkilling 0x7000065cd000 from 0x700007971000\r\nPkilling 0x700009b2a000 from 0x700007971000\r\nPkilling 0x700006f62000 from 0x700007971000\r\nPkilling 0x70000a133000 from 0x700007971000\r\nPkilling 0x70000756b000 from 0x700007971000\r\nPkilling 0x70000a73c000 from 0x700007971000\r\nPkilling 0x700007b74000 from 0x700007971000\r\nPkilling 0x700005529000 from 0x700007971000\r\nPkilling 0x70000817d000 from 0x700007971000\r\nPkilling 0x700008b12000 from 0x700007971000\r\nPkilling 0x700005bbe000 from 0x700007971000\r\nPkilling 0x70000911b000 from 0x700007971000\r\nPkilling 0x7000061c7000 from 0x700007971000\r\n* Assertion: should not be reached at /Users/builder/jenkins/workspace/archive-mono/2019-08/mac/release/mono/metadata/threads.c:6254\r\nPkilling 0x700009724000 from 0x700007971000\r\nPkilling 0x7000067d0000 from 0x700007971000\r\nPkilling 0x700009d2d000 from 0x700007971000\r\nPkilling 0x700007165000 from 0x700007971000\r\nPkilling 0x70000a336000 from 0x700007971000\r\nPkilling 0x70000776e000 from 0x700007971000\r\nEntering thread summarizer pause from 0x700007971000\r\nThread started: \u003CThread Pool\u003E #44\r\nThread started: \u003CThread Pool\u003E #45\r\nFinished thread summarizer pause from 0x700007971000.\r\n\r\nWaiting for dumping threads to resume\r\n\r\n=================================================================\r\n\tExternal Debugger Dump:\r\n=================================================================\r\n(lldb) command source -s 0 \u0027/tmp/mono-gdb-commands.22028\u0027\r\nExecuting commands in \u0027/tmp/mono-gdb-commands.22028\u0027.\r\n(lldb) process attach --pid 22028\r\n\u0060\u0060\u0060\r\n\r\n\r\n**Expected Behavior**\r\nimage object should be created on the GPU without errors\r\n\r\n**Actual Behavior**\r\napplication crashes\r\n\r\n**Basic Information**\r\n\r\n- Version with issue:  1.68.2-preview.29\r\n\r\n- IDE:  Visual Studio for Mac \r\n- Platform Target Frameworks:\r\n  - macOS:  10.15.3 (19D76)\r\n Target Devices:   \u003C!-- the devices that you noticed this on, e.g. iPhone X --\u003E\r\n  - MacBook Pro (13-inch, 2018, Four Thunderbolt 3 Ports) | 16 GB 2133 MHz LPDDR3 | 2,3 GHz Quad-Core Intel Core i5 | Intel Iris Plus Graphics 655 1536 MB\r\n\r\n**Reproduction Link**\r\n\r\n[https://github.com/nor0x/SkiaSharp_PerfomanceExperiments/tree/master/Xamarin.Forms](https://github.com/nor0x/SkiaSharp_PerfomanceExperiments/tree/master/Xamarin.Forms)",
  "author": {
    "login": "nor0x",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "milestone": "v2.88.x Planning",
  "createdAt": "2020-03-04T20:59:00",
  "updatedAt": "2022-09-11T18:31:04",
  "commentCount": 1,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T20:30:59.1964736Z",
    "reactions": [],
    "comments": [
      {
        "id": 642686538,
        "author": "mattleibow",
        "createdAt": "2020-06-11T14:17:18",
        "reactions": []
      }
    ]
  }
}