{
  "number": 1925,
  "type": "issue",
  "state": "open",
  "title": "[QUESTION] Performance when writing to spokes in acircle",
  "body": "Hello\r\nI have a circle with 512 pixels radius.\r\nThe circle have 2048 spokes that are 512 pixels long each pixel in the spoke have a specifik color.\r\nI have tried several solutions to \u201Dpaint\u201D the circle first attempt was this \r\n\r\n1:\r\ni have the angle of the spoke in the circle and the do some trigonometry like this\r\n\r\nvoid OnPaintCanvas(object sender, SKPaintSurfaceEventArgs e)\r\n        {\r\n  \t\tSKCanvas canvas = e.Surface.Canvas;\r\n            \t\tSKSurface surface = e.Surface;\r\n\r\n\t\t\tint height = 1024;\r\n                    \t\tint width = 1024;\r\n     \t\t\tint midx, midy;\r\n                    \t\tmidx = width / 2;\r\n                   \t\tmidy = height / 2t;\r\n\r\n \t\t\tdouble rad = ToRadian(angle);\r\n                                double radcos = Math.Cos(rad);\r\n                                double radsin = Math.Sin(rad);\r\n                                int dataLength = 512;\r\n\t\t\tfor (int k = 0; k \u003C dataLength; k\u002B\u002B)\r\n                                {\r\n                                    int valpunkt = spoke[k];\r\n                                    {\r\n                                        var paint = theColorWeak;\r\n                                        if (valpunkt == 0)\r\n                                            paint = radarGray;\r\n                                        else if (valpunkt \u003E ThresholdRed)\r\n                                            paint = theColorStrong;\r\n                                        else if (valpunkt \u003E ThresholdGreen)\r\n                                            paint = theColorIntermediate;\r\n                                        float r = k;//*scale;\r\n                                        float x = (float)(midx \u002B radcos * r);\r\n                                        float y = (float)(midy \u002B radsin * r);\r\n                                        surface.Canvas.DrawCircle((int)x, (int)y, 1f, paint);\r\n                                    }\r\n}\r\n\r\n\r\nThis works no moire pattern but it is slow.\r\n\r\n2:\r\nTried this instead to speed things up i  write directly to the pixels the problem is that because of a circles spoke get wider the longer away from center the pixel is, the result is that i get a moire pattern towards the edge of the circle.  I don\u0027t remember my trigonometry that well but do any one have any idea or do i have to fall back to adress every pixel in the bitmap? \r\n\r\n  public static SKBitmap WriteSpokeBlazor( drawingDataNew spokeData, SKColor BackgroundColor)\r\n        {\r\n            SKBitmap spokeBmp = new SKBitmap(new SKImageInfo((int)512, (int)1, SKColorType.Bgra8888, SKAlphaType.Premul));\r\n\r\n            var span = spokeBmp.PeekPixels().GetPixelSpan\u003CSKColor\u003E();\r\n            if (spokeData != null)\r\n                for (var i = 0; i \u003C spokeData.data.Length ; i\u002B\u002B) // From center of image to edge at the angle\r\n{\r\n                    int valpunkt = spokeData.data[i];\r\n                    var paint = theColorWeak;\r\n                    paint.Color = SKColors.Blue;\r\n                    if (valpunkt == 0)\r\n                        paint.Color = BackgroundColor;\r\n                    else if (valpunkt \u003E ThresholdRed)\r\n                        paint = theColorStrong;\r\n                    else if (valpunkt \u003E ThresholdGreen)\r\n                        paint = theColorIntermediate;\r\n           \r\n                    span[i] = paint.Color;\r\n                }\r\n \treturn spokeBmp;\r\n        }\r\n\r\nvoid OnPaintCanvas(SKPaintGLSurfaceEventArgs e)\r\n      {\r\n            SKCanvas canvas = e.Surface.Canvas;\r\n            var surfaceSize = e.BackendRenderTarget.Size;\r\nvar spokeBmp = WriteSpokeBlazor( drawdata, BackgroundColor);\r\n\r\n \t    canvas.Save();\r\n                canvas.Translate(center);\r\n                canvas.RotateDegrees(degSum);\r\n                canvas.DrawBitmap(spokeBmp,0, 0);\r\n                canvas.Restore();\r\n }\r\nThanks ",
  "author": {
    "login": "pilotshamn",
    "type": "User"
  },
  "labels": [],
  "assignees": [],
  "createdAt": "2022-01-15T08:41:30",
  "updatedAt": "2022-01-15T08:41:30",
  "commentCount": 0,
  "reactionCount": 0,
  "engagement": {
    "syncedAt": "2026-02-04T21:00:30.9801708Z",
    "reactions": [],
    "comments": []
  }
}