{
  "number": 2947,
  "type": "issue",
  "state": "open",
  "title": "[BUG] Cannot build or run .Net 8 tvOS project",
  "body": "### Description\r\n\r\nCreate a new tvOS application in .Net 8, it builds and works fine. If I add a SkiaSharp reference, i.e.\r\n\r\n    \u003CPackageReference Include=\u0022SkiaSharp\u0022 Version=\u00222.88.8\u0022 /\u003E\r\n\r\nThen the build fails with this error...\r\n\u0060\u0060\u0060\r\n  ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64\r\n  clang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n  \r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang\u002B\u002B exited with code 1: [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64 [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang: error: linker command failed with exit code 1 (use -v to see invocation) [/Users/mt/Desktop/test/test.csproj]\r\n\r\nBuild FAILED.\r\n\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1836,3): warning : The file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/.DS_Store\u0027 does not specify a \u0027PublishFolderType\u0027 metadata, and a default value could not be calculated. The file will not be copied to the app bundle. [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang\u002B\u002B exited with code 1: [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64 [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang: error: linker command failed with exit code 1 (use -v to see invocation) [/Users/mt/Desktop/test/test.csproj]\r\n\u0060\u0060\u0060\r\n\r\n### Code\r\n\r\nhttps://github.com/munit79/tvosfail\r\n\r\n### Expected Behavior\r\n\r\nI\u0027d expect the app to build and run.\r\n\r\n### Actual Behavior\r\n\r\nIt seems to want to link the wrong version of SkiaSharp, i.e. the device build rather than a simulator build.\r\n\r\nI get a similar problem when compiling for the App Store, it builds OK, but Apple rejects the build because the skiasharp library is built for the simulator, not the device.\r\n\r\nWe were able to use SkiaSharp successfully on our Xamarin version of the tvOS app, and we can also successfully use it on the MAUI based iOS version of the app.\r\n\r\n### Version of SkiaSharp\r\n\r\n2.88.3 (Current)\r\n\r\n### Last Known Good Version of SkiaSharp\r\n\r\nOther (Please indicate in the description)\r\n\r\n### IDE / Editor\r\n\r\nVisual Studio Code (macOS)\r\n\r\n### Platform / Operating System\r\n\r\nmacOS\r\n\r\n### Platform / Operating System Version\r\n\r\nBuilding on MacBook Pro M3 Max\r\n\r\n\r\n\r\n### Devices\r\n\r\n_No response_\r\n\r\n### Relevant Screenshots\r\n\r\n_No response_\r\n\r\n### Relevant Log Output\r\n\r\n\u0060\u0060\u0060shell\r\nmt@MacBook-Pro-M3 test % dotnet build -t:Run -f net8.0-tvos\r\n  Determining projects to restore...\r\n  All projects are up-to-date for restore.\r\n  Detected signing identity:\r\n          \r\n    Bundle Id: com.companyname.test\r\n    App Id: com.companyname.test\r\n  test -\u003E /Users/mt/Desktop/test/bin/Debug/net8.0-tvos/tvossimulator-arm64/test.dll\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1836,3): warning : The file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/.DS_Store\u0027 does not specify a \u0027PublishFolderType\u0027 metadata, and a default value could not be calculated. The file will not be copied to the app bundle. [/Users/mt/Desktop/test/test.csproj]\r\n  Optimizing assemblies for size may change the behavior of the app. Be sure to test after publishing. See: https://aka.ms/dotnet-illink\r\n  Tool xcrun execution finished (exit code = 1).\r\n          \r\n  ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64\r\n  clang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n  \r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang\u002B\u002B exited with code 1: [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64 [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang: error: linker command failed with exit code 1 (use -v to see invocation) [/Users/mt/Desktop/test/test.csproj]\r\n\r\nBuild FAILED.\r\n\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1836,3): warning : The file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/.DS_Store\u0027 does not specify a \u0027PublishFolderType\u0027 metadata, and a default value could not be calculated. The file will not be copied to the app bundle. [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang\u002B\u002B exited with code 1: [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.8/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64 [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang: error: linker command failed with exit code 1 (use -v to see invocation) [/Users/mt/Desktop/test/test.csproj]\r\n    1 Warning(s)\r\n    1 Error(s)\r\n\r\nTime Elapsed 00:00:00.77\r\nmt@MacBook-Pro-M3 test % dotnet build -t:Run -f net8.0-tvos\r\n  Determining projects to restore...\r\n/Users/mt/Desktop/test/test.csproj : warning NU1903: Package \u0027SkiaSharp\u0027 2.88.3 has a known high severity vulnerability, https://github.com/advisories/GHSA-j7hp-h8jx-5ppr [/Users/mt/Desktop/test/test.sln]\r\n  All projects are up-to-date for restore.\r\n  Detected signing identity:\r\n          \r\n    Bundle Id: com.companyname.test\r\n    App Id: com.companyname.test\r\n/Users/mt/Desktop/test/test.csproj : warning NU1903: Package \u0027SkiaSharp\u0027 2.88.3 has a known high severity vulnerability, https://github.com/advisories/GHSA-j7hp-h8jx-5ppr\r\n  test -\u003E /Users/mt/Desktop/test/bin/Debug/net8.0-tvos/tvossimulator-arm64/test.dll\r\n  Optimizing assemblies for size may change the behavior of the app. Be sure to test after publishing. See: https://aka.ms/dotnet-illink\r\n  Optimizing assemblies for size. This process might take a while.\r\n  Tool xcrun execution finished (exit code = 1).\r\n          \r\n  ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.3/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64\r\n  clang: error: linker command failed with exit code 1 (use -v to see invocation)\r\n  \r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang\u002B\u002B exited with code 1: [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.3/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64 [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang: error: linker command failed with exit code 1 (use -v to see invocation) [/Users/mt/Desktop/test/test.csproj]\r\n\r\nBuild FAILED.\r\n\r\n/Users/mt/Desktop/test/test.csproj : warning NU1903: Package \u0027SkiaSharp\u0027 2.88.3 has a known high severity vulnerability, https://github.com/advisories/GHSA-j7hp-h8jx-5ppr\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang\u002B\u002B exited with code 1: [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : ld: building for tvOS Simulator, but linking in dylib built for tvOS, file \u0027/Users/mt/.nuget/packages/skiasharp.nativeassets.tvos/2.88.3/runtimes/tvos/native/libSkiaSharp.framework/libSkiaSharp\u0027 for architecture arm64 [/Users/mt/Desktop/test/test.csproj]\r\n/usr/local/share/dotnet/packs/Microsoft.tvOS.Sdk/17.2.8078/targets/Xamarin.Shared.Sdk.targets(1564,3): error : clang: error: linker command failed with exit code 1 (use -v to see invocation) [/Users/mt/Desktop/test/test.csproj]\r\n    1 Warning(s)\r\n    1 Error(s)\r\n\r\nTime Elapsed 00:00:22.45\r\nmt@MacBook-Pro-M3 test %\r\n\u0060\u0060\u0060\r\n\r\n\r\n### Code of Conduct\r\n\r\n- [X] I agree to follow this project\u0027s Code of Conduct",
  "author": {
    "login": "munit79",
    "type": "User"
  },
  "labels": [
    {
      "name": "type/bug",
      "color": "fc2929"
    }
  ],
  "assignees": [],
  "createdAt": "2024-07-18T01:29:12",
  "updatedAt": "2024-08-07T04:38:19",
  "commentCount": 2,
  "reactionCount": 0
}